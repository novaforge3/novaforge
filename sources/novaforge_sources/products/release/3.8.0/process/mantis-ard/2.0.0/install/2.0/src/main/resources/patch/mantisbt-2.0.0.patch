diff -rNU5 mantisbt/account_page.php mantisbt-2.0.0/account_page.php
--- mantisbt/account_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/account_page.php	2017-02-03 11:29:18.000000000 +0100
@@ -38,10 +38,11 @@
  * - The user's account must not be protected
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses authentication_api.php
  * @uses config_api.php
@@ -94,11 +95,11 @@
 $t_row = user_get_row( auth_get_current_user_id() );
 
 extract( $t_row, EXTR_PREFIX_ALL, 'u' );
 
 $t_ldap = ( LDAP == config_get( 'login_method' ) );
-
+$t_cas_auth = ( CAS_AUTH == config_get( 'login_method' ) );
 # In case we're using LDAP to get the email address... this will pull out
 #  that version instead of the one in the DB
 $u_email = user_get_email( $u_id );
 
 # If the password is the default password, then prompt user to change it.
@@ -214,11 +215,16 @@
 				<td>
 				<?php
 				if( $t_ldap && ON == config_get( 'use_ldap_email' ) ) {
 					# With LDAP
 					echo string_display_line( $u_email );
-				} else {
+				} 
+				// With CAS AUTH
+				else if ( $t_cas_auth ) {
+				echo string_display_line( $u_email );
+				}
+				else {
 					# Without LDAP
 					$t_show_update_button = true;
 					print_email_input( 'email', $u_email );
 				} ?>
 				</td>
@@ -228,11 +234,16 @@
 					# With LDAP
 					echo '<td class="category">' . lang_get( 'realname' ) . '</td>';
 					echo '<td>';
 					echo string_display_line( ldap_realname_from_username( $u_username ) );
 					echo '</td>';
-				} else {
+				} 
+				// With CAS AUTH
+				else if ( $t_cas_auth ) {
+					echo string_display_line( $u_username );
+				}
+				else {
 					# Without LDAP
 					$t_show_update_button = true;
 					echo '<td class="category">' . lang_get( 'realname' ) . '</td>';
 					echo '<td>';
 					echo '<input class="input-sm" id="realname" type="text" size="32" maxlength="' . DB_FIELD_SIZE_REALNAME . '" name="realname" value="' . string_attribute( $u_realname ) . '" />';
diff -rNU5 mantisbt/api/soap/mantisconnect.wsdl mantisbt-2.0.0/api/soap/mantisconnect.wsdl
--- mantisbt/api/soap/mantisconnect.wsdl	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/api/soap/mantisconnect.wsdl	2017-03-09 10:49:50.000000000 +0100
@@ -36,10 +36,12 @@
   <xsd:all>
    <xsd:element name="id" type="xsd:integer" minOccurs="0"/>
    <xsd:element name="name" type="xsd:string" minOccurs="0"/>
    <xsd:element name="real_name" type="xsd:string" minOccurs="0"/>
    <xsd:element name="email" type="xsd:string" minOccurs="0"/>
+   <xsd:element name="access" type="xsd:integer" minOccurs="0"/>
+   <xsd:element name="language" type="xsd:string" minOccurs="0" />   
   </xsd:all>
  </xsd:complexType>
  <xsd:complexType name="UserData">
   <xsd:all>
    <xsd:element name="account_data" type="tns:AccountData" minOccurs="0"/>
@@ -217,10 +219,11 @@
   </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="ProjectData">
   <xsd:all>
    <xsd:element name="id" type="xsd:integer" minOccurs="0"/>
+   <xsd:element name="parent_id" type="xsd:integer" minOccurs="0" />
    <xsd:element name="name" type="xsd:string" minOccurs="0"/>
    <xsd:element name="status" type="tns:ObjectRef" minOccurs="0"/>
    <xsd:element name="enabled" type="xsd:boolean" minOccurs="0"/>
    <xsd:element name="view_state" type="tns:ObjectRef" minOccurs="0"/>
    <xsd:element name="access_min" type="tns:ObjectRef" minOccurs="0"/>
@@ -618,10 +621,45 @@
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" />
   <part name="issue_attachment_id" type="xsd:integer" /></message>
 <message name="mc_issue_attachment_getResponse">
   <part name="return" type="xsd:base64Binary" /></message>
+<message name="mc_account_addRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="account" type="tns:AccountData" />
+  <part name="account_password" type="xsd:string" />
+</message>
+<message name="mc_account_addResponse">
+  <part name="return" type="xsd:integer" />
+</message>
+<message name="mc_account_getRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="account_username" type="xsd:string" />
+</message>
+<message name="mc_account_getResponse">
+  <part name="return" type="xsd:integer" />
+</message>
+<message name="mc_account_updateRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="account_id" type="xsd:integer" />
+  <part name="account" type="tns:AccountData" />
+  <part name="account_password" type="xsd:string" />
+</message>
+<message name="mc_account_updateResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
+<message name="mc_account_deleteRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="user_id" type="xsd:integer" />
+</message>
+<message name="mc_account_deleteResponse">
+  <part name="return" type="xsd:boolean" />
+</message> 
 <message name="mc_project_addRequest">
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" />
   <part name="project" type="tns:ProjectData" /></message>
 <message name="mc_project_addResponse">
@@ -669,10 +707,29 @@
   <part name="project_id" type="xsd:integer" />
   <part name="page_number" type="xsd:integer" />
   <part name="per_page" type="xsd:integer" /></message>
 <message name="mc_project_get_issue_headersResponse">
   <part name="return" type="tns:IssueHeaderDataArray" /></message>
+<message name="mc_project_add_userRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+  <part name="user_id" type="xsd:integer" />
+  <part name="access" type="xsd:integer" />
+</message>
+<message name="mc_project_add_userResponse">
+  <part name="return" type="xsd:integer" />
+</message>
+<message name="mc_project_remove_userRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+  <part name="user_id" type="xsd:integer" />
+</message>
+<message name="mc_project_remove_userResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
 <message name="mc_project_get_usersRequest">
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" />
   <part name="project_id" type="xsd:integer" />
   <part name="access" type="xsd:integer" /></message>
@@ -681,10 +738,17 @@
 <message name="mc_projects_get_user_accessibleRequest">
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" /></message>
 <message name="mc_projects_get_user_accessibleResponse">
   <part name="return" type="tns:ProjectDataArray" /></message>
+<message name="mc_projects_get_names_user_accessibleRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+</message>
+<message name="mc_projects_get_names_user_accessibleResponse">
+  <part name="return" type="tns:ProjectDataArray" />
+</message>
 <message name="mc_project_get_categoriesRequest">
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" />
   <part name="project_id" type="xsd:integer" /></message>
 <message name="mc_project_get_categoriesResponse">
@@ -883,10 +947,62 @@
   <part name="username" type="xsd:string" />
   <part name="password" type="xsd:string" />
   <part name="tag_id" type="xsd:integer" /></message>
 <message name="mc_tag_deleteResponse">
   <part name="return" type="xsd:boolean" /></message>
+<message name="mc_configure_managementRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_name" type="xsd:string" />
+</message>
+<message name="mc_configure_managementResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
+<message name="mc_management_updateRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+  <part name="project" type="tns:ProjectData" />
+</message>
+<message name="mc_management_updateResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
+<message name="mc_management_deleteRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+</message>
+<message name="mc_management_deleteResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
+<message name="mc_management_add_userRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+  <part name="user_id" type="xsd:integer" />
+  <part name="access" type="xsd:integer" />
+</message>
+<message name="mc_management_add_userResponse">
+  <part name="return" type="xsd:integer" />
+</message>
+<message name="mc_management_remove_userRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_id" type="xsd:integer" />
+  <part name="user_id" type="xsd:integer" />
+</message>
+<message name="mc_management_remove_userResponse">
+  <part name="return" type="xsd:boolean" />
+</message>
+<message name="mc_get_all_issues_by_projectRequest">
+  <part name="username" type="xsd:string" />
+  <part name="password" type="xsd:string" />
+  <part name="project_name" type="xsd:string" />
+</message>
+<message name="mc_get_all_issues_by_projectResponse">
+  <part name="return" type="tns:IssueDataArray" />
+</message>
 <portType name="MantisConnectPortType">
   <operation name="mc_version">
     <input message="tns:mc_versionRequest"/>
     <output message="tns:mc_versionResponse"/>
   </operation>
@@ -1053,10 +1169,30 @@
   <operation name="mc_issue_attachment_get">
     <documentation>Get the data for the specified issue attachment.</documentation>
     <input message="tns:mc_issue_attachment_getRequest"/>
     <output message="tns:mc_issue_attachment_getResponse"/>
   </operation>
+  <operation name="mc_account_add">
+    <documentation>Add a new user to the tracker (must have admin privileges)</documentation>
+    <input message="tns:mc_account_addRequest"/>
+    <output message="tns:mc_account_addResponse"/>
+  </operation>
+  <operation name="mc_account_get">
+    <documentation>Get a user account id from username on the tracker (must have admin privileges)</documentation>
+    <input message="tns:mc_account_getRequest"/>
+    <output message="tns:mc_account_getResponse"/>
+  </operation>
+  <operation name="mc_account_update">
+    <documentation>Update a user account on the tracker (must have admin privileges)</documentation>
+    <input message="tns:mc_account_updateRequest"/>
+    <output message="tns:mc_account_updateResponse"/>
+ </operation>
+ <operation name="mc_account_delete">
+    <documentation>Delete a user account on the tracker (must have admin privileges)</documentation>
+    <input message="tns:mc_account_deleteRequest"/>
+    <output message="tns:mc_account_deleteResponse"/>
+  </operation> 
   <operation name="mc_project_add">
     <documentation>Add a new project to the tracker (must have admin privileges)</documentation>
     <input message="tns:mc_project_addRequest"/>
     <output message="tns:mc_project_addResponse"/>
   </operation>
@@ -1088,20 +1224,35 @@
   <operation name="mc_project_get_issue_headers">
     <documentation>Get the issue headers that match the specified project id and paging details. Pass &quot;-1&quot; for the per_page parameter to get all issues.</documentation>
     <input message="tns:mc_project_get_issue_headersRequest"/>
     <output message="tns:mc_project_get_issue_headersResponse"/>
   </operation>
+       <operation name="mc_project_add_user">
+    <documentation>Add a user to a project with access level.</documentation>
+    <input message="tns:mc_project_add_userRequest"/>
+    <output message="tns:mc_project_add_userResponse"/>
+  </operation>
+  <operation name="mc_project_remove_user">
+    <documentation>Remove a user from a project.</documentation>
+    <input message="tns:mc_project_remove_userRequest"/>
+    <output message="tns:mc_project_remove_userResponse"/>
+  </operation> 
   <operation name="mc_project_get_users">
     <documentation>Get appropriate users assigned to a project by access level.</documentation>
     <input message="tns:mc_project_get_usersRequest"/>
     <output message="tns:mc_project_get_usersResponse"/>
   </operation>
   <operation name="mc_projects_get_user_accessible">
     <documentation>Get the list of projects that are accessible to the logged in user.</documentation>
     <input message="tns:mc_projects_get_user_accessibleRequest"/>
     <output message="tns:mc_projects_get_user_accessibleResponse"/>
   </operation>
+  <operation name="mc_projects_get_names_user_accessible">
+    <documentation>Get the list of name/id of projects that are accessible to the logged in user.</documentation>
+    <input message="tns:mc_projects_get_names_user_accessibleRequest" />
+    <output message="tns:mc_projects_get_names_user_accessibleResponse" />
+  </operation>
   <operation name="mc_project_get_categories">
     <documentation>Get the categories belonging to the specified project.</documentation>
     <input message="tns:mc_project_get_categoriesRequest"/>
     <output message="tns:mc_project_get_categoriesResponse"/>
   </operation>
@@ -1243,375 +1394,470 @@
   <operation name="mc_tag_delete">
     <documentation>Deletes a tag.</documentation>
     <input message="tns:mc_tag_deleteRequest"/>
     <output message="tns:mc_tag_deleteResponse"/>
   </operation>
+  <operation name="mc_configure_management">
+    <documentation>Configure the mantis in management way</documentation>
+    <input message="tns:mc_configure_managementRequest"/>
+    <output message="tns:mc_configure_managementResponse"/>
+  </operation>
+  <operation name="mc_management_update">
+    <documentation>Update mantis management configuration</documentation>
+    <input message="tns:mc_management_updateRequest"/>
+    <output message="tns:mc_management_updateResponse"/>
+  </operation>
+  <operation name="mc_management_delete">
+    <documentation>Delete mantis management configuration</documentation>
+    <input message="tns:mc_management_deleteRequest"/>
+    <output message="tns:mc_management_deleteResponse"/>
+  </operation>
+  <operation name="mc_management_add_user">
+    <documentation>Add users in mantis management</documentation>
+    <input message="tns:mc_management_add_userRequest"/>
+    <output message="tns:mc_management_add_userResponse"/>
+  </operation>
+  <operation name="mc_management_remove_user">
+    <documentation>Remove users in mantis management</documentation>
+    <input message="tns:mc_management_remove_userRequest"/>
+    <output message="tns:mc_management_remove_userResponse"/>
+  </operation>
+  <operation name="mc_get_all_issues_by_project">
+    <documentation>Get all project param bugs</documentation>
+    <input message="tns:mc_get_all_issues_by_projectRequest"/>
+    <output message="tns:mc_get_all_issues_by_projectResponse"/>
+  </operation>
 </portType>
 <binding name="MantisConnectBinding" type="tns:MantisConnectPortType">
   <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
   <operation name="mc_version">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_version" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_version" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_login">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_login" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_login" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_status">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_status" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_status" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_priorities">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_priorities" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_priorities" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_severities">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_severities" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_severities" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_reproducibilities">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_reproducibilities" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_reproducibilities" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_projections">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_projections" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_projections" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_etas">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_etas" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_etas" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_resolutions">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_resolutions" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_resolutions" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_access_levels">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_access_levels" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_access_levels" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_project_status">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_project_status" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_project_status" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_project_view_states">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_project_view_states" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_project_view_states" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_view_states">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_view_states" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_view_states" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_custom_field_types">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_custom_field_types" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_custom_field_types" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_enum_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_enum_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_enum_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_exists">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_exists" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_exists" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issues_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issues_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issues_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issues_get_header">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issues_get_header" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issues_get_header" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_get_history">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_get_history" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_get_history" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_get_biggest_id">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_get_biggest_id" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_get_biggest_id" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_get_id_from_summary">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_get_id_from_summary" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_get_id_from_summary" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_update">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_update" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_update" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_set_tags">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_set_tags" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_set_tags" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_note_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_note_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_note_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_note_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_note_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_note_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_note_update">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_note_update" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_note_update" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_relationship_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_relationship_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_relationship_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_relationship_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_relationship_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_relationship_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_attachment_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_attachment_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_attachment_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_attachment_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_attachment_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_attachment_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_attachment_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_attachment_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_attachment_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_update">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_update" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_update" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_id_from_name">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_id_from_name" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_id_from_name" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_issues_for_user">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_issues_for_user" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_issues_for_user" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_issues">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_issues" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_issues" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_issue_headers">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_issue_headers" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_issue_headers" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
+  <operation name="mc_project_add_user">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_add_user" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_project_remove_user">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_remove_user" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
   <operation name="mc_project_get_users">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_users" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_users" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_projects_get_user_accessible">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_projects_get_user_accessible" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_projects_get_user_accessible" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
+  <operation name="mc_projects_get_names_user_accessible">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_projects_get_names_user_accessible" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>  
   <operation name="mc_project_get_categories">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_categories" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_categories" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_add_category">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_add_category" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_add_category" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_delete_category">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_delete_category" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_delete_category" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_rename_category_by_name">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_rename_category_by_name" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_rename_category_by_name" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_versions">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_versions" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_versions" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_version_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_version_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_version_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_version_update">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_version_update" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_version_update" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_version_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_version_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_version_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_released_versions">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_released_versions" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_released_versions" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_unreleased_versions">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_unreleased_versions" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_unreleased_versions" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_attachments">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_attachments" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_attachments" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_custom_fields">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_custom_fields" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_custom_fields" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_attachment_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_attachment_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_attachment_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_attachment_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_attachment_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_attachment_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_attachment_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_attachment_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_attachment_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_project_get_all_subprojects">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_project_get_all_subprojects" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_project_get_all_subprojects" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_get">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_get" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_get" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_get_issues">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_get_issues" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_get_issues" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_get_issue_headers">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_get_issue_headers" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_get_issue_headers" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_search_issue_headers">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_search_issue_headers" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_search_issue_headers" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_search_issues">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_search_issues" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_search_issues" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_filter_search_issue_ids">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_filter_search_issue_ids" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_filter_search_issue_ids" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_config_get_string">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_config_get_string" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_config_get_string" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_issue_checkin">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_issue_checkin" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_issue_checkin" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_user_pref_get_pref">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_user_pref_get_pref" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_user_pref_get_pref" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_user_profiles_get_all">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_user_profiles_get_all" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_user_profiles_get_all" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_tag_get_all">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_tag_get_all" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_tag_get_all" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_tag_add">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_tag_add" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_tag_add" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
   <operation name="mc_tag_delete">
-    <soap:operation soapAction="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php/mc_tag_delete" style="rpc"/>
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_tag_delete" style="rpc"/>
     <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></input>
     <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/></output>
   </operation>
+    <operation name="mc_account_add">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_account_add" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_account_get">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_account_get" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_account_update">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_account_update" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_account_delete">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_account_delete" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation> 
+  <operation name="mc_configure_management">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_configure_management" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>  
+  <operation name="mc_management_update">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_management_update" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_management_delete">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_management_delete" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_management_add_user">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_management_add_user" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation> 
+  <operation name="mc_management_remove_user">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_management_remove_user" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>
+  <operation name="mc_get_all_issues_by_project">
+    <soap:operation soapAction="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php/mc_get_all_issues_by_project" style="rpc" />
+    <input><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></input>
+    <output><soap:body use="encoded" namespace="http://futureware.biz/mantisconnect" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" /></output>
+  </operation>   
 </binding>
 <service name="MantisConnect">
   <port name="MantisConnectPort" binding="tns:MantisConnectBinding">
-    <soap:address location="http://www.mantisbt.org/bugs/api/soap/mantisconnect.php"/>
+    <soap:address location="http://localhost/mantis_ard-default/mantis_ard/api/soap/mantisconnect.php"/>
   </port>
 </service>
 </definitions>
diff -rNU5 mantisbt/api/soap/mc_account_api.php mantisbt-2.0.0/api/soap/mc_account_api.php
--- mantisbt/api/soap/mc_account_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/api/soap/mc_account_api.php	2017-02-03 11:18:03.000000000 +0100
@@ -18,10 +18,11 @@
  * A webservice interface to Mantis Bug Tracker
  *
  * @package MantisBT
  * @copyright Copyright 2004  Victor Boctor - vboctor@users.sourceforge.net
  * @copyright Copyright 2005  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  */
 
 /**
  * Get username, realname and email from for a given user id
@@ -78,5 +79,193 @@
 		$t_result[] = mci_account_get_array_by_id( $t_user_id );
 	}
 
 	return $t_result;
 }
+
+/** 
+* Add a new user.
+*
+* @param string $p_username  The name of the user trying to create an account.
+* @param string $p_password  The password of the user.
+* @param Array $p_user A new AccountData structure
+* @return integer the new users's users_id
+*/
+function mc_account_add( $p_username, $p_password, $p_user, $p_pass ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );               
+	if ( $t_user_id === false ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access denied. Username/password combination was incorrect' );
+	}
+
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access denied. User does not have administrator access' );
+	}
+
+	//extract( $p_user, EXTR_PREFIX_ALL, 'v');
+
+	// validate user object
+	if ( is_blank($p_user->name) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "name" was missing');
+	if ( is_blank($p_user->real_name) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "real_name" was missing');
+	if ( is_blank($p_user->email) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "email" was missing');
+
+	if ( !user_is_name_valid( $p_user->name ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'user name invalid');
+	if ( !user_is_name_unique( $p_user->name ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'user name exists');
+	if ( !user_is_email_unique( $p_user->email ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Email exists');	
+	if ( !email_is_valid( $p_user->email ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Email invalid');
+
+	// set defaults
+	if ( is_null( $p_user->access ) ) $p_user->access = config_get( 'default_new_account_access_level' );
+
+	// create user account and get it's id
+	user_create($p_user->name, $p_pass, $p_user->email, $p_user->access, false, true, $p_user->real_name);
+	$t_user_id = user_get_id_by_name($p_user->name);
+
+	// Define user language
+	if ( !is_blank($p_user->language) )
+	{
+		if($p_user->language == "FR")
+			$mantis_language = "french";
+		else
+			$mantis_language = "english";
+		user_pref_set_pref( $t_user_id, 'language', $mantis_language );
+	}
+	// return id of new user back to caller
+	return $t_user_id;
+}
+
+/** 
+* Get user id from username
+*
+* @param string $p_username  The name of the user trying to create an account.
+* @param string $p_password  The password of the user.
+* @param string $p_user_account The username of the user account wanted
+* @return account's id
+
+*/
+function mc_account_get( $p_username, $p_password, $p_account_username ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );               
+	if ( $t_user_id === false ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. Username/password combination was incorrect');
+	}
+
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. User does not have administrator access');
+	}
+
+	if ( (is_null($p_account_username)) || (is_blank($p_account_username)) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "account_username" was missing');
+
+	//Get content user account information
+	$row = user_get_row_by_name($p_account_username);
+	$user_id = $row['id'];
+		
+	// Return whole information
+	return $user_id;
+}
+
+/** 
+* Update a user.
+*
+* @param string $p_username  The name of the user trying to create an account.
+* @param string $p_password  The password of the user.
+* @param integer $p_user_id A user's id
+* @param Array $p_user A new AccountData structure
+* @return boolean
+*/
+function mc_account_update( $p_username, $p_password, $p_user_id, $p_user, $p_pass ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );               
+	if ( $t_user_id === false ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. Username/password combination was incorrect');
+	}
+
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access denied. User does not have administrator access' );
+	}
+
+	if ( (is_null($p_user_id)) || (is_blank($p_user_id)) ) 
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "id" was missing');
+	//Add check if user exists
+	if ( !user_exists($p_user_id) ) 
+	return SoapObjectsFactory::newSoapFault( 'Client', 'The user id doesn t exist' );
+
+	
+	//Get content user account information
+	$row = user_get_row($p_user_id);
+	
+	//Check if username needs to be updated
+   	if ( (isset( $p_user->name )) && (!is_null($p_user->name)) && (!is_blank($p_user->name)) ) {
+    
+		if ( $row['username'] != $p_user->name ) {
+			if ( !user_is_name_valid( $p_user->name ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'user name invalid');
+			if ( !user_is_name_unique( $p_user->name ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'user name exists');
+			user_set_name( $p_user_id, $p_user->name );
+		}
+    	}
+	
+	//Check if real name needs to be updated
+   	if ( (isset( $p_user->real_name )) && (!is_null($p_user->real_name)) && (!is_blank($p_user->real_name)) ){
+		if ( $row['realname'] != $p_user->real_name) {
+			if ( !user_is_realname_valid( $p_user->real_name) ) return SoapObjectsFactory::newSoapFault( 'Client', 'real name invalid');
+			user_set_realname( $p_user_id, $p_user->real_name);
+		}
+	}
+	
+	//Check if email needs to be updated
+	if ( (isset( $p_user->email )) && (!is_null($p_user->email)) && (!is_blank($p_user->email)) ) {
+		if ( $row['email'] != $p_user->email ) {
+			if ( !email_is_valid( $p_user->email ) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Email invalid');
+			user_set_email( $p_user_id, $p_user->email );
+		}	
+	}
+	
+	//Check if access level needs to be updated
+	if ( (isset( $p_user->access )) &&(!is_null($p_user->access)) && (!is_blank($p_user->access)) && ($p_user->access != 0) ) {
+		if ( $row['access_level'] != $p_user->access ) {
+			user_set_field( $p_user_id, 'access_level', $p_user->access );
+		}
+	}
+	
+	//Check if password needs to be updated
+	if ( !is_blank($p_pass) ) {
+		user_set_password( $p_user_id, $p_pass, false );
+	}
+
+	// Update Language
+        if ( !is_blank($p_user->language) )
+        {
+                if($p_user->language == "FR")
+                        $mantis_language = "french";
+                else
+                        $mantis_language = "english";
+                user_pref_set_pref( $p_user_id, 'language', $mantis_language );
+        }
+
+	
+	// return id of user back to caller
+	return true;
+}
+
+/** 
+* Delete a user.
+*
+* @param string $p_username  The name of the user trying to create an account.
+* @param string $p_password  The password of the user.
+* @param Array $p_id the uers_id
+* @return boolean about success
+*/
+function mc_account_delete( $p_username, $p_password, $p_user_id ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );               
+	if ( $t_user_id === false ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. Username/password combination was incorrect');
+	}
+
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. User does not have administrator access');
+	}
+
+	if ( (is_null($p_user_id)) || (is_blank($p_user_id)) ) return SoapObjectsFactory::newSoapFault( 'Client', 'Mandatory field "id" was missing');
+		
+	user_delete( $p_user_id );
+	
+	return true;
+}
+
+
diff -rNU5 mantisbt/api/soap/mc_api.php mantisbt-2.0.0/api/soap/mc_api.php
--- mantisbt/api/soap/mc_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/api/soap/mc_api.php	2017-02-03 11:17:42.000000000 +0100
@@ -18,10 +18,11 @@
  * A webservice interface to Mantis Bug Tracker
  *
  * @package MantisBT
  * @copyright Copyright 2004  Victor Boctor - vboctor@users.sourceforge.net
  * @copyright Copyright 2005  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  */
 
 # set up error_handler() as the new default error handling function
 set_error_handler( 'mc_error_handler' );
@@ -474,10 +475,24 @@
 	}
 
 	return $t_result;
 }
 
+# Gets the name/id of all sub-projects that are accessible to the specified user / project.
+function mci_user_get_names_accessible_subprojects( $p_user_id, $p_parent_project_id ) {
+	$t_result = array();
+	foreach( user_get_accessible_subprojects( $p_user_id, $p_parent_project_id ) as $t_subproject_id ) {
+		$t_subproject_row = project_cache_row( $t_subproject_id );
+		$t_subproject = array();
+		$t_subproject['id'] = $t_subproject_id;
+		$t_subproject['name'] = $t_subproject_row['name'];
+		$t_subproject['subprojects'] = mci_user_get_names_accessible_subprojects( $p_user_id, $t_subproject_id );
+		$t_result[] = $t_subproject;
+	}
+	return $t_result;
+}
+
 /**
  * Convert a category name to a category id for a given project
  * @param string  $p_category_name Category name.
  * @param integer $p_project_id    Project id.
  * @return integer category id or 0 if not found
diff -rNU5 mantisbt/api/soap/mc_core.php mantisbt-2.0.0/api/soap/mc_core.php
--- mantisbt/api/soap/mc_core.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/api/soap/mc_core.php	2017-02-03 11:18:13.000000000 +0100
@@ -18,16 +18,22 @@
  * A webservice interface to Mantis Bug Tracker
  *
  * @package MantisBT
  * @copyright Copyright 2004  Victor Boctor - vboctor@users.sourceforge.net
  * @copyright Copyright 2005  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  */
 
 # constants and configurations
 $t_current_dir = dirname( __FILE__ ) . '/';
 
+$t_user_configs = $t_current_dir . 'mc_config_inc.php';
+if( file_exists( $t_user_configs ) ) {
+	require_once( $t_user_configs );
+}
+
 # MantisConnect APIs
 #   mc_* = public methods
 #   mci_* = internal methods
 require_once( $t_current_dir . 'mc_api.php' );
 require_once( $t_current_dir . 'mc_account_api.php' );
@@ -35,10 +41,11 @@
 require_once( $t_current_dir . 'mc_filter_api.php' );
 require_once( $t_current_dir . 'mc_issue_api.php' );
 require_once( $t_current_dir . 'mc_issue_attachment_api.php' );
 require_once( $t_current_dir . 'mc_project_api.php' );
 require_once( $t_current_dir . 'mc_project_attachment_api.php' );
+require_once( $t_current_dir . 'mc_management_api.php' );
 require_once( $t_current_dir . 'mc_file_api.php' );
 require_once( $t_current_dir . 'mc_config_api.php' );
 require_once( $t_current_dir . 'mc_custom_field_api.php' );
 require_once( $t_current_dir . 'mc_user_pref_api.php' );
 require_once( $t_current_dir . 'mc_tag_api.php' );
diff -rNU5 mantisbt/api/soap/mc_project_api.php mantisbt-2.0.0/api/soap/mc_project_api.php
--- mantisbt/api/soap/mc_project_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/api/soap/mc_project_api.php	2017-02-03 11:17:53.000000000 +0100
@@ -18,10 +18,11 @@
  * A webservice interface to Mantis Bug Tracker
  *
  * @package MantisBT
  * @copyright Copyright 2004  Victor Boctor - vboctor@users.sourceforge.net
  * @copyright Copyright 2005  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  */
 
 /**
  * Use a standard filter to get issues associated with the specified user.
@@ -178,10 +179,42 @@
 
 	return $t_result;
 }
 
 /**
+ * Get (only) the id and name for all projects accessible by the given user.
+ *
+ * @param string $p_username  The name of the user trying to access the project list.
+ * @param string $p_password  The password of the user.
+ * @return Array  suitable to be converted into a ProjectDataArray
+ */
+function mc_projects_get_names_user_accessible( $p_username, $p_password ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );
+	if( $t_user_id === false ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied' );
+	}
+
+	if( !mci_has_readonly_access( $t_user_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied' );
+	}
+
+	$t_lang = mci_get_user_lang( $t_user_id );
+
+	$t_result = array();
+	foreach( user_get_accessible_projects( $t_user_id ) as $t_project_id ) {
+		$t_project_row = project_cache_row( $t_project_id );
+		$t_project = array();
+		$t_project['id'] = $t_project_id;
+		$t_project['name'] = $t_project_row['name'];
+		$t_project['subprojects'] = mci_user_get_names_accessible_subprojects( $t_user_id, $t_project_id, $t_lang );
+		$t_result[] = $t_project;
+	}
+
+	return $t_result;
+}
+
+/**
  * Get all categories of a project.
  *
  * @param string  $p_username   The name of the user trying to access the categories.
  * @param string  $p_password   The password of the user.
  * @param integer $p_project_id The id of the project to retrieve the categories for.
@@ -886,21 +919,41 @@
 	if( isset( $p_project['inherit_global'] ) ) {
 		$t_inherit_global = $p_project['inherit_global'];
 	} else {
 		$t_inherit_global = true;
 	}
-
+	
+	if ( isset( $p_project['parent_id'] ) ) {
+		$t_parent_id = $p_project['parent_id'];
+		if ( !project_exists( $t_parent_id ) ) {
+			return  SoapObjectsFactory::newSoapFault( 'Client', 'Parent project does not exist');
+		}
+	} else {
+		$t_parent_id = false;
+	}
 	# check to make sure project doesn't already exist
 	if( !project_is_name_unique( $t_name ) ) {
 		return SoapObjectsFactory::newSoapFault( 'Client', 'Project name exists' );
 	}
 
 	$t_project_status = mci_get_project_status_id( $t_status );
 	$t_project_view_state = mci_get_project_view_state_id( $t_view_state );
 
-	# project_create returns the new project's id, spit that out to web service caller
-	return project_create( $t_name, $t_description, $t_project_status, $t_project_view_state, $t_file_path, $t_enabled, $t_inherit_global );
+	// project_create returns the new project's id
+	$t_project_id = project_create( $t_name, $t_description, $t_project_status, $t_project_view_state, $t_file_path, $t_enabled, $t_inherit_global );
+
+	// link new project to a parent project, if one has been specified
+	if ( $t_parent_id ) {
+		// link to parent
+		project_hierarchy_add($t_project_id, $t_parent_id);
+
+		// copy custom fields from parent
+		project_copy_custom_fields($t_project_id, $t_parent_id);
+	}
+	instance_configuration_create($t_project_id);
+	// return id of new project back to caller
+	return $t_project_id;
 }
 
 /**
  * Update a project
  *
@@ -948,20 +1001,20 @@
 	} else {
 		$t_description = $p_project['description'];
 	}
 
 	if( !isset( $p_project['status'] ) ) {
-		$t_status = project_get_field( $p_project_id, 'status' );
+		$t_project_status = project_get_field( $p_project_id, 'status' );
 	} else {
-		$t_status = $p_project['status'];
+		$t_project_status = mci_get_project_status_id( $p_project['status'] );
 	}
 
-	if( !isset( $p_project['view_state'] ) ) {
-		$t_view_state = project_get_field( $p_project_id, 'view_state' );
-	} else {
-		$t_view_state = $p_project['view_state'];
-	}
+	if ( !isset( $p_project['view_state'] ) ) {
+        $t_project_view_state = project_get_field( $p_project_id, 'view_state' );
+    } else {
+    	$t_project_view_state = mci_get_project_view_state_id( $p_project['view_state'] );
+    }
 
 	if( !isset( $p_project['file_path'] ) ) {
 		$t_file_path = project_get_field( $p_project_id, 'file_path' );
 	} else {
 		$t_file_path = $p_project['file_path'];
@@ -977,13 +1030,10 @@
 		$t_inherit_global = project_get_field( $p_project_id, 'inherit_global' );
 	} else {
 		$t_inherit_global = $p_project['inherit_global'];
 	}
 
-	$t_project_status = mci_get_project_status_id( $t_status );
-	$t_project_view_state = mci_get_project_view_state_id( $t_view_state );
-
 	project_update( $p_project_id, $t_name, $t_description, $t_project_status, $t_project_view_state, $t_file_path, $t_enabled, $t_inherit_global );
 
 	return true;
 }
 
@@ -1058,12 +1108,73 @@
 		$t_result[] = mci_issue_data_as_header_array( $t_issue_data );
 	}
 
 	return $t_result;
 }
+/**
+ * Link a user to a project with a specified access level.
+ *
+ * @param string $p_username  The name of the user trying to add the user (must be administrator)
+ * @param string $p_password  The password of the user.
+ * @param integer $p_project_id  The id of the project to link user to.
+ * @param integer $p_user_id  The id of the user to link to the project.
+ * @param integer $p_access access level.
+ * @return bool returns true or false depending on the success of the action
+ */
+function mc_project_add_user( $p_username, $p_password, $p_project_id, $p_user_id, $p_access ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );
+	if ( $t_user_id === false ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied' );
+	}
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. User does not have administrator access');
+	}
+
+	if ( !project_exists( $p_project_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', "Project '$p_project_id' does not exist." );
+	}
+	if ( !user_exists( $p_user_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', "User '$p_user_id' does not exist." );
+	}
+
+	// add the user to the project
+	$t_status = project_set_user_access( $p_project_id, $p_user_id, $p_access );
+
+	return $t_status;
+}
 
 /**
+ * Remove a user from a project.
+ *
+ * @param string $p_username  The name of the user trying to add the user (must be administrator)
+ * @param string $p_password  The password of the user.
+ * @param integer $p_project_id  The id of the project to link user to.
+ * @param integer $p_user_id  The id of the user to link to the project.
+ * @return bool returns true or false depending on the success of the action
+ */
+function mc_project_remove_user( $p_username, $p_password, $p_project_id, $p_user_id ) {
+	$t_user_id = mci_check_login( $p_username, $p_password );
+	if ( $t_user_id === false ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied' );
+	}
+	if ( !mci_has_administrator_access( $t_user_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', 'Access Denied. User does not have administrator access');
+	}
+
+	if ( !project_exists( $p_project_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', "Project '$p_project_id' does not exist." );
+	}
+	if ( !user_exists( $p_user_id ) ) {
+		return  SoapObjectsFactory::newSoapFault( 'Client', "User '$p_user_id' does not exist." );
+	}
+
+	// add the user to the project
+	project_remove_user( $p_project_id, $p_user_id );
+
+	return true;
+}
+/**
  * Get appropriate users assigned to a project by access level.
  *
  * @param string  $p_username   The name of the user trying to access the versions.
  * @param string  $p_password   The password of the user.
  * @param integer $p_project_id The id of the project to retrieve the users for.
diff -rNU5 mantisbt/bug_actiongroup_page.php mantisbt-2.0.0/bug_actiongroup_page.php
--- mantisbt/bug_actiongroup_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_actiongroup_page.php	2017-02-03 11:19:44.000000000 +0100
@@ -18,10 +18,11 @@
  * This page allows actions to be performed on an array of bugs
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -57,13 +58,21 @@
 require_api( 'utility_api.php' );
 require_api( 'version_api.php' );
 
 auth_ensure_user_authenticated();
 
+$f_link_id = gpc_get_string( 'link_id', 0 );
 $f_action = gpc_get_string( 'action', '' );
 $f_bug_arr = gpc_get_int_array( 'bug_arr', array() );
 
+if ( 0 != $f_link_id ) {
+	foreach ( $f_bug_arr as $t_bug_id ) {
+		relationship_add( $t_bug_id, $f_link_id, 2 );
+	}
+	print_successful_redirect( 'view.php?id='.$f_link_id );
+}
+
 # redirects to all_bug_page if nothing is selected
 if( is_blank( $f_action ) || ( 0 == count( $f_bug_arr ) ) ) {
 	print_header_redirect( 'view_all_bug_page.php' );
 }
 
diff -rNU5 mantisbt/bug_actiongroup.php mantisbt-2.0.0/bug_actiongroup.php
--- mantisbt/bug_actiongroup.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_actiongroup.php	2017-02-03 11:19:08.000000000 +0100
@@ -18,10 +18,11 @@
  * This page allows actions to be performed an an array of bugs
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -60,10 +61,11 @@
 require_api( 'lang_api.php' );
 require_api( 'print_api.php' );
 require_api( 'string_api.php' );
 require_api( 'utility_api.php' );
 require_api( 'version_api.php' );
+require_api( 'risk_criteria_api.php' );
 
 auth_ensure_user_authenticated();
 helper_begin_long_process();
 
 $f_action	= gpc_get_string( 'action' );
@@ -120,10 +122,17 @@
 				$t_failed_ids[$t_bug_id] = lang_get( 'bug_actiongroup_access' );
 			}
 			break;
 		case 'DELETE':
 			if( access_has_bug_level( config_get( 'delete_bug_threshold' ), $t_bug_id ) ) {
+				# Manage risk criteria
+				$t_bug_summary = $t_bug->summary;
+				if ( project_get_other_type_project_id('risk') == helper_get_current_project()) {
+					$risk_criteria_id = risk_criteria_get_id_by_name($t_bug_summary);
+					$risk_criteria = risk_criteria_get($risk_criteria_id);
+					$risk_criteria->delete();
+				}
 				bug_delete( $t_bug_id );
 			} else {
 				$t_failed_ids[$t_bug_id] = lang_get( 'bug_actiongroup_access' );
 			}
 			break;
diff -rNU5 mantisbt/bug_report_page.php mantisbt-2.0.0/bug_report_page.php
--- mantisbt/bug_report_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_report_page.php	2017-02-09 15:29:14.000000000 +0100
@@ -18,10 +18,11 @@
  * This file POSTs data to report_bug.php
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -75,10 +76,27 @@
 require_api( 'relationship_api.php' );
 require_api( 'string_api.php' );
 require_api( 'utility_api.php' );
 require_api( 'version_api.php' );
 
+if ( 1 == preg_match('/management/i', project_get_type_management() ) ) {
+	print_header_redirect( 'my_view_page.php' );		
+}
+# if a creation button action is selected from a risk 
+if ( null != $_GET['relationship_id']) {
+	if ( null != $_GET['project_id']) {
+		//$g_project_override is set to null to allow setting new project
+		global $g_project_override;
+		$g_project_override = null;
+		helper_set_current_project($_GET['project_id']);
+		print_header_redirect( 'bug_report_page.php?relationship_id='.$_GET['relationship_id'] );
+	}
+	else {
+		$f_link_id = $_GET['relationship_id'];			
+	}
+}
+
 $f_master_bug_id = gpc_get_int( 'm_id', 0 );
 
 if( $f_master_bug_id > 0 ) {
 	# master bug exists...
 	bug_ensure_exists( $f_master_bug_id );
@@ -240,10 +258,11 @@
 	action="bug_report.php?posted=1"
 	class="dropzone-form"
 	<?php print_dropzone_form_data() ?>>
 <?php echo form_security_field( 'bug_report' ) ?>
 <input type="hidden" name="m_id" value="<?php echo $f_master_bug_id ?>" />
+<input type="hidden" name="link_id" value="<?php echo $f_link_id ?>" />
 <input type="hidden" name="project_id" value="<?php echo $t_project_id ?>" />
 <div class="widget-box widget-color-blue2">
 	<div class="widget-header widget-header-small">
 		<h4 class="widget-title lighter">
 				<i class="ace-icon fa fa-edit"></i>
@@ -271,23 +290,23 @@
 		<td width="70%">
 			<?php if( $t_changed_project ) {
 				echo '[' . project_get_field( $t_bug->project_id, 'name' ) . '] ';
 			} ?>
 			<select <?php echo helper_get_tab_index() ?> id="category_id" name="category_id" class="autofocus input-sm">
-				<?php
-					print_category_option_list( $f_category_id );
-				?>
+				<?php print_category_option_list( $f_category_id, null, false ) ?>
 			</select>
 		</td>
 	</tr>
 <?php }
 
 	if( $t_show_reproducibility ) {
 ?>
 
 	<tr>
 		<th class="category">
+			<?php echo config_get( 'allow_no_reproducibility' ) ? '' : '<span class="required">*</span>' ?>
+
 			<label for="reproducibility"><?php print_documentation_link( 'reproducibility' ) ?></label>
 		</th>
 		<td>
 			<select <?php echo helper_get_tab_index() ?> id="reproducibility" name="reproducibility" class="input-sm">
 				<?php print_enum_string_option_list( 'reproducibility', $f_reproducibility ) ?>
@@ -315,25 +334,27 @@
 
 	if( $t_show_severity ) {
 ?>
 	<tr>
 		<th class="category">
+			<?php echo config_get( 'allow_no_severity' ) ? '' : '<span class="required">*</span>'?>
 			<label for="severity"><?php print_documentation_link( 'severity' ) ?></label>
 		</th>
 		<td>
 			<select <?php echo helper_get_tab_index() ?> id="severity" name="severity" class="input-sm">
-				<?php print_enum_string_option_list( 'severity', $f_severity ) ?>
+				<?php print_enum_string_option_list( 'severity', $f_severity, true) ?>
 			</select>
 		</td>
 	</tr>
 <?php
 	}
 
 	if( $t_show_priority ) {
 ?>
 	<tr>
 		<th class="category">
+			<?php echo config_get( 'allow_no_priority' ) ? '' : '<span class="required">*</span>' ?>
 			<label for="priority"><?php print_documentation_link( 'priority' ) ?></label>
 		</th>
 		<td>
 			<select <?php echo helper_get_tab_index() ?> id="priority" name="priority" class="input-sm">
 				<?php print_enum_string_option_list( 'priority', $f_priority ) ?>
diff -rNU5 mantisbt/bug_report.php mantisbt-2.0.0/bug_report.php
--- mantisbt/bug_report.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_report.php	2017-02-03 11:19:26.000000000 +0100
@@ -18,10 +18,11 @@
  * This page stores the reported bug
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -72,10 +73,11 @@
 require_api( 'profile_api.php' );
 require_api( 'relationship_api.php' );
 require_api( 'string_api.php' );
 require_api( 'user_api.php' );
 require_api( 'utility_api.php' );
+require_api( 'risk_criteria_api.php' );
 
 form_security_validate( 'bug_report' );
 
 $t_project_id = null;
 
@@ -112,10 +114,11 @@
 $t_bug_data->os                     = gpc_get_string( 'os', '' );
 $t_bug_data->os_build               = gpc_get_string( 'os_build', '' );
 $t_bug_data->version                = gpc_get_string( 'product_version', '' );
 $t_bug_data->profile_id             = gpc_get_int( 'profile_id', 0 );
 $t_bug_data->handler_id             = gpc_get_int( 'handler_id', 0 );
+$t_bug_data->responsable_id			= gpc_get_int( 'responsable_id', 0 );
 $t_bug_data->view_state             = gpc_get_int( 'view_state', config_get( 'default_bug_view_status' ) );
 $t_bug_data->category_id            = gpc_get_int( 'category_id', 0 );
 $t_bug_data->reproducibility        = gpc_get_int( 'reproducibility', config_get( 'default_bug_reproducibility' ) );
 $t_bug_data->severity               = gpc_get_int( 'severity', config_get( 'default_bug_severity' ) );
 $t_bug_data->priority               = gpc_get_int( 'priority', config_get( 'default_bug_priority' ) );
@@ -126,14 +129,20 @@
 $t_bug_data->summary                = gpc_get_string( 'summary' );
 $t_bug_data->description            = gpc_get_string( 'description' );
 $t_bug_data->steps_to_reproduce     = gpc_get_string( 'steps_to_reproduce', config_get( 'default_bug_steps_to_reproduce' ) );
 $t_bug_data->additional_information = gpc_get_string( 'additional_info', config_get( 'default_bug_additional_info' ) );
 $t_bug_data->due_date               = gpc_get_string( 'due_date', date_strtotime( config_get( 'due_date_default' ) ) );
+
 if( is_blank( $t_bug_data->due_date ) ) {
 	$t_bug_data->due_date = date_get_null();
 }
 
+$f_link_id = gpc_get_int( 'link_id', 0 );
+if ( $f_link_id > 0 ) {
+	$t_bug_data->status	= get_enum_id('status', 'progress');
+}
+
 $f_rel_type                         = gpc_get_int( 'rel_type', BUG_REL_NONE );
 $f_files                            = gpc_get_file( 'ufile', null );
 $f_report_stay                      = gpc_get_bool( 'report_stay', false );
 $f_copy_notes_from_parent           = gpc_get_bool( 'copy_notes_from_parent', false );
 $f_copy_attachments_from_parent     = gpc_get_bool( 'copy_attachments_from_parent', false );
@@ -195,13 +204,21 @@
 if( $t_bug_data->handler_id == NO_USER && $t_bug_data->status >= config_get( 'bug_resolved_status_threshold' ) ) {
 	$t_bug_data->handler_id = auth_get_current_user_id();
 }
 
 # Create the bug
-$t_bug_id = $t_bug_data->create();
+$t_bug_id = $t_bug_data->create(false);
 $t_bug_data->process_mentions();
 
+# Create a risk criteria if report is a risk and gravity > 8
+
+if ( project_get_other_type_project_id('risk') == helper_get_current_project() &&
+	($t_bug_data->severity * $t_bug_data->reproducibility / 100 > 8 )) {
+		$risk_criteria = bug_to_risk_criteria_object($t_bug_data);
+		$risk_criteria->create();
+}
+
 # Mark the added issue as visited so that it appears on the last visited list.
 last_visited_issue( $t_bug_id );
 
 # Handle the file upload
 if( $f_files !== null ) {
@@ -280,10 +297,15 @@
 	if( $f_copy_attachments_from_parent ) {
 		file_copy_attachments( $f_master_bug_id, $t_bug_id );
 	}
 }
 
+# Add relationship between 2 bugs
+if ( $f_link_id > 0 ) {
+	relationship_add( $t_bug_id, $f_link_id, 1 );
+}
+
 helper_call_custom_function( 'issue_create_notify', array( $t_bug_id ) );
 
 # Allow plugins to post-process bug data with the new bug ID
 event_signal( 'EVENT_REPORT_BUG', array( $t_bug_data, $t_bug_id ) );
 
diff -rNU5 mantisbt/bug_update_page.php mantisbt-2.0.0/bug_update_page.php
--- mantisbt/bug_update_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_update_page.php	2017-02-03 11:18:58.000000000 +0100
@@ -18,10 +18,11 @@
  * Display advanced Bug update page
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -724,27 +725,28 @@
 echo '<tr>';
 echo '<th class="category"><label for="bugnote_text">' . lang_get( 'add_bugnote_title' ) . '</label></th>';
 echo '<td colspan="5"><textarea class="form-control" ', helper_get_tab_index(), ' id="bugnote_text" name="bugnote_text" cols="80" rows="10"></textarea></td></tr>';
 
 # Bugnote Private Checkbox (if permitted)
-if( access_has_bug_level( config_get( 'private_bugnote_threshold' ), $t_bug_id ) ) {
-	echo '<tr>';
-	echo '<th class="category">' . lang_get( 'private' ) . '</th>';
-	echo '<td colspan="5">';
-
-	$t_default_bugnote_view_status = config_get( 'default_bugnote_view_status' );
-	if( access_has_bug_level( config_get( 'set_view_status_threshold' ), $t_bug_id ) ) {
-		echo '<label>';
-		echo '<input ', helper_get_tab_index(), ' type="checkbox" class="ace" id="private" name="private" ', check_checked( config_get( 'default_bugnote_view_status' ), VS_PRIVATE ), ' />';
-		echo '<span class="lbl"></span>';
-		echo '</label>';
-	} else {
-		echo get_enum_element( 'view_state', $t_default_bugnote_view_status );
-	}
-
-	echo '</td></tr>';
-}
+# This information is duplicated in the update page and this one not functional
+//if( access_has_bug_level( config_get( 'private_bugnote_threshold' ), $t_bug_id ) ) {
+//	echo '<tr>';
+//	echo '<th class="category">' . lang_get( 'private' ) . '</th>';
+//	echo '<td colspan="5">';
+//
+//	$t_default_bugnote_view_status = config_get( 'default_bugnote_view_status' );
+//	if( access_has_bug_level( config_get( 'set_view_status_threshold' ), $t_bug_id ) ) {
+//		echo '<label>';
+//		echo '<input ', helper_get_tab_index(), ' type="checkbox" class="ace" id="private" name="private" ', check_checked( config_get( 'default_bugnote_view_status' ), VS_PRIVATE ), ' />';
+//		echo '<span class="lbl"></span>';
+//		echo '</label>';
+//	} else {
+//		echo get_enum_element( 'view_state', $t_default_bugnote_view_status );
+//	}
+//
+//	echo '</td></tr>';
+//}
 
 # Time Tracking (if permitted)
 if( config_get( 'time_tracking_enabled' ) ) {
 	if( access_has_bug_level( config_get( 'time_tracking_edit_threshold' ), $t_bug_id ) ) {
 		echo '<tr>';
diff -rNU5 mantisbt/bug_update.php mantisbt-2.0.0/bug_update.php
--- mantisbt/bug_update.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_update.php	2017-02-23 14:39:19.000000000 +0100
@@ -18,10 +18,11 @@
  * Update bug data then redirect to the appropriate viewing page
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -58,17 +59,19 @@
 require_api( 'helper_api.php' );
 require_api( 'history_api.php' );
 require_api( 'lang_api.php' );
 require_api( 'print_api.php' );
 require_api( 'relationship_api.php' );
+require_api( 'risk_criteria_api.php' );
 
 form_security_validate( 'bug_update' );
 
 $f_bug_id = gpc_get_int( 'bug_id' );
 $t_existing_bug = bug_get( $f_bug_id, true );
 $f_update_type = gpc_get_string( 'action_type', BUG_UPDATE_TYPE_NORMAL );
 
+
 $t_current_user_id = auth_get_current_user_id();
 
 if( helper_get_current_project() != $t_existing_bug->project_id ) {
 	$g_project_override = $t_existing_bug->project_id;
 }
@@ -77,10 +80,11 @@
 
 $t_updated_bug->additional_information = gpc_get_string( 'additional_information', $t_existing_bug->additional_information );
 $t_updated_bug->build = gpc_get_string( 'build', $t_existing_bug->build );
 $t_updated_bug->category_id = gpc_get_int( 'category_id', $t_existing_bug->category_id );
 $t_updated_bug->description = gpc_get_string( 'description', $t_existing_bug->description );
+
 $t_due_date = gpc_get_string( 'due_date', null );
 if( $t_due_date !== null ) {
 	if( is_blank( $t_due_date ) ) {
 		$t_updated_bug->due_date = 1;
 	} else {
@@ -370,13 +374,37 @@
 	} else {
 		$t_updated_bug->status = config_get( 'bug_submit_status' );
 	}
 }
 
-# Handle automatic assignment of issues.
-$t_updated_bug->status = bug_get_status_for_assign( $t_existing_bug->handler_id, $t_updated_bug->handler_id, $t_existing_bug->status, $t_updated_bug->status );
+# Manage risk criteria
+if ( project_get_other_type_project_id('risk') == helper_get_current_project()) {
+    
+	$risk_criteria_id = risk_criteria_get_id_by_name($t_existing_bug->summary);
+	$gravity = $t_updated_bug->severity * $t_updated_bug->reproducibility / 100 ;
+			
+	if ( 0 != $risk_criteria_id ) {
+		$risk_criteria = risk_criteria_get($risk_criteria_id);
+		if ( $gravity > 8  ) {
+			$risk_criteria->label = $t_updated_bug->summary;
+			$risk_criteria->update();
+		}
+		else {
+			$risk_criteria->delete();
+		}
+	}
+	elseif ( $gravity > 8 ) {
+		$risk_criteria = bug_to_risk_criteria_object($t_updated_bug);
+		$risk_criteria->create();
+	}
+}
 
+# Handle automatic assignment of issues.
+#never read because of management mantis
+if ( false ) {
+	$t_updated_bug->status = bug_get_status_for_assign( $t_existing_bug->handler_id, $t_updated_bug->handler_id, $t_existing_bug->status, $t_updated_bug->status );
+}
 # Allow a custom function to validate the proposed bug updates. Note that
 # custom functions are being deprecated in MantisBT. You should migrate to
 # the new plugin system instead.
 helper_call_custom_function( 'issue_update_validate', array( $f_bug_id, $t_updated_bug, $t_bug_note->note ) );
 
diff -rNU5 mantisbt/bug_view_inc.php mantisbt-2.0.0/bug_view_inc.php
--- mantisbt/bug_view_inc.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/bug_view_inc.php	2017-02-03 11:18:26.000000000 +0100
@@ -19,10 +19,11 @@
  * $f_bug_id MUST be specified before the file is included
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses bug_api.php
@@ -80,706 +81,736 @@
 
 require_css( 'status_config.php' );
 
 $f_bug_id = gpc_get_int( 'id' );
 
-bug_ensure_exists( $f_bug_id );
 
-$t_bug = bug_get( $f_bug_id, true );
+if ( 0 == $f_bug_id ) {
+	if( $t_show_page_header ) {	
+		layout_page_header( lang_get( 'main_link' ) );
+		layout_page_begin( 'view_all_bug_page.php' );
+	}
+	echo '<br /><div align="center">';
+	echo lang_get('no_bug_message');
+	echo '<div>';
+}
+else {
+	bug_ensure_exists( $f_bug_id );
+	$t_bug = bug_get( $f_bug_id, true );
 
-# In case the current project is not the same project of the bug we are
-# viewing, override the current project. This ensures all config_get and other
-# per-project function calls use the project ID of this bug.
-$g_project_override = $t_bug->project_id;
+	# In case the current project is not the same project of the bug we are
+	# viewing, override the current project. This ensures all config_get and other
+	# per-project function calls use the project ID of this bug.
+	$g_project_override = $t_bug->project_id;
+	
+	if ( helper_get_current_project() != $t_bug->project_id ) {
+			helper_set_current_project($t_bug->project_id);
+			$g_project_override = $t_bug->project_id;
+			print_header_redirect( 'view.php?id='.$t_bug->id );
+	}
 
-access_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_bug_id );
+	access_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_bug_id );
 
-$f_history = gpc_get_bool( 'history', config_get( 'history_default_visible' ) );
+	$f_history = gpc_get_bool( 'history', config_get( 'history_default_visible' ) );
 
-$t_fields = config_get( $t_fields_config_option );
-$t_fields = columns_filter_disabled( $t_fields );
+	$t_fields = config_get( $t_fields_config_option );
+	$t_fields = columns_filter_disabled( $t_fields );
 
-compress_enable();
+	compress_enable();
 
-if( $t_show_page_header ) {
-	layout_page_header( bug_format_summary( $f_bug_id, SUMMARY_CAPTION ), null, 'view-issue-page' );
-	layout_page_begin( 'view_all_bug_page.php' );
-}
+	
+	if( $t_show_page_header ) {
+		layout_page_header( bug_format_summary( $f_bug_id, SUMMARY_CAPTION ), null, 'view-issue-page' );
+		layout_page_begin( 'view_all_bug_page.php' );
+	}
+	
 
-$t_action_button_position = config_get( 'action_button_position' );
+	$t_action_button_position = config_get( 'action_button_position' );
 
-$t_bugslist = gpc_get_cookie( config_get( 'bug_list_cookie' ), false );
+	$t_bugslist = gpc_get_cookie( config_get( 'bug_list_cookie' ), false );
 
-$t_show_versions = version_should_show_product_version( $t_bug->project_id );
-$t_show_product_version = $t_show_versions && in_array( 'product_version', $t_fields );
-$t_show_fixed_in_version = $t_show_versions && in_array( 'fixed_in_version', $t_fields );
-$t_show_product_build = $t_show_versions && in_array( 'product_build', $t_fields )
-	&& ( config_get( 'enable_product_build' ) == ON );
-$t_product_build = $t_show_product_build ? string_display_line( $t_bug->build ) : '';
-$t_show_target_version = $t_show_versions && in_array( 'target_version', $t_fields )
-	&& access_has_bug_level( config_get( 'roadmap_view_threshold' ), $f_bug_id );
+	$t_show_versions = version_should_show_product_version( $t_bug->project_id );
+	$t_show_product_version = $t_show_versions && in_array( 'product_version', $t_fields );
+	$t_show_fixed_in_version = $t_show_versions && in_array( 'fixed_in_version', $t_fields );
+	$t_show_product_build = $t_show_versions && in_array( 'product_build', $t_fields )
+		&& ( config_get( 'enable_product_build' ) == ON );
+	$t_product_build = $t_show_product_build ? string_display_line( $t_bug->build ) : '';
+	$t_show_target_version = $t_show_versions && in_array( 'target_version', $t_fields )
+		&& access_has_bug_level( config_get( 'roadmap_view_threshold' ), $f_bug_id );
 
-$t_product_version_string  = '';
-$t_target_version_string   = '';
-$t_fixed_in_version_string = '';
+	$t_product_version_string  = '';
+	$t_target_version_string   = '';
+	$t_fixed_in_version_string = '';
 
-if( $t_show_product_version || $t_show_fixed_in_version || $t_show_target_version ) {
-	$t_version_rows = version_get_all_rows( $t_bug->project_id );
+	if( $t_show_product_version || $t_show_fixed_in_version || $t_show_target_version ) {
+		$t_version_rows = version_get_all_rows( $t_bug->project_id );
 
-	if( $t_show_product_version ) {
-		$t_product_version_string  = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->version, $t_bug->project_id ) );
-	}
+		if( $t_show_product_version ) {
+			$t_product_version_string  = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->version, $t_bug->project_id ) );
+		}
 
-	if( $t_show_target_version ) {
-		$t_target_version_string   = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->target_version, $t_bug->project_id ) );
-	}
+		if( $t_show_target_version ) {
+			$t_target_version_string   = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->target_version, $t_bug->project_id ) );
+		}
 
-	if( $t_show_fixed_in_version ) {
-		$t_fixed_in_version_string = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->fixed_in_version, $t_bug->project_id ) );
+		if( $t_show_fixed_in_version ) {
+			$t_fixed_in_version_string = prepare_version_string( $t_bug->project_id, version_get_id( $t_bug->fixed_in_version, $t_bug->project_id ) );
+		}
 	}
-}
 
-$t_product_version_string = string_display_line( $t_product_version_string );
-$t_target_version_string = string_display_line( $t_target_version_string );
-$t_fixed_in_version_string = string_display_line( $t_fixed_in_version_string );
-
-$t_bug_id = $f_bug_id;
-$t_form_title = lang_get( 'bug_view_title' );
-$t_wiki_link = config_get_global( 'wiki_enable' ) == ON ? 'wiki.php?id=' . $f_bug_id : '';
-
-if( access_has_bug_level( config_get( 'view_history_threshold' ), $f_bug_id ) ) {
-	$t_history_link = 'view.php?id=' . $f_bug_id . '&history=1#history';
-} else {
-	$t_history_link = '';
-}
+	$t_product_version_string = string_display_line( $t_product_version_string );
+	$t_target_version_string = string_display_line( $t_target_version_string );
+	$t_fixed_in_version_string = string_display_line( $t_fixed_in_version_string );
 
-$t_show_reminder_link = !current_user_is_anonymous() && !bug_is_readonly( $f_bug_id ) &&
-	  access_has_bug_level( config_get( 'bug_reminder_threshold' ), $f_bug_id );
-$t_bug_reminder_link = 'bug_reminder_page.php?bug_id=' . $f_bug_id;
+	$t_bug_id = $f_bug_id;
+	$t_form_title = lang_get( 'bug_view_title' );
+	$t_wiki_link = config_get_global( 'wiki_enable' ) == ON ? 'wiki.php?id=' . $f_bug_id : '';
 
-$t_top_buttons_enabled = !$t_force_readonly && ( $t_action_button_position == POSITION_TOP || $t_action_button_position == POSITION_BOTH );
-$t_bottom_buttons_enabled = !$t_force_readonly && ( $t_action_button_position == POSITION_BOTTOM || $t_action_button_position == POSITION_BOTH );
+	if( access_has_bug_level( config_get( 'view_history_threshold' ), $f_bug_id ) ) {
+		$t_history_link = 'view.php?id=' . $f_bug_id . '&history=1#history';
+	} else {
+		$t_history_link = '';
+	}
 
-$t_show_project = in_array( 'project', $t_fields );
-$t_project_name = $t_show_project ? string_display_line( project_get_name( $t_bug->project_id ) ): '';
-$t_show_id = in_array( 'id', $t_fields );
-$t_formatted_bug_id = $t_show_id ? string_display_line( bug_format_id( $f_bug_id ) ) : '';
+	$t_show_reminder_link = !current_user_is_anonymous() && !bug_is_readonly( $f_bug_id ) &&
+		  access_has_bug_level( config_get( 'bug_reminder_threshold' ), $f_bug_id );
+	$t_bug_reminder_link = 'bug_reminder_page.php?bug_id=' . $f_bug_id;
 
-$t_show_date_submitted = in_array( 'date_submitted', $t_fields );
-$t_date_submitted = $t_show_date_submitted ? date( config_get( 'normal_date_format' ), $t_bug->date_submitted ) : '';
+	$t_top_buttons_enabled = !$t_force_readonly && ( $t_action_button_position == POSITION_TOP || $t_action_button_position == POSITION_BOTH );
+	$t_bottom_buttons_enabled = !$t_force_readonly && ( $t_action_button_position == POSITION_BOTTOM || $t_action_button_position == POSITION_BOTH );
 
-$t_show_last_updated = in_array( 'last_updated', $t_fields );
-$t_last_updated = $t_show_last_updated ? date( config_get( 'normal_date_format' ), $t_bug->last_updated ) : '';
+	$t_show_project = in_array( 'project', $t_fields );
+	$t_project_name = $t_show_project ? string_display_line( project_get_name( $t_bug->project_id ) ): '';
+	$t_show_id = in_array( 'id', $t_fields );
+	$t_formatted_bug_id = $t_show_id ? string_display_line( bug_format_id( $f_bug_id ) ) : '';
 
-$t_show_tags = in_array( 'tags', $t_fields ) && access_has_global_level( config_get( 'tag_view_threshold' ) );
+	$t_show_date_submitted = in_array( 'date_submitted', $t_fields );
+	$t_date_submitted = $t_show_date_submitted ? date( config_get( 'normal_date_format' ), $t_bug->date_submitted ) : '';
 
-$t_bug_overdue = bug_is_overdue( $f_bug_id );
+	$t_show_last_updated = in_array( 'last_updated', $t_fields );
+	$t_last_updated = $t_show_last_updated ? date( config_get( 'normal_date_format' ), $t_bug->last_updated ) : '';
 
-$t_show_view_state = in_array( 'view_state', $t_fields );
-$t_bug_view_state_enum = $t_show_view_state ? string_display_line( get_enum_element( 'view_state', $t_bug->view_state ) ) : '';
+	$t_show_tags = in_array( 'tags', $t_fields ) && access_has_global_level( config_get( 'tag_view_threshold' ) );
 
-$t_show_due_date = in_array( 'due_date', $t_fields ) && access_has_bug_level( config_get( 'due_date_view_threshold' ), $f_bug_id );
+	$t_bug_overdue = bug_is_overdue( $f_bug_id );
 
-if( $t_show_due_date ) {
-	if( !date_is_null( $t_bug->due_date ) ) {
-		$t_bug_due_date = date( config_get( 'normal_date_format' ), $t_bug->due_date );
-	} else {
-		$t_bug_due_date = '';
-	}
-}
+	$t_show_view_state = in_array( 'view_state', $t_fields );
+	$t_bug_view_state_enum = $t_show_view_state ? string_display_line( get_enum_element( 'view_state', $t_bug->view_state ) ) : '';
 
-$t_show_reporter = in_array( 'reporter', $t_fields );
-$t_show_handler = in_array( 'handler', $t_fields ) && access_has_bug_level( config_get( 'view_handler_threshold' ), $f_bug_id );
-$t_show_additional_information = !is_blank( $t_bug->additional_information ) && in_array( 'additional_info', $t_fields );
-$t_show_steps_to_reproduce = !is_blank( $t_bug->steps_to_reproduce ) && in_array( 'steps_to_reproduce', $t_fields );
-$t_show_monitor_box = !$t_force_readonly;
-$t_show_relationships_box = !$t_force_readonly;
-$t_show_sponsorships_box = config_get( 'enable_sponsorship' ) && access_has_bug_level( config_get( 'view_sponsorship_total_threshold' ), $f_bug_id );
-$t_show_history = $f_history;
-$t_show_profiles = config_get( 'enable_profiles' );
-$t_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );
-$t_platform = $t_show_platform ? string_display_line( $t_bug->platform ) : '';
-$t_show_os = $t_show_profiles && in_array( 'os', $t_fields );
-$t_os = $t_show_os ? string_display_line( $t_bug->os ) : '';
-$t_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );
-$t_os_version = $t_show_os_version ? string_display_line( $t_bug->os_build ) : '';
-$t_show_projection = in_array( 'projection', $t_fields );
-$t_projection = $t_show_projection ? string_display_line( get_enum_element( 'projection', $t_bug->projection ) ) : '';
-$t_show_eta = in_array( 'eta', $t_fields );
-$t_eta = $t_show_eta ? string_display_line( get_enum_element( 'eta', $t_bug->eta ) ) : '';
-$t_can_attach_tag = $t_show_tags && !$t_force_readonly && access_has_bug_level( config_get( 'tag_attach_threshold' ), $f_bug_id );
-$t_show_category = in_array( 'category_id', $t_fields );
-$t_category = $t_show_category ? string_display_line( category_full_name( $t_bug->category_id ) ) : '';
-$t_show_priority = in_array( 'priority', $t_fields );
-$t_priority = $t_show_priority ? string_display_line( get_enum_element( 'priority', $t_bug->priority ) ) : '';
-$t_show_severity = in_array( 'severity', $t_fields );
-$t_severity = $t_show_severity ? string_display_line( get_enum_element( 'severity', $t_bug->severity ) ) : '';
-$t_show_reproducibility = in_array( 'reproducibility', $t_fields );
-$t_reproducibility = $t_show_reproducibility ? string_display_line( get_enum_element( 'reproducibility', $t_bug->reproducibility ) ): '';
-$t_show_status = in_array( 'status', $t_fields );
-$t_status = $t_show_status ? string_display_line( get_enum_element( 'status', $t_bug->status ) ) : '';
-$t_show_resolution = in_array( 'resolution', $t_fields );
-$t_resolution = $t_show_resolution ? string_display_line( get_enum_element( 'resolution', $t_bug->resolution ) ) : '';
-$t_show_summary = in_array( 'summary', $t_fields );
-$t_show_description = in_array( 'description', $t_fields );
-
-$t_summary = $t_show_summary ? bug_format_summary( $f_bug_id, SUMMARY_FIELD ) : '';
-$t_description = $t_show_description ? string_display_links( $t_bug->description ) : '';
-$t_steps_to_reproduce = $t_show_steps_to_reproduce ? string_display_links( $t_bug->steps_to_reproduce ) : '';
-$t_additional_information = $t_show_additional_information ? string_display_links( $t_bug->additional_information ) : '';
-
-$t_links = event_signal( 'EVENT_MENU_ISSUE', $f_bug_id );
-
-#
-# Start of Template
-#
-
-echo '<div class="col-md-12 col-xs-12">';
-echo '<div class="widget-box widget-color-blue2">';
-echo '<div class="widget-header widget-header-small">';
-echo '<h4 class="widget-title lighter">';
-echo '<i class="ace-icon fa fa-bars"></i>';
-echo $t_form_title;
-echo '</h4>';
-echo '</div>';
-
-echo '<div class="widget-body">';
-
-echo '<div class="widget-toolbox padding-8 clearfix noprint">';
-echo '<div class="btn-group pull-left">';
-
-# Jump to Bugnotes
-print_small_button( '#bugnotes', lang_get( 'jump_to_bugnotes' ) );
-
-# Send Bug Reminder
-if( $t_show_reminder_link ) {
-	print_small_button( $t_bug_reminder_link, lang_get( 'bug_reminder' ) );
-}
+	$t_show_due_date = in_array( 'due_date', $t_fields ) && access_has_bug_level( config_get( 'due_date_view_threshold' ), $f_bug_id );
 
-if( !is_blank( $t_wiki_link ) ) {
-	print_small_button( $t_wiki_link, lang_get( 'wiki' ) );
-}
+	if( $t_show_due_date ) {
+		if( !date_is_null( $t_bug->due_date ) ) {
+			$t_bug_due_date = date( config_get( 'normal_date_format' ), $t_bug->due_date );
+		} else {
+			$t_bug_due_date = '';
+		}
+	}
 
-foreach ( $t_links as $t_plugin => $t_hooks ) {
-	foreach( $t_hooks as $t_hook ) {
-		if( is_array( $t_hook ) ) {
-			foreach( $t_hook as $t_label => $t_href ) {
-				if( is_numeric( $t_label ) ) {
-					print_bracket_link_prepared( $t_href );
-				} else {
-					print_small_button( $t_href, $t_label );
+	$t_show_reporter = in_array( 'reporter', $t_fields );
+	$t_show_handler = in_array( 'handler', $t_fields ) && access_has_bug_level( config_get( 'view_handler_threshold' ), $f_bug_id );
+	$t_show_additional_information = !is_blank( $t_bug->additional_information ) && in_array( 'additional_info', $t_fields );
+	$t_show_steps_to_reproduce = !is_blank( $t_bug->steps_to_reproduce ) && in_array( 'steps_to_reproduce', $t_fields );
+	$t_show_monitor_box = !$t_force_readonly;
+	$t_show_relationships_box = !$t_force_readonly;
+	$t_show_sponsorships_box = config_get( 'enable_sponsorship' ) && access_has_bug_level( config_get( 'view_sponsorship_total_threshold' ), $f_bug_id );
+	$t_show_history = $f_history;
+	$t_show_profiles = config_get( 'enable_profiles' );
+	$t_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );
+	$t_platform = $t_show_platform ? string_display_line( $t_bug->platform ) : '';
+	$t_show_os = $t_show_profiles && in_array( 'os', $t_fields );
+	$t_os = $t_show_os ? string_display_line( $t_bug->os ) : '';
+	$t_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );
+	$t_os_version = $t_show_os_version ? string_display_line( $t_bug->os_build ) : '';
+	$t_show_projection = in_array( 'projection', $t_fields );
+	$t_projection = $t_show_projection ? string_display_line( get_enum_element( 'projection', $t_bug->projection ) ) : '';
+	$t_show_eta = in_array( 'eta', $t_fields );
+	$t_eta = $t_show_eta ? string_display_line( get_enum_element( 'eta', $t_bug->eta ) ) : '';
+	$t_can_attach_tag = $t_show_tags && !$t_force_readonly && access_has_bug_level( config_get( 'tag_attach_threshold' ), $f_bug_id );
+	$t_show_category = in_array( 'category_id', $t_fields );
+	$t_category = $t_show_category ? string_display_line( category_full_name( $t_bug->category_id ) ) : '';
+	$t_show_priority = in_array( 'priority', $t_fields );
+	$t_priority = $t_show_priority ? string_display_line( get_enum_element( 'priority', $t_bug->priority ) ) : '';
+	$t_show_severity = in_array( 'severity', $t_fields );
+	$t_severity = $t_show_severity ? string_display_line( get_enum_element( 'severity', $t_bug->severity ) ) : '';
+	$t_show_reproducibility = in_array( 'reproducibility', $t_fields );
+	$t_reproducibility = $t_show_reproducibility ? string_display_line( get_enum_element( 'reproducibility', $t_bug->reproducibility ) ): '';
+	$t_show_status = in_array( 'status', $t_fields );
+	$t_status = $t_show_status ? string_display_line( get_enum_element( 'status', $t_bug->status ) ) : '';
+	$t_show_resolution = in_array( 'resolution', $t_fields );
+	$t_resolution = $t_show_resolution ? string_display_line( get_enum_element( 'resolution', $t_bug->resolution ) ) : '';
+	$t_show_gravity = in_array( 'gravity', $t_fields );
+	$t_gravity = $t_bug->severity * $t_bug->reproducibility / 100;
+	$t_show_summary = in_array( 'summary', $t_fields );
+	$t_show_description = in_array( 'description', $t_fields );
+
+	$t_summary = $t_show_summary ? bug_format_summary( $f_bug_id, SUMMARY_FIELD ) : '';
+	$t_description = $t_show_description ? string_display_links( $t_bug->description ) : '';
+	$t_steps_to_reproduce = $t_show_steps_to_reproduce ? string_display_links( $t_bug->steps_to_reproduce ) : '';
+	$t_additional_information = $t_show_additional_information ? string_display_links( $t_bug->additional_information ) : '';
+
+	$t_links = event_signal( 'EVENT_MENU_ISSUE', $f_bug_id );
+
+	#
+	# Start of Template
+	#
+
+	echo '<div class="col-md-12 col-xs-12">';
+	echo '<div class="widget-box widget-color-blue2">';
+	echo '<div class="widget-header widget-header-small">';
+	echo '<h4 class="widget-title lighter">';
+	echo '<i class="ace-icon fa fa-bars"></i>';
+	echo $t_form_title;
+	echo '</h4>';
+	echo '</div>';
+
+	echo '<div class="widget-body">';
+
+	echo '<div class="widget-toolbox padding-8 clearfix noprint">';
+	echo '<div class="btn-group pull-left">';
+
+	# Jump to Bugnotes
+	print_small_button( '#bugnotes', lang_get( 'jump_to_bugnotes' ) );
+
+	# Send Bug Reminder
+	if( $t_show_reminder_link ) {
+		print_small_button( $t_bug_reminder_link, lang_get( 'bug_reminder' ) );
+	}
+
+	if( !is_blank( $t_wiki_link ) ) {
+		print_small_button( $t_wiki_link, lang_get( 'wiki' ) );
+	}
+
+	foreach ( $t_links as $t_plugin => $t_hooks ) {
+		foreach( $t_hooks as $t_hook ) {
+			if( is_array( $t_hook ) ) {
+				foreach( $t_hook as $t_label => $t_href ) {
+					if( is_numeric( $t_label ) ) {
+						print_bracket_link_prepared( $t_href );
+					} else {
+						print_small_button( $t_href, $t_label );
+					}
 				}
+			} elseif( !empty( $t_hook ) ) {
+				print_bracket_link_prepared( $t_hook );
 			}
-		} elseif( !empty( $t_hook ) ) {
-			print_bracket_link_prepared( $t_hook );
 		}
 	}
-}
-
-# Links
-if( !is_blank( $t_history_link ) ) {
-	# History
-	print_small_button( $t_history_link, lang_get( 'bug_history' ) );
-}
 
-echo '</div>';
+	# Links
+	if( !is_blank( $t_history_link ) ) {
+		# History
+		print_small_button( $t_history_link, lang_get( 'bug_history' ) );
+	}
+
+	echo '</div>';
+
+	# prev/next links
+	echo '<div class="btn-group pull-right">';
+	if( $t_bugslist ) {
+		$t_bugslist = explode( ',', $t_bugslist );
+		$t_index = array_search( $f_bug_id, $t_bugslist );
+		if( false !== $t_index ) {
+			if( isset( $t_bugslist[$t_index-1] ) ) {
+				print_small_button( 'view.php?id='.$t_bugslist[$t_index-1], '&lt;&lt;' );
+			}
 
-# prev/next links
-echo '<div class="btn-group pull-right">';
-if( $t_bugslist ) {
-	$t_bugslist = explode( ',', $t_bugslist );
-	$t_index = array_search( $f_bug_id, $t_bugslist );
-	if( false !== $t_index ) {
-		if( isset( $t_bugslist[$t_index-1] ) ) {
-			print_small_button( 'view.php?id='.$t_bugslist[$t_index-1], '&lt;&lt;' );
+			if( isset( $t_bugslist[$t_index+1] ) ) {
+				print_small_button( 'view.php?id='.$t_bugslist[$t_index+1], '&gt;&gt;' );
+			}
 		}
+	}
+	echo '</div>';
+	echo '</div>';
 
-		if( isset( $t_bugslist[$t_index+1] ) ) {
-			print_small_button( 'view.php?id='.$t_bugslist[$t_index+1], '&gt;&gt;' );
-		}
+	echo '<div class="widget-main no-padding">';
+	echo '<div class="table-responsive">';
+	echo '<table class="table table-bordered table-condensed">';
+
+	if( $t_top_buttons_enabled ) {
+		echo '<thead><tr class="bug-nav">';
+		echo '<tr class="top-buttons noprint">';
+		echo '<td colspan="6">';
+		html_buttons_view_bug_page( $t_bug_id );
+		echo '</td>';
+		echo '</tr>';
+		echo '</thead>';
 	}
-}
-echo '</div>';
-echo '</div>';
 
-echo '<div class="widget-main no-padding">';
-echo '<div class="table-responsive">';
-echo '<table class="table table-bordered table-condensed">';
-
-if( $t_top_buttons_enabled ) {
-	echo '<thead><tr class="bug-nav">';
-	echo '<tr class="top-buttons noprint">';
-	echo '<td colspan="6">';
-	html_buttons_view_bug_page( $t_bug_id );
-	echo '</td>';
-	echo '</tr>';
-	echo '</thead>';
-}
+	if( $t_bottom_buttons_enabled ) {
+		echo '<tfoot>';
+		echo '<tr class="noprint"><td colspan="6">';
+		html_buttons_view_bug_page( $t_bug_id );
+		echo '</td></tr>';
+		echo '</tfoot>';
+	}
 
-if( $t_bottom_buttons_enabled ) {
-	echo '<tfoot>';
-	echo '<tr class="noprint"><td colspan="6">';
-	html_buttons_view_bug_page( $t_bug_id );
-	echo '</td></tr>';
-	echo '</tfoot>';
-}
+	echo '<tbody>';
 
-echo '<tbody>';
+	if( $t_show_id || $t_show_project || $t_show_category || $t_show_view_state || $t_show_date_submitted || $t_show_last_updated ) {
+		# Labels
+		echo '<tr class="bug-header">';
+		echo '<th class="bug-id category" width="15%">', $t_show_id ? lang_get( 'id' ) : '', '</th>';
+		echo '<th class="bug-project category" width="20%">', $t_show_project ? lang_get( 'email_project' ) : '', '</th>';
+		echo '<th class="bug-category category" width="15%">', $t_show_category ? lang_get( 'category' ) : '', '</th>';
+		echo '<th class="bug-view-status category" width="15%">', $t_show_view_state ? lang_get( 'view_status' ) : '', '</th>';
+		echo '<th class="bug-date-submitted category" width="15%">', $t_show_date_submitted ? lang_get( 'date_submitted' ) : '', '</th>';
+		echo '<th class="bug-last-modified category" width="20%">', $t_show_last_updated ? lang_get( 'last_update' ) : '','</th>';
+		echo '</tr>';
 
-if( $t_show_id || $t_show_project || $t_show_category || $t_show_view_state || $t_show_date_submitted || $t_show_last_updated ) {
-	# Labels
-	echo '<tr class="bug-header">';
-	echo '<th class="bug-id category" width="15%">', $t_show_id ? lang_get( 'id' ) : '', '</th>';
-	echo '<th class="bug-project category" width="20%">', $t_show_project ? lang_get( 'email_project' ) : '', '</th>';
-	echo '<th class="bug-category category" width="15%">', $t_show_category ? lang_get( 'category' ) : '', '</th>';
-	echo '<th class="bug-view-status category" width="15%">', $t_show_view_state ? lang_get( 'view_status' ) : '', '</th>';
-	echo '<th class="bug-date-submitted category" width="15%">', $t_show_date_submitted ? lang_get( 'date_submitted' ) : '', '</th>';
-	echo '<th class="bug-last-modified category" width="20%">', $t_show_last_updated ? lang_get( 'last_update' ) : '','</th>';
-	echo '</tr>';
+		echo '<tr class="bug-header-data">';
 
-	echo '<tr class="bug-header-data">';
+		# Bug ID
+		echo '<td class="bug-id">', $t_formatted_bug_id, '</td>';
 
-	# Bug ID
-	echo '<td class="bug-id">', $t_formatted_bug_id, '</td>';
+		# Project
+		echo '<td class="bug-project">', $t_project_name, '</td>';
 
-	# Project
-	echo '<td class="bug-project">', $t_project_name, '</td>';
+		# Category
+		echo '<td class="bug-category">', $t_category, '</td>';
 
-	# Category
-	echo '<td class="bug-category">', $t_category, '</td>';
+		# View Status
+		echo '<td class="bug-view-status">', $t_bug_view_state_enum, '</td>';
 
-	# View Status
-	echo '<td class="bug-view-status">', $t_bug_view_state_enum, '</td>';
+		# Date Submitted
+		echo '<td class="bug-date-submitted">', $t_date_submitted, '</td>';
 
-	# Date Submitted
-	echo '<td class="bug-date-submitted">', $t_date_submitted, '</td>';
+		# Date Updated
+		echo '<td class="bug-last-modified">', $t_last_updated, '</td>';
 
-	# Date Updated
-	echo '<td class="bug-last-modified">', $t_last_updated, '</td>';
+		echo '</tr>';
 
-	echo '</tr>';
+		# spacer
+		echo '<tr class="spacer"><td colspan="6"></td></tr>';
+		echo '<tr class="hidden"></tr>';
+	}
 
-	# spacer
-	echo '<tr class="spacer"><td colspan="6"></td></tr>';
-	echo '<tr class="hidden"></tr>';
-}
+	#
+	# Reporter
+	#
 
-#
-# Reporter
-#
+	if( $t_show_reporter ) {
+		echo '<tr>';
 
-if( $t_show_reporter ) {
-	echo '<tr>';
+		$t_spacer = 4;
 
-	$t_spacer = 4;
+		# Reporter
+		echo '<th class="bug-reporter category">', lang_get( 'reporter' ), '</th>';
+		echo '<td class="bug-reporter">';
+		print_user_with_subject( $t_bug->reporter_id, $t_bug_id );
+		echo '</td>';
+		echo '<td colspan="', $t_spacer, '">&#160;</td>';
 
-	# Reporter
-	echo '<th class="bug-reporter category">', lang_get( 'reporter' ), '</th>';
-	echo '<td class="bug-reporter">';
-	print_user_with_subject( $t_bug->reporter_id, $t_bug_id );
-	echo '</td>';
-	echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		echo '</tr>';
+	}
 
-	echo '</tr>';
-}
+	#
+	# Handler, Due Date
+	#
 
-#
-# Handler, Due Date
-#
-
-if( $t_show_handler || $t_show_due_date ) {
-	echo '<tr>';
-
-	$t_spacer = 2;
-
-	# Handler
-	if( $t_show_handler ) {
-		echo '<th class="bug-assigned-to category">', lang_get( 'assigned_to' ), '</th>';
-		echo '<td class="bug-assigned-to">';
-		print_user_with_subject( $t_bug->handler_id, $t_bug_id );
-		echo '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+	if( $t_show_handler || $t_show_due_date ) {
+		echo '<tr>';
 
-	# Due Date
-	if( $t_show_due_date ) {
-		echo '<th class="bug-due-date category">', lang_get( 'due_date' ), '</th>';
+		$t_spacer = 2;
 
-		if( $t_bug_overdue ) {
-			echo '<td class="bug-due-date overdue">', $t_bug_due_date, '</td>';
+		# Handler
+		if( $t_show_handler ) {
+			echo '<th class="bug-assigned-to category">', lang_get( 'assigned_to' ), '</th>';
+			echo '<td class="bug-assigned-to">';
+			print_user_with_subject( $t_bug->handler_id, $t_bug_id );
+			echo '</td>';
 		} else {
-			echo '<td class="bug-due-date">', $t_bug_due_date, '</td>';
+			$t_spacer += 2;
 		}
-	} else {
-		$t_spacer += 2;
-	}
 
-	echo '<td colspan="', $t_spacer, '">&#160;</td>';
-	echo '</tr>';
-}
+		# Due Date
+		if( $t_show_due_date ) {
+			echo '<th class="bug-due-date category">', lang_get( 'due_date' ), '</th>';
+
+			if( $t_bug_overdue ) {
+				echo '<td class="bug-due-date overdue">', $t_bug_due_date, '</td>';
+			} else {
+				echo '<td class="bug-due-date">', $t_bug_due_date, '</td>';
+			}
+		} else {
+			$t_spacer += 2;
+		}
 
-#
-# Priority, Severity, Reproducibility
-#
-
-if( $t_show_priority || $t_show_severity || $t_show_reproducibility ) {
-	echo '<tr>';
-
-	$t_spacer = 0;
-
-	# Priority
-	if( $t_show_priority ) {
-		echo '<th class="bug-priority category">', lang_get( 'priority' ), '</th>';
-		echo '<td class="bug-priority">', $t_priority, '</td>';
-	} else {
-		$t_spacer += 2;
+		echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		echo '</tr>';
 	}
 
-	# Severity
-	if( $t_show_severity ) {
-		echo '<th class="bug-severity category">', lang_get( 'severity' ), '</th>';
-		echo '<td class="bug-severity">', $t_severity, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+	#
+	# Priority, Severity, Reproducibility
+	#
 
-	# Reproducibility
-	if( $t_show_reproducibility ) {
-		echo '<th class="bug-reproducibility category">', lang_get( 'reproducibility' ), '</th>';
-		echo '<td class="bug-reproducibility">', $t_reproducibility, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+	if( $t_show_priority || $t_show_severity || $t_show_reproducibility ) {
+		echo '<tr>';
 
-	# spacer
-	if( $t_spacer > 0 ) {
-		echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		$t_spacer = 0;
+
+		# Priority
+		if( $t_show_priority ) {
+			echo '<th class="bug-priority category">', lang_get( 'priority' ), '</th>';
+			echo '<td class="bug-priority">', $t_priority, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+
+		# Severity
+		if( $t_show_severity ) {
+			echo '<th class="bug-severity category">', lang_get( 'severity' ), '</th>';
+			echo '<td class="bug-severity">', $t_severity, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+
+		# Reproducibility
+		if( $t_show_reproducibility ) {
+			echo '<th class="bug-reproducibility category">', lang_get( 'reproducibility' ), '</th>';
+			echo '<td class="bug-reproducibility">', $t_reproducibility, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+
+		# spacer
+		if( $t_spacer > 0 ) {
+			echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		}
+
+		echo '</tr>';
 	}
 
-	echo '</tr>';
-}
+	#
+	# Status, Resolution
+	#
+
+	if( $t_show_status || $t_show_resolution ) {
+		echo '<tr>';
 
-#
-# Status, Resolution
-#
+		$t_spacer = 2;
 
-if( $t_show_status || $t_show_resolution ) {
-	echo '<tr>';
+		# Status
+		if( $t_show_status ) {
+			echo '<th class="bug-status category">', lang_get( 'status' ), '</th>';
 
-	$t_spacer = 2;
+			# choose color based on status
+			$t_status_label = html_get_status_css_class( $t_bug->status );
 
-	# Status
-	if( $t_show_status ) {
-		echo '<th class="bug-status category">', lang_get( 'status' ), '</th>';
+			echo '<td class="bug-status">';
+			echo '<i class="fa fa-square-o fa-xlg ' . $t_status_label . '"></i> ';
+			echo $t_status, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-		# choose color based on status
-		$t_status_label = html_get_status_css_class( $t_bug->status );
+		# Resolution
+		if( $t_show_resolution ) {
+			echo '<th class="bug-resolution category">', lang_get( 'resolution' ), '</th>';
+			echo '<td class="bug-resolution">', $t_resolution, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+		
+			
+		# Gravity
+		if ( $t_show_gravity ) {
+			echo '<th class="bug-resolution category">', lang_get( 'gravity' ), '</th>';
+			echo '<td class="bug-resolution">', $t_gravity, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-		echo '<td class="bug-status">';
-		echo '<i class="fa fa-square-o fa-xlg ' . $t_status_label . '"></i> ';
-		echo $t_status, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		# spacer
+		if( $t_spacer > 0 ) {
+			echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		}
 
-	# Resolution
-	if( $t_show_resolution ) {
-		echo '<th class="bug-resolution category">', lang_get( 'resolution' ), '</th>';
-		echo '<td class="bug-resolution">', $t_resolution, '</td>';
-	} else {
-		$t_spacer += 2;
+		echo '</tr>';
 	}
 
-	# spacer
-	if( $t_spacer > 0 ) {
+	#
+	# Projection, ETA
+	#
+
+	if( $t_show_projection || $t_show_eta ) {
+		echo '<tr>';
+
+		$t_spacer = 2;
+
+		if( $t_show_projection ) {
+			# Projection
+			echo '<th class="bug-projection category">', lang_get( 'projection' ), '</th>';
+			echo '<td class="bug-projection">', $t_projection, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+
+		# ETA
+		if( $t_show_eta ) {
+			echo '<th class="bug-eta category">', lang_get( 'eta' ), '</th>';
+			echo '<td class="bug-eta">', $t_eta, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
+
 		echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		echo '</tr>';
 	}
 
-	echo '</tr>';
-}
+	#
+	# Platform, OS, OS Version
+	#
 
-#
-# Projection, ETA
-#
-
-if( $t_show_projection || $t_show_eta ) {
-	echo '<tr>';
-
-	$t_spacer = 2;
-
-	if( $t_show_projection ) {
-		# Projection
-		echo '<th class="bug-projection category">', lang_get( 'projection' ), '</th>';
-		echo '<td class="bug-projection">', $t_projection, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+	if( ( $t_show_platform || $t_show_os || $t_show_os_version ) &&
+		( $t_platform || $t_os || $t_os_version )) {
+		$t_spacer = 0;
 
-	# ETA
-	if( $t_show_eta ) {
-		echo '<th class="bug-eta category">', lang_get( 'eta' ), '</th>';
-		echo '<td class="bug-eta">', $t_eta, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		echo '<tr>';
 
-	echo '<td colspan="', $t_spacer, '">&#160;</td>';
-	echo '</tr>';
-}
+		# Platform
+		if( $t_show_platform ) {
+			echo '<th class="bug-platform category">', lang_get( 'platform' ), '</th>';
+			echo '<td class="bug-platform">', $t_platform, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-#
-# Platform, OS, OS Version
-#
-
-if( ( $t_show_platform || $t_show_os || $t_show_os_version ) &&
-	( $t_platform || $t_os || $t_os_version )) {
-	$t_spacer = 0;
-
-	echo '<tr>';
-
-	# Platform
-	if( $t_show_platform ) {
-		echo '<th class="bug-platform category">', lang_get( 'platform' ), '</th>';
-		echo '<td class="bug-platform">', $t_platform, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		# Operating System
+		if( $t_show_os ) {
+			echo '<th class="bug-os category">', lang_get( 'os' ), '</th>';
+			echo '<td class="bug-os">', $t_os, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-	# Operating System
-	if( $t_show_os ) {
-		echo '<th class="bug-os category">', lang_get( 'os' ), '</th>';
-		echo '<td class="bug-os">', $t_os, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		# OS Version
+		if( $t_show_os_version ) {
+			echo '<th class="bug-os-version category">', lang_get( 'os_version' ), '</th>';
+			echo '<td class="bug-os-version">', $t_os_version, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-	# OS Version
-	if( $t_show_os_version ) {
-		echo '<th class="bug-os-version category">', lang_get( 'os_version' ), '</th>';
-		echo '<td class="bug-os-version">', $t_os_version, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		if( $t_spacer > 0 ) {
+			echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		}
 
-	if( $t_spacer > 0 ) {
-		echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		echo '</tr>';
 	}
 
-	echo '</tr>';
-}
+	#
+	# Product Version, Product Build
+	#
 
-#
-# Product Version, Product Build
-#
-
-if( $t_show_product_version || $t_show_product_build ) {
-	$t_spacer = 2;
-
-	echo '<tr>';
-
-	# Product Version
-	if( $t_show_product_version ) {
-		echo '<th class="bug-product-version category">', lang_get( 'product_version' ), '</th>';
-		echo '<td class="bug-product-version">', $t_product_version_string, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+	if( $t_show_product_version || $t_show_product_build ) {
+		$t_spacer = 2;
 
-	# Product Build
-	if( $t_show_product_build ) {
-		echo '<th class="bug-product-build category">', lang_get( 'product_build' ), '</th>';
-		echo '<td class="bug-product-build">', $t_product_build, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		echo '<tr>';
 
-	# spacer
-	echo '<td colspan="', $t_spacer, '">&#160;</td>';
+		# Product Version
+		if( $t_show_product_version ) {
+			echo '<th class="bug-product-version category">', lang_get( 'product_version' ), '</th>';
+			echo '<td class="bug-product-version">', $t_product_version_string, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-	echo '</tr>';
-}
+		# Product Build
+		if( $t_show_product_build ) {
+			echo '<th class="bug-product-build category">', lang_get( 'product_build' ), '</th>';
+			echo '<td class="bug-product-build">', $t_product_build, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-#
-# Target Version, Fixed In Version
-#
-
-if( $t_show_target_version || $t_show_fixed_in_version ) {
-	$t_spacer = 2;
-
-	echo '<tr>';
-
-	# target version
-	if( $t_show_target_version ) {
-		# Target Version
-		echo '<th class="bug-target-version category">', lang_get( 'target_version' ), '</th>';
-		echo '<td class="bug-target-version">', $t_target_version_string, '</td>';
-	} else {
-		$t_spacer += 2;
-	}
+		# spacer
+		echo '<td colspan="', $t_spacer, '">&#160;</td>';
 
-	# fixed in version
-	if( $t_show_fixed_in_version ) {
-		echo '<th class="bug-fixed-in-version category">', lang_get( 'fixed_in_version' ), '</th>';
-		echo '<td class="bug-fixed-in-version">', $t_fixed_in_version_string, '</td>';
-	} else {
-		$t_spacer += 2;
+		echo '</tr>';
 	}
 
-	# spacer
-	echo '<td colspan="', $t_spacer, '">&#160;</td>';
+	#
+	# Target Version, Fixed In Version
+	#
 
-	echo '</tr>';
-}
+	if( $t_show_target_version || $t_show_fixed_in_version ) {
+		$t_spacer = 2;
 
-#
-# Bug Details Event Signal
-#
-
-event_signal( 'EVENT_VIEW_BUG_DETAILS', array( $t_bug_id ) );
-
-# spacer
-echo '<tr class="spacer"><td colspan="6"></td></tr>';
-echo '<tr class="hidden"></tr>';
-
-#
-# Bug Details (screen wide fields)
-#
-
-# Summary
-if( $t_show_summary ) {
-	echo '<tr>';
-	echo '<th class="bug-summary category">', lang_get( 'summary' ), '</th>';
-	echo '<td class="bug-summary" colspan="5">', $t_summary, '</td>';
-	echo '</tr>';
-}
+		echo '<tr>';
 
-# Description
-if( $t_show_description ) {
-	echo '<tr>';
-	echo '<th class="bug-description category">', lang_get( 'description' ), '</th>';
-	echo '<td class="bug-description" colspan="5">', $t_description, '</td>';
-	echo '</tr>';
-}
+		# target version
+		if( $t_show_target_version ) {
+			# Target Version
+			echo '<th class="bug-target-version category">', lang_get( 'target_version' ), '</th>';
+			echo '<td class="bug-target-version">', $t_target_version_string, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-# Steps to Reproduce
-if( $t_show_steps_to_reproduce ) {
-	echo '<tr>';
-	echo '<th class="bug-steps-to-reproduce category">', lang_get( 'steps_to_reproduce' ), '</th>';
-	echo '<td class="bug-steps-to-reproduce" colspan="5">', $t_steps_to_reproduce, '</td>';
-	echo '</tr>';
-}
+		# fixed in version
+		if( $t_show_fixed_in_version ) {
+			echo '<th class="bug-fixed-in-version category">', lang_get( 'fixed_in_version' ), '</th>';
+			echo '<td class="bug-fixed-in-version">', $t_fixed_in_version_string, '</td>';
+		} else {
+			$t_spacer += 2;
+		}
 
-# Additional Information
-if( $t_show_additional_information ) {
-	echo '<tr>';
-	echo '<th class="bug-additional-information category">', lang_get( 'additional_information' ), '</th>';
-	echo '<td class="bug-additional-information" colspan="5">', $t_additional_information, '</td>';
-	echo '</tr>';
-}
+		# spacer
+		echo '<td colspan="', $t_spacer, '">&#160;</td>';
 
-# Tagging
-if( $t_show_tags ) {
-	echo '<tr>';
-	echo '<th class="bug-tags category">', lang_get( 'tags' ), '</th>';
-	echo '<td class="bug-tags" colspan="5">';
-	tag_display_attached( $t_bug_id );
-	echo '</td></tr>';
-}
+		echo '</tr>';
+	}
 
-# Attach Tags
-if( $t_can_attach_tag ) {
-	echo '<tr class="noprint">';
-	echo '<th class="bug-attach-tags category">', lang_get( 'tag_attach_long' ), '</th>';
-	echo '<td class="bug-attach-tags" colspan="5">';
-	print_tag_attach_form( $t_bug_id );
-	echo '</td></tr>';
-}
+	#
+	# Bug Details Event Signal
+	#
 
-# spacer
-echo '<tr class="spacer"><td colspan="6"></td></tr>';
-echo '<tr class="hidden"></tr>';
-
-# Custom Fields
-$t_custom_fields_found = false;
-$t_related_custom_field_ids = custom_field_get_linked_ids( $t_bug->project_id );
-custom_field_cache_values( array( $t_bug->id ) , $t_related_custom_field_ids );
-
-foreach( $t_related_custom_field_ids as $t_id ) {
-	if( !custom_field_has_read_access( $t_id, $f_bug_id ) ) {
-		continue;
-	} # has read access
-
-	$t_custom_fields_found = true;
-	$t_def = custom_field_get_definition( $t_id );
-
-	echo '<tr>';
-	echo '<th class="bug-custom-field category">', string_display( lang_get_defaulted( $t_def['name'] ) ), '</th>';
-	echo '<td class="bug-custom-field" colspan="5">';
-	print_custom_field_value( $t_def, $t_id, $f_bug_id );
-	echo '</td></tr>';
-}
+	event_signal( 'EVENT_VIEW_BUG_DETAILS', array( $t_bug_id ) );
 
-if( $t_custom_fields_found ) {
 	# spacer
 	echo '<tr class="spacer"><td colspan="6"></td></tr>';
 	echo '<tr class="hidden"></tr>';
-}
 
-echo '</tbody></table>';
-echo '</div></div></div></div></div>';
+	#
+	# Bug Details (screen wide fields)
+	#
+
+	# Summary
+	if( $t_show_summary ) {
+		echo '<tr>';
+		echo '<th class="bug-summary category">', lang_get( 'summary' ), '</th>';
+		echo '<td class="bug-summary" colspan="5">', $t_summary, '</td>';
+		echo '</tr>';
+	}
+
+	# Description
+	if( $t_show_description ) {
+		echo '<tr>';
+		echo '<th class="bug-description category">', lang_get( 'description' ), '</th>';
+		echo '<td class="bug-description" colspan="5">', $t_description, '</td>';
+		echo '</tr>';
+	}
+
+	# Steps to Reproduce
+	if( $t_show_steps_to_reproduce ) {
+		echo '<tr>';
+		echo '<th class="bug-steps-to-reproduce category">', lang_get( 'steps_to_reproduce' ), '</th>';
+		echo '<td class="bug-steps-to-reproduce" colspan="5">', $t_steps_to_reproduce, '</td>';
+		echo '</tr>';
+	}
+
+	# Additional Information
+	if( $t_show_additional_information ) {
+		echo '<tr>';
+		echo '<th class="bug-additional-information category">', lang_get( 'additional_information' ), '</th>';
+		echo '<td class="bug-additional-information" colspan="5">', $t_additional_information, '</td>';
+		echo '</tr>';
+	}
+
+	# Tagging
+	if( $t_show_tags ) {
+		echo '<tr>';
+		echo '<th class="bug-tags category">', lang_get( 'tags' ), '</th>';
+		echo '<td class="bug-tags" colspan="5">';
+		tag_display_attached( $t_bug_id );
+		echo '</td></tr>';
+	}
+
+	# Attach Tags
+	if( $t_can_attach_tag ) {
+		echo '<tr class="noprint">';
+		echo '<th class="bug-attach-tags category">', lang_get( 'tag_attach_long' ), '</th>';
+		echo '<td class="bug-attach-tags" colspan="5">';
+		print_tag_attach_form( $t_bug_id );
+		echo '</td></tr>';
+	}
 
-# User list sponsoring the bug
-if( $t_show_sponsorships_box ) {
-	define( 'BUG_SPONSORSHIP_LIST_VIEW_INC_ALLOW', true );
-	include( $t_mantis_dir . 'bug_sponsorship_list_view_inc.php' );
-}
+	# spacer
+	echo '<tr class="spacer"><td colspan="6"></td></tr>';
+	echo '<tr class="hidden"></tr>';
 
-# Bug Relationships
-if( $t_show_relationships_box ) {
-	relationship_view_box( $t_bug->id );
-}
+	# Custom Fields
+	$t_custom_fields_found = false;
+	$t_related_custom_field_ids = custom_field_get_linked_ids( $t_bug->project_id );
+	custom_field_cache_values( array( $t_bug->id ) , $t_related_custom_field_ids );
 
-# User list monitoring the bug
-if( $t_show_monitor_box ) {
-	define( 'BUG_MONITOR_LIST_VIEW_INC_ALLOW', true );
-	include( $t_mantis_dir . 'bug_monitor_list_view_inc.php' );
-}
+	foreach( $t_related_custom_field_ids as $t_id ) {
+		if( !custom_field_has_read_access( $t_id, $f_bug_id ) ) {
+			continue;
+		} # has read access
 
-# Bugnotes and "Add Note" box
-if( 'ASC' == current_user_get_pref( 'bugnote_order' ) ) {
-	define( 'BUGNOTE_VIEW_INC_ALLOW', true );
-	include( $t_mantis_dir . 'bugnote_view_inc.php' );
-
-	if( !$t_force_readonly ) {
-		define( 'BUGNOTE_ADD_INC_ALLOW', true );
-		include( $t_mantis_dir . 'bugnote_add_inc.php' );
-	}
-} else {
-	if( !$t_force_readonly ) {
-		define( 'BUGNOTE_ADD_INC_ALLOW', true );
-		include( $t_mantis_dir . 'bugnote_add_inc.php' );
+		$t_custom_fields_found = true;
+		$t_def = custom_field_get_definition( $t_id );
+
+		echo '<tr>';
+		echo '<th class="bug-custom-field category">', string_display( lang_get_defaulted( $t_def['name'] ) ), '</th>';
+		echo '<td class="bug-custom-field" colspan="5">';
+		print_custom_field_value( $t_def, $t_id, $f_bug_id );
+		echo '</td></tr>';
 	}
 
-	define( 'BUGNOTE_VIEW_INC_ALLOW', true );
-	include( $t_mantis_dir . 'bugnote_view_inc.php' );
-}
+	if( $t_custom_fields_found ) {
+		# spacer
+		echo '<tr class="spacer"><td colspan="6"></td></tr>';
+		echo '<tr class="hidden"></tr>';
+	}
 
-# Allow plugins to display stuff after notes
-event_signal( 'EVENT_VIEW_BUG_EXTRA', array( $f_bug_id ) );
+	echo '</tbody></table>';
+	echo '</div></div></div></div></div>';
 
-# Time tracking statistics
-if( config_get( 'time_tracking_enabled' ) &&
-	access_has_bug_level( config_get( 'time_tracking_view_threshold' ), $f_bug_id ) ) {
-	define( 'BUGNOTE_STATS_INC_ALLOW', true );
-	include( $t_mantis_dir . 'bugnote_stats_inc.php' );
-}
+	# User list sponsoring the bug
+	if( $t_show_sponsorships_box ) {
+		define( 'BUG_SPONSORSHIP_LIST_VIEW_INC_ALLOW', true );
+		include( $t_mantis_dir . 'bug_sponsorship_list_view_inc.php' );
+	}
 
-# History
-if( $t_show_history ) {
-	define( 'HISTORY_INC_ALLOW', true );
-	include( $t_mantis_dir . 'history_inc.php' );
-}
+	# Bug Relationships
+	if( $t_show_relationships_box ) {
+		relationship_view_box( $t_bug->id );
+	}
+
+	# User list monitoring the bug
+	if( $t_show_monitor_box ) {
+		define( 'BUG_MONITOR_LIST_VIEW_INC_ALLOW', true );
+		include( $t_mantis_dir . 'bug_monitor_list_view_inc.php' );
+	}
+
+	# Bugnotes and "Add Note" box
+	if( 'ASC' == current_user_get_pref( 'bugnote_order' ) ) {
+		define( 'BUGNOTE_VIEW_INC_ALLOW', true );
+		include( $t_mantis_dir . 'bugnote_view_inc.php' );
+
+		if( !$t_force_readonly ) {
+			define( 'BUGNOTE_ADD_INC_ALLOW', true );
+			include( $t_mantis_dir . 'bugnote_add_inc.php' );
+		}
+	} else {
+		if( !$t_force_readonly ) {
+			define( 'BUGNOTE_ADD_INC_ALLOW', true );
+			include( $t_mantis_dir . 'bugnote_add_inc.php' );
+		}
+
+		define( 'BUGNOTE_VIEW_INC_ALLOW', true );
+		include( $t_mantis_dir . 'bugnote_view_inc.php' );
+	}
+
+	# Allow plugins to display stuff after notes
+	event_signal( 'EVENT_VIEW_BUG_EXTRA', array( $f_bug_id ) );
 
+	# Time tracking statistics
+	if( config_get( 'time_tracking_enabled' ) &&
+		access_has_bug_level( config_get( 'time_tracking_view_threshold' ), $f_bug_id ) ) {
+		define( 'BUGNOTE_STATS_INC_ALLOW', true );
+		include( $t_mantis_dir . 'bugnote_stats_inc.php' );
+	}
+
+	# History
+	if( $t_show_history ) {
+		define( 'HISTORY_INC_ALLOW', true );
+		include( $t_mantis_dir . 'history_inc.php' );
+	}
+	
+}
 layout_page_end();
 
-last_visited_issue( $t_bug_id );
+//last_visited_issue( $t_bug_id );
diff -rNU5 mantisbt/core/authentication_api.php mantisbt-2.0.0/core/authentication_api.php
--- mantisbt/core/authentication_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/authentication_api.php	2017-02-03 11:15:03.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage AuthenticationAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses config_api.php
  * @uses constant_inc.php
@@ -73,21 +74,212 @@
 
 # @global int $g_cache_current_user_id
 $g_cache_current_user_id = null;
 
 /**
+ * Initialize phpCAS.
+ */
+function auth_cas_init() {
+        # phpCAS must be installed in the include path
+        # or in the Mantis directory.
+        require_once('CAS/CAS.php');
+
+        static $s_initialized=false;
+
+        if (! $s_initialized ) {
+                phpCAS::setDebug( config_get( 'cas_debug' ) );
+        ## These should be set in config_inc.php
+                $t_server_version = config_get( 'cas_version' );
+                $t_server_cas_server = config_get( 'cas_server' );
+                $t_server_port = config_get( 'cas_port' );
+                $t_server_uri = config_get( 'cas_uri' );
+
+                phpCAS::client($t_server_version, $t_server_cas_server, $t_server_port, $t_server_uri);
+		phpCAS::handleLogoutRequests(false);
+
+                if ($t_server_version == "S1")
+                        phpCAS::setServerSamlValidateURL( config_get( 'cas_validate' ) );
+                else
+                        phpCAS::setServerProxyValidateURL( config_get( 'cas_validate' ) );
+                if (method_exists('phpCAS', 'setNoCasServerValidation')) {
+                        // no SSL validation for the CAS server
+                        phpCAS::setNoCasServerValidation();
+                }
+
+                $s_initialized = true;
+        }
+
+}
+
+
+/**
+ * Fetches the user's CAS name, authenticating if needed.
+ * Can translate CAS login name to Mantis username through LDAP.
+ */
+function auth_cas_get_name()
+{
+        # Get CAS username from phpCAS
+        auth_cas_init();
+        phpCAS::forceAuthentication();
+        $t_cas_id = phpCAS::getUser();
+        $t_cas_attribs = phpCAS::getAttributes();
+
+        # If needed, translate the CAS username through LDAP
+        $t_username = $t_cas_id;
+        if (config_get( 'cas_use_ldap', false )) {
+                $t_username = auth_cas_ldap_translate( $t_cas_id );
+        }
+        elseif (config_get( 'cas_saml_attributes', false )) {
+                $t_cas_attribmap = config_get( 'cas_saml_map', array() );
+                $t_cas_attrib_name = $t_cas_attribs[$t_cas_attribmap['name']];
+                $t_cas_attrib_mail = $t_cas_attribs[$t_cas_attribmap['mail']];
+                if ( user_get_id_by_name($t_cas_id) == false ) {
+                        user_create( $t_cas_id, '', $t_cas_attrib_mail, null, false, true, $t_cas_attrib_name );
+	         }
+        }
+                                
+        return $t_username;
+}
+
+/**
+ * Takes an ID string, and looks up the LDAP directory to find
+ * the matching username for Mantis.
+ *
+ * Optionally, also update the user information in the Mantis user
+ * table.
+ *
+ * @param $p_cas_id string Typically, the username given by phpCAS.
+ * @param $p_update_user bool Whether or not to update user details from LDAP.
+ */
+function auth_cas_ldap_translate( $p_cas_id, $p_update_user='' )
+{
+
+        # Please make sure the Mantis CAS and LDAP settings are set in config_inc.php
+
+        $t_ldap_organization    = config_get( 'ldap_organization' );
+        $t_ldap_root_dn         = config_get( 'ldap_root_dn' );
+
+        # Required fields in LDAP for CAS
+        $t_ldap_language_field = config_get( 'ldap_language_field', '' );
+        $t_ldap_uid_field = config_get( 'ldap_uid_field', 'uid' ) ;
+        $t_ldap_mantis_uid = config_get( 'ldap_mantis_uid', 'uid' );
+        $t_ldap_required = array( $t_ldap_uid_field, $t_ldap_mantis_uid, 'dn' );
+        if ($t_ldap_language_field) {
+                // Add language field to attributes list only if it is configured.
+                $t_ldap_required[] = $t_ldap_language_field;
+        }
+        $t_ldap_required = array_combine( $t_ldap_required, $t_ldap_required );
+
+        # User-defined fields to fetch from LDAP...
+        $t_ldap_fields = explode( ',', config_get( 'cas_ldap_update_fields' ) );
+        $t_ldap_fields = array_combine( $t_ldap_fields, $t_ldap_fields );
+        # ...which are mapped to Mantis user fields
+        $t_ldap_map = explode( ',', config_get( 'cas_ldap_update_map' ) );
+        $t_ldap_map = array_combine( $t_ldap_map, $t_ldap_map );
+
+        # Build LDAP search filter, attribute list from CAS ID
+        $t_search_filter = "(&$t_ldap_organization($t_ldap_uid_field=$p_cas_id))";
+        $t_search_attrs = array_values($t_ldap_required + $t_ldap_fields);      # array union
+
+        # Use Mantis ldap_api to connect to LDAP
+        $t_ds = ldap_connect_bind();
+        $t_sr   = ldap_search( $t_ds, $t_ldap_root_dn, $t_search_filter, $t_search_attrs );
+        $t_info = ldap_get_entries( $t_ds, $t_sr );
+        # Parse the LDAP entry to find the Mantis username
+        if ( $t_info ) {
+                # Get Mantis username
+                $t_username = $t_info[0][$t_ldap_mantis_uid][0];
+
+                # @@@ The fact that we got here means the user is authenticated
+                # @@@ by CAS, and has an LDAP entry.
+                # @@@ We might as well update other user details since we are here.
+
+                # If no argument given, check settings
+                if ( '' == $p_update_user ) {
+                        $p_update_user = config_get( 'cas_ldap_update', FALSE );
+                }
+                # If there's a user record, then update it
+                if ( $p_update_user ) {
+                        # Only proceed if the field map arrays are the same length
+                        $t_field_map = array_combine( $t_ldap_fields, $t_ldap_map );
+                        if ($t_field_map) {
+                                # If user is new, then we must create their account before updating it
+                                # @@@ ( make sure $g_allow_blank_email == ON )
+                                $t_userid = user_get_id_by_name($t_username);
+                                if ( false == $t_userid ) {
+                                        user_create( $t_username, '' );
+                                        # @@@ Wow, this is pretty lame
+                                        $t_userid = user_get_id_by_name($t_username);
+                                }
+                                # @@@ maybe we can optimize this to write all fields at once?
+                                foreach ( $t_field_map as $key=>$t_userfield ) {
+                                        if (isset($t_info[0][$key][0])) {
+                                                user_set_field( $t_userid, $t_userfield, $t_info[0][$key][0] );
+                                        }
+                                }
+                        }
+
+                        // Update user's overall language preference
+                        if ($t_ldap_language_field) {
+                                $t_language = $t_info[0][$t_ldap_language_field][0];
+                                // Map the LDAP language field to Mantis' language field if needed
+                                $t_language_keys = config_get( 'ldap_language_keys', '');
+                                $t_language_values = config_get( 'ldap_language_values', '');
+                                $t_language_map = array_combine(
+                                        explode(',', $t_language_keys),
+                                        explode(',', $t_language_values)
+                                );
+                                if (isset($t_language_map[$t_language])) {
+                                        $t_language = $t_language_map[$t_language];
+                                }
+                                user_pref_set_pref($t_userid, 'language', $t_language);
+                        }
+                }
+        }
+        ldap_free_result( $t_sr );
+        ldap_unbind( $t_ds );
+
+        return $t_username;
+}
+
+
+/**
+ * Logs out of CAS, redirecting to Mantis on re-login.
+ * User should already be logged out of Mantis by the time this is called.
+ * @see auth_logout()
+ */
+function auth_cas_logout()
+{
+        $t_path = config_get('path');
+
+        auth_cas_init();
+        if (method_Exists('phpCAS', 'logoutWithUrl')) {
+                phpCAS::logoutWithUrl($t_path);
+        } else {
+                phpCAS::logout($t_path);
+        }
+}
+
+/**
  * Check that there is a user logged-in and authenticated
  * If the user's account is disabled they will be logged out
  * If there is no user logged in, redirect to the login page
  * If parameter is given it is used as a URL to redirect to following
  * successful login.  If none is given, the URL of the current page is used
  * @param string $p_return_page Page to redirect to following successful logon, defaults to current page.
  * @access public
  * @return void
  */
 function auth_ensure_user_authenticated( $p_return_page = '' ) {
+	global $g_cache_current_user_id;
 	# if logged in
+	if ( CAS_AUTH == config_get( 'login_method' ) ) {
+		# This will detour to the CAS login page if needed
+		$f_username = auth_cas_get_name();
+		auth_attempt_login($f_username,$f_password,$f_perm_login);
+		$g_cache_current_user_id = user_get_id_by_name( $f_username );
+	}
 	if( auth_is_user_authenticated() ) {
 		# check for access enabled
 		#  This also makes sure the cookie is valid
 		if( OFF == current_user_get_field( 'enabled' ) ) {
 			print_header_redirect( 'logout_page.php' );
@@ -197,12 +389,13 @@
  * @access private
  */
 function auth_auto_create_user( $p_username, $p_password ) {
 	$t_login_method = config_get( 'login_method' );
 
-	if( $t_login_method == BASIC_AUTH ) {
-		$t_auto_create = true;
+	if ( in_array( $t_login_method, array( BASIC_AUTH, CAS_AUTH ) ) ) {
+			# attempt to create the user if using BASIC_AUTH or CAS_AUTH
+			$t_auto_create = true;
 	} else if( $t_login_method == LDAP && ldap_authenticate_by_username( $p_username, $p_password ) ) {
 		$t_auto_create = true;
 	} else {
 		$t_auto_create = false;
 	}
@@ -447,10 +640,14 @@
 	}
 
 	if( HTTP_AUTH == config_get( 'login_method' ) ) {
 		auth_http_set_logout_pending( true );
 	}
+	elseif ( CAS_AUTH == config_get( 'login_method' ) ) {
+		# Redirect to CAS page to logout
+		auth_cas_logout();
+	}
 
 	session_clean();
 }
 
 /**
@@ -460,10 +657,12 @@
  */
 function auth_automatic_logon_bypass_form() {
 	switch( config_get( 'login_method' ) ) {
 		case HTTP_AUTH:
 			return true;
+		case CAS_AUTH:
+			return true;
 	}
 	return false;
 }
 
 /**
@@ -498,11 +697,15 @@
 	$t_configured_login_method = config_get( 'login_method' );
 
 	if( LDAP == $t_configured_login_method ) {
 		return ldap_authenticate( $p_user_id, $p_test_password );
 	}
-
+	elseif ( CAS_AUTH == $t_configured_login_method ) {
+		# CAS already took care of password verification for us
+		return true;
+	}
+	
 	$t_password = user_get_field( $p_user_id, 'password' );
 	$t_login_methods = array(
 		MD5,
 		CRYPT,
 		PLAIN,
@@ -759,11 +962,11 @@
  *
  * @return boolean
  * @access public
  */
 function auth_reauthenticate() {
-	if( config_get_global( 'reauthentication' ) == OFF || BASIC_AUTH == config_get( 'login_method' ) || HTTP_AUTH == config_get( 'login_method' ) ) {
+	if( config_get_global( 'reauthentication' ) == OFF || in_array(config_get('login_method'), array(BASIC_AUTH, HTTP_AUTH, CAS_AUTH)) ) {
 		return true;
 	}
 
 	$t_auth_token = token_get( TOKEN_AUTHENTICATED );
 	if( null != $t_auth_token ) {
@@ -890,11 +1093,11 @@
 	header( 'HTTP/1.0 401 Authorization Required' );
 	header( 'WWW-Authenticate: Basic realm="' . lang_get( 'http_auth_realm' ) . '"' );
 	header( 'status: 401 Unauthorized' );
 
 	echo '<p class="center error-msg">' . error_string( ERROR_ACCESS_DENIED ) . '</p>';
-	print_link_button( 'main_page.php', lang_get( 'proceed' ) );
+	print_bracket_link( 'main_page.php', lang_get( 'proceed' ) );
 
 	exit;
 }
 
 /**
diff -rNU5 mantisbt/core/bug_api.php mantisbt-2.0.0/core/bug_api.php
--- mantisbt/core/bug_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/bug_api.php	2017-02-03 11:11:57.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage BugAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses antispam_api.php
  * @uses authentication_api.php
@@ -457,10 +458,16 @@
 
 		# Ensure that category id is a valid category
 		if( $this->category_id > 0 ) {
 			category_ensure_exists( $this->category_id );
 		}
+		
+		# Make sure a priority is set
+		if( 0 == $this->priority && !config_get( 'allow_no_priority' ) ) {
+			error_parameters( lang_get( 'priority' ) );
+			trigger_error( ERROR_EMPTY_FIELD, ERROR );
+		}
 
 		if( !is_blank( $this->duplicate_id ) && ( $this->duplicate_id != 0 ) && ( $this->id == $this->duplicate_id ) ) {
 			trigger_error( ERROR_BUG_DUPLICATE_SELF, ERROR );
 			# never returns
 		}
@@ -471,11 +478,11 @@
 	 * @return integer integer representing the bug identifier that was created
 	 * @access public
 	 * @uses database_api.php
 	 * @uses lang_api.php
 	 */
-	function create() {
+	function create( $p_care_about_status_and_assignement = true ) {
 		self::validate( true );
 
 		antispam_check();
 
 		# check due_date format
@@ -519,13 +526,15 @@
 
 			if( $t_handler !== false && user_exists( $t_handler ) ) {
 				$this->handler_id = $t_handler;
 			}
 		}
-
+		
 		# Check if bug was pre-assigned or auto-assigned.
-		$t_status = bug_get_status_for_assign( NO_USER, $this->handler_id, $this->status);
+		$t_status = bug_get_status_for_assign( NO_USER, $this->handler_id, $this->status,null,$p_care_about_status_and_assignement);
+		
+		$t_date_submitted = !is_blank( $this->date_submitted ) ? $this->date_submitted : db_now();
 
 		# Insert the rest of the data
 		db_param_push();
 		$t_query = 'INSERT INTO {bug}
 					    ( project_id,reporter_id, handler_id,duplicate_id,
@@ -542,11 +551,11 @@
 					      ' . db_param() . ',' . db_param() . ',' . db_param() . ',' . db_param() . ',
 					      ' . db_param() . ',' . db_param() . ',' . db_param() . ',' . db_param() . ',
 					      ' . db_param() . ',' . db_param() . ',' . db_param() . ',' . db_param() . ',
 					      ' . db_param() . ',' . db_param() . ',' . db_param() . ',' . db_param() . ',
 					      ' . db_param() . ',' . db_param() . ',' . db_param() . ',' . db_param() . ')';
-		db_query( $t_query, array( $this->project_id, $this->reporter_id, $this->handler_id, $this->duplicate_id, $this->priority, $this->severity, $this->reproducibility, $t_status, $this->resolution, $this->projection, $this->category_id, $this->date_submitted, $this->last_updated, $this->eta, $t_text_id, $this->os, $this->os_build, $this->platform, $this->version, $this->build, $this->profile_id, $this->summary, $this->view_state, $this->sponsorship_total, $this->sticky, $this->fixed_in_version, $this->target_version, $this->due_date ) );
+		db_query( $t_query, array( $this->project_id, $this->reporter_id, $this->handler_id, $this->duplicate_id, $this->priority, $this->severity, $this->reproducibility, $t_status, $this->resolution, $this->projection, $this->category_id, $t_date_submitted, $this->last_updated, $this->eta, $t_text_id, $this->os, $this->os_build, $this->platform, $this->version, $this->build, $this->profile_id, $this->summary, $this->view_state, $this->sponsorship_total, $this->sticky, $this->fixed_in_version, $this->target_version, $this->due_date ) );
 
 		$this->id = db_insert_id( db_get_table( 'bug' ) );
 
 		# log new bug
 		history_log_event_special( $this->id, NEW_BUG );
@@ -2166,24 +2175,27 @@
  * @param integer $p_new_handler		New handler user id
  * @param integer $p_current_status		Current bug status
  * @param integer $p_new_status			New bug status (as being part of a status change combined action)
  * @return integer		Calculated status after assignment
  */
-function bug_get_status_for_assign( $p_current_handler, $p_new_handler, $p_current_status, $p_new_status = null ) {
+function bug_get_status_for_assign( $p_current_handler, $p_new_handler, $p_current_status, $p_new_status = null, $p_care_about_status_and_assignement = true ) {
+	
 	if( null === $p_new_status ) {
 		$p_new_status = $p_current_status;
 	}
-	if( config_get( 'auto_set_status_to_assigned' ) ) {
-		$t_assigned_status = config_get( 'bug_assigned_status' );
-
-		if(		$p_current_handler == NO_USER &&
-				$p_new_handler != NO_USER &&
-				$p_new_status == $p_current_status &&
-				$p_new_status < $t_assigned_status &&
-				bug_check_workflow( $p_current_status, $t_assigned_status ) ) {
-
-			return $t_assigned_status;
+	if ($p_care_about_status_and_assignement){
+		if( config_get( 'auto_set_status_to_assigned' ) ) {
+			$t_assigned_status = config_get( 'bug_assigned_status' );
+
+			if(		$p_current_handler == NO_USER &&
+					$p_new_handler != NO_USER &&
+					$p_new_status == $p_current_status &&
+					$p_new_status < $t_assigned_status &&
+					bug_check_workflow( $p_current_status, $t_assigned_status ) ) {
+					
+				return $t_assigned_status;
+			}
 		}
 	}
 	return $p_new_status;
 }
 
diff -rNU5 mantisbt/core/bug_group_action_api.php mantisbt-2.0.0/core/bug_group_action_api.php
--- mantisbt/core/bug_group_action_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/bug_group_action_api.php	2017-02-03 11:36:28.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage BugGroupActionAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses bug_api.php
  * @uses config_api.php
  * @uses constant_inc.php
@@ -173,120 +174,176 @@
  * Get a list of bug group actions available to the current user for one or
  * more projects.
  * @param array $p_project_ids An array containing one or more project IDs.
  * @return array
  */
-function bug_group_action_get_commands( array $p_project_ids = null ) {
+function bug_group_action_get_commands( array $p_project_ids = null , $management_way = false) {
 	if( $p_project_ids === null || count( $p_project_ids ) == 0 ) {
 		$p_project_ids = array( ALL_PROJECTS );
 	}
 
 	$t_commands = array();
 	foreach( $p_project_ids as $t_project_id ) {
+	
+		if ( !$management_way ) {
 
-		if( !isset( $t_commands['MOVE'] ) &&
-			access_has_project_level( config_get( 'move_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['MOVE'] = lang_get( 'actiongroup_menu_move' );
-		}
+			if( !isset( $t_commands['MOVE'] ) &&
+				access_has_project_level( config_get( 'move_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['MOVE'] = lang_get( 'actiongroup_menu_move' );
+			}
 
-		if( !isset( $t_commands['COPY'] ) &&
-			access_has_any_project( config_get( 'report_bug_threshold', null, null, $t_project_id ) ) ) {
-			$t_commands['COPY'] = lang_get( 'actiongroup_menu_copy' );
-		}
+			if( !isset( $t_commands['COPY'] ) &&
+				access_has_any_project( config_get( 'report_bug_threshold', null, null, $t_project_id ) ) ) {
+				$t_commands['COPY'] = lang_get( 'actiongroup_menu_copy' );
+			}
 
-		if( !isset( $t_commands['ASSIGN'] ) &&
-			access_has_project_level( config_get( 'update_bug_assign_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['ASSIGN'] = lang_get( 'actiongroup_menu_assign' );
-		}
+			if( !isset( $t_commands['ASSIGN'] ) &&
+				access_has_project_level( config_get( 'update_bug_assign_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['ASSIGN'] = lang_get( 'actiongroup_menu_assign' );
+			}
 
-		if( !isset( $t_commands['CLOSE'] ) &&
-			access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) &&
-			( access_has_project_level( access_get_status_threshold( config_get( 'bug_closed_status_threshold', null, null, $t_project_id ), $t_project_id ), $t_project_id ) ||
-				access_has_project_level( config_get( 'allow_reporter_close', null, null, $t_project_id ), $t_project_id ) ) ) {
-			$t_commands['CLOSE'] = lang_get( 'actiongroup_menu_close' );
-		}
+			if( !isset( $t_commands['CLOSE'] ) &&
+				access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) &&
+				( access_has_project_level( access_get_status_threshold( config_get( 'bug_closed_status_threshold', null, null, $t_project_id ), $t_project_id ), $t_project_id ) ||
+					access_has_project_level( config_get( 'allow_reporter_close', null, null, $t_project_id ), $t_project_id ) ) ) {
+				$t_commands['CLOSE'] = lang_get( 'actiongroup_menu_close' );
+			}
 
-		if( !isset( $t_commands['DELETE'] ) &&
-			access_has_project_level( config_get( 'delete_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['DELETE'] = lang_get( 'actiongroup_menu_delete' );
-		}
+			if( !isset( $t_commands['DELETE'] ) &&
+				access_has_project_level( config_get( 'delete_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['DELETE'] = lang_get( 'actiongroup_menu_delete' );
+			}
 
-		if( !isset( $t_commands['RESOLVE'] ) &&
-			access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) &&
-			access_has_project_level( access_get_status_threshold( config_get( 'bug_resolved_status_threshold', null, null, $t_project_id ), $t_project_id ), $t_project_id ) ) {
-			$t_commands['RESOLVE'] = lang_get( 'actiongroup_menu_resolve' );
-		}
+			if( !isset( $t_commands['RESOLVE'] ) &&
+				access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) &&
+				access_has_project_level( access_get_status_threshold( config_get( 'bug_resolved_status_threshold', null, null, $t_project_id ), $t_project_id ), $t_project_id ) ) {
+				$t_commands['RESOLVE'] = lang_get( 'actiongroup_menu_resolve' );
+			}
 
-		if( !isset( $t_commands['SET_STICKY'] ) &&
-			access_has_project_level( config_get( 'set_bug_sticky_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['SET_STICKY'] = lang_get( 'actiongroup_menu_set_sticky' );
-		}
+			if( !isset( $t_commands['SET_STICKY'] ) &&
+				access_has_project_level( config_get( 'set_bug_sticky_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['SET_STICKY'] = lang_get( 'actiongroup_menu_set_sticky' );
+			}
 
-		if( !isset( $t_commands['UP_PRIOR'] ) &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_PRIOR'] = lang_get( 'actiongroup_menu_update_priority' );
-		}
+			if( !isset( $t_commands['UP_PRIOR'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_PRIOR'] = lang_get( 'actiongroup_menu_update_priority' );
+			}
 
-		if( !isset( $t_commands['EXT_UPDATE_SEVERITY'] ) &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['EXT_UPDATE_SEVERITY'] = lang_get( 'actiongroup_menu_update_severity' );
-		}
+			if( !isset( $t_commands['EXT_UPDATE_SEVERITY'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_UPDATE_SEVERITY'] = lang_get( 'actiongroup_menu_update_severity' );
+			}
 
-		if( !isset( $t_commands['UP_STATUS'] ) &&
-			access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_STATUS'] = lang_get( 'actiongroup_menu_update_status' );
-		}
+			if( !isset( $t_commands['UP_STATUS'] ) &&
+				access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_STATUS'] = lang_get( 'actiongroup_menu_update_status' );
+			}
 
-		if( !isset( $t_commands['UP_CATEGORY'] ) &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_CATEGORY'] = lang_get( 'actiongroup_menu_update_category' );
-		}
+			if( !isset( $t_commands['UP_CATEGORY'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_CATEGORY'] = lang_get( 'actiongroup_menu_update_category' );
+			}
 
-		if( !isset( $t_commands['VIEW_STATUS'] ) &&
-			access_has_project_level( config_get( 'change_view_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['VIEW_STATUS'] = lang_get( 'actiongroup_menu_update_view_status' );
-		}
+			if( !isset( $t_commands['VIEW_STATUS'] ) &&
+				access_has_project_level( config_get( 'change_view_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['VIEW_STATUS'] = lang_get( 'actiongroup_menu_update_view_status' );
+			}
 
-		if( !isset( $t_commands['EXT_UPDATE_PRODUCT_BUILD'] ) &&
-			config_get( 'enable_product_build', null, null, $t_project_id ) == ON &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['EXT_UPDATE_PRODUCT_BUILD'] = lang_get( 'actiongroup_menu_update_product_build' );
-		}
+			if( !isset( $t_commands['EXT_UPDATE_PRODUCT_BUILD'] ) &&
+				config_get( 'enable_product_build', null, null, $t_project_id ) == ON &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_UPDATE_PRODUCT_BUILD'] = lang_get( 'actiongroup_menu_update_product_build' );
+			}
 
-		if( !isset( $t_commands['EXT_ADD_NOTE'] ) &&
-			access_has_project_level( config_get( 'add_bugnote_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['EXT_ADD_NOTE'] = lang_get( 'actiongroup_menu_add_note' );
-		}
+			if( !isset( $t_commands['EXT_ADD_NOTE'] ) &&
+				access_has_project_level( config_get( 'add_bugnote_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_ADD_NOTE'] = lang_get( 'actiongroup_menu_add_note' );
+			}
 
-		if( !isset( $t_commands['EXT_ATTACH_TAGS'] ) &&
-			access_has_project_level( config_get( 'tag_attach_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['EXT_ATTACH_TAGS'] = lang_get( 'actiongroup_menu_attach_tags' );
-		}
+			if( !isset( $t_commands['EXT_ATTACH_TAGS'] ) &&
+				access_has_project_level( config_get( 'tag_attach_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_ATTACH_TAGS'] = lang_get( 'actiongroup_menu_attach_tags' );
+			}
 
-		if( !isset( $t_commands['UP_DUE_DATE'] ) &&
-			access_has_project_level( config_get( 'due_date_update_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_DUE_DATE'] = lang_get( 'actiongroup_menu_update_due_date' );
-		}
+			if( !isset( $t_commands['UP_DUE_DATE'] ) &&
+				access_has_project_level( config_get( 'due_date_update_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_DUE_DATE'] = lang_get( 'actiongroup_menu_update_due_date' );
+			}
 
-		if( !isset( $t_commands['UP_PRODUCT_VERSION'] ) &&
-			version_should_show_product_version( $t_project_id ) &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_PRODUCT_VERSION'] = lang_get( 'actiongroup_menu_update_product_version' );
-		}
+			if( !isset( $t_commands['UP_PRODUCT_VERSION'] ) &&
+				version_should_show_product_version( $t_project_id ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_PRODUCT_VERSION'] = lang_get( 'actiongroup_menu_update_product_version' );
+			}
 
-		if( !isset( $t_commands['UP_FIXED_IN_VERSION'] ) &&
-			version_should_show_product_version( $t_project_id ) &&
-			access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_FIXED_IN_VERSION'] = lang_get( 'actiongroup_menu_update_fixed_in_version' );
-		}
+			if( !isset( $t_commands['UP_FIXED_IN_VERSION'] ) &&
+				version_should_show_product_version( $t_project_id ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_FIXED_IN_VERSION'] = lang_get( 'actiongroup_menu_update_fixed_in_version' );
+			}
 
-		if( !isset( $t_commands['UP_TARGET_VERSION'] ) &&
-			version_should_show_product_version( $t_project_id ) &&
-			access_has_project_level( config_get( 'roadmap_update_threshold', null, null, $t_project_id ), $t_project_id ) ) {
-			$t_commands['UP_TARGET_VERSION'] = lang_get( 'actiongroup_menu_update_target_version' );
+			if( !isset( $t_commands['UP_TARGET_VERSION'] ) &&
+				version_should_show_product_version( $t_project_id ) &&
+				access_has_project_level( config_get( 'roadmap_update_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_TARGET_VERSION'] = lang_get( 'actiongroup_menu_update_target_version' );
+			}
 		}
+		else {
+		
+			if( !isset( $t_commands['ASSIGN'] ) &&
+				access_has_project_level( config_get( 'update_bug_assign_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['ASSIGN'] = lang_get( 'actiongroup_menu_assign' );
+			}
+
+			if( !isset( $t_commands['SET_STICKY'] ) &&
+				access_has_project_level( config_get( 'set_bug_sticky_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['SET_STICKY'] = lang_get( 'actiongroup_menu_set_sticky' );
+			}
+
+			if( !isset( $t_commands['UP_PRIOR'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_PRIOR'] = lang_get( 'actiongroup_menu_update_priority' );
+			}
 
+			if( !isset( $t_commands['EXT_UPDATE_SEVERITY'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_UPDATE_SEVERITY'] = lang_get( 'actiongroup_menu_update_severity' );
+			}
+
+			if( !isset( $t_commands['UP_STATUS'] ) &&
+				access_has_project_level( config_get( 'update_bug_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_STATUS'] = lang_get( 'actiongroup_menu_update_status' );
+			}
+
+			if( !isset( $t_commands['UP_CATEGORY'] ) &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['UP_CATEGORY'] = lang_get( 'actiongroup_menu_update_category' );
+			}
+
+			if( !isset( $t_commands['VIEW_STATUS'] ) &&
+				access_has_project_level( config_get( 'change_view_status_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['VIEW_STATUS'] = lang_get( 'actiongroup_menu_update_view_status' );
+			}
+
+			if( !isset( $t_commands['EXT_UPDATE_PRODUCT_BUILD'] ) &&
+				config_get( 'enable_product_build', null, null, $t_project_id ) == ON &&
+				access_has_project_level( config_get( 'update_bug_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_UPDATE_PRODUCT_BUILD'] = lang_get( 'actiongroup_menu_update_product_build' );
+			}
+
+			if( !isset( $t_commands['EXT_ADD_NOTE'] ) &&
+				access_has_project_level( config_get( 'add_bugnote_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_ADD_NOTE'] = lang_get( 'actiongroup_menu_add_note' );
+			}
+
+			if( !isset( $t_commands['EXT_ATTACH_TAGS'] ) &&
+				access_has_project_level( config_get( 'tag_attach_threshold', null, null, $t_project_id ), $t_project_id ) ) {
+				$t_commands['EXT_ATTACH_TAGS'] = lang_get( 'actiongroup_menu_attach_tags' );
+			}
+		
+		}
 		$t_custom_field_ids = custom_field_get_linked_ids( $t_project_id );
 		foreach( $t_custom_field_ids as $t_custom_field_id ) {
 			if( !custom_field_has_write_access_to_project( $t_custom_field_id, $t_project_id ) ) {
 				continue;
 			}
diff -rNU5 mantisbt/core/category_api.php mantisbt-2.0.0/core/category_api.php
--- mantisbt/core/category_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/category_api.php	2017-02-03 11:14:16.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage CategoryAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses config_api.php
  * @uses constant_inc.php
  * @uses database_api.php
@@ -144,13 +145,13 @@
 function category_add( $p_project_id, $p_name ) {
 	if( is_blank( $p_name ) ) {
 		error_parameters( lang_get( 'category' ) );
 		trigger_error( ERROR_EMPTY_FIELD, ERROR );
 	}
-
+	
 	category_ensure_unique( $p_project_id, $p_name );
-
+	
 	db_param_push();
 	$t_query = 'INSERT INTO {category} ( project_id, name )
 				  VALUES ( ' . db_param() . ', ' . db_param() . ' )';
 	db_query( $t_query, array( $p_project_id, $p_name ) );
 
@@ -569,11 +570,16 @@
  * @param boolean $p_trigger_errors Whether to trigger error on failure.
  * @return boolean
  * @access public
  */
 function category_get_id_by_name( $p_category_name, $p_project_id, $p_trigger_errors = true ) {
-	$t_project_name = project_get_name( $p_project_id );
+	if ( -1 != $p_project_id ) {
+		$t_project_name = project_get_name( $p_project_id );
+	}
+	else {
+		$t_project_name = '';
+	}
 
 	db_param_push();
 	$t_query = 'SELECT id FROM {category} WHERE name=' . db_param() . ' AND project_id=' . db_param();
 	$t_result = db_query( $t_query, array( $p_category_name, (int)$p_project_id ) );
 	$t_id = db_result( $t_result );
@@ -611,15 +617,66 @@
 
 		if( $p_show_project && $t_project_id != $t_current_project ) {
 			return '[' . project_get_name( $t_project_id ) . '] ' . $t_row['name'];
 		}
 
+		if ( lang_exists( $t_row['name'], lang_get_current() ) ) {
+			return lang_get( $t_row['name'] );	
+		}
+		else {		
+			return $t_row['name'];
+		}
+	}
+}
+
+/**
+ * Retrieves risk criteria category name
+ * @param string $p_category_id category id
+ * @return string category full name
+ * @access public 
+ */
+function category_risk_criteria_full_name( $p_category_id ) {
+	if( 0 == $p_category_id ) {
+		# No Category
+		return lang_get( 'no_category' );
+	} 
+	else {
+		$t_row = category_get_row( $p_category_id );
+	}
+	if ( lang_exists( $t_row['name'], lang_get_current() ) ) {
+		return lang_get( $t_row['name'] );	
+	}
+	else {		
 		return $t_row['name'];
 	}
 }
 
 /**
+ * Get all category from risk criteria
+ * @return array categories
+ * @access public 
+ */
+function category_risk_criteria_get_all() {
+
+	$t_query = "SELECT c.* FROM {category} AS c
+				WHERE project_id= '-1'
+				ORDER BY c.name ";
+
+	$t_result = db_query( $t_query );
+	$count = db_num_rows( $t_result );
+	$rows = array();
+
+	$rows = array();
+	for( $i = 0;$i < $count;$i++ ) {
+		$row = db_fetch_array( $t_result );
+		$rows[] = $row;
+		$g_category_cache[(int) $row['id']] = $row;
+	}
+	return $rows;
+}
+
+/**
  * Check category can be deleted 
  * @param string $p_category_id Category identifier.
  * @return boolean Return true if the category valid for delete, otherwise false
  * @access public
  */
diff -rNU5 mantisbt/core/constant_inc.php mantisbt-2.0.0/core/constant_inc.php
--- mantisbt/core/constant_inc.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/constant_inc.php	2017-02-03 11:14:05.000000000 +0100
@@ -13,11 +13,11 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.
 /**
  * MantisBT Constants
- *
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  */
 
 /**
  * Mantis Version
  */
@@ -146,10 +146,11 @@
 define( 'CRYPT_FULL_SALT', 2 );
 define( 'MD5', 3 );
 define( 'LDAP', 4 );
 define( 'BASIC_AUTH', 5 );
 define( 'HTTP_AUTH', 6 );
+define( 'CAS_AUTH', 7);
 
 # file upload methods
 define( 'DISK', 1 );
 define( 'DATABASE', 2 );
 
@@ -429,10 +430,28 @@
 define( 'ERROR_CRYPTO_CAN_NOT_GENERATE_STRONG_RANDOMNESS', 2901 );
 
 # ERROR_API_TOKEN_*
 define( 'ERROR_API_TOKEN_NAME_NOT_UNIQUE', 3000 );
 
+# ERROR_STATUS_*
+define( 'ERROR_STATUS_DUPLICATE_LABEL', 5000 );
+define( 'ERROR_STATUS_DUPLICATE_NAME_FRENCH', 5001 );
+define( 'ERROR_STATUS_DUPLICATE_NAME_ENGLISH', 5002 );
+define( 'ERROR_STATUS_INVALID_COLOR', 5003 );
+define( 'ERROR_STATUS_INVALID_LABEL', 5004 );
+define( 'ERROR_STATUS_OTHER_LANGUAGE_EMAIL', 5005 );
+define( 'ERROR_STATUS_CLASSIFICATION_NUMBER', 5006 );
+define( 'ERROR_STATUS_CLASSIFICATION_NUMBER_BORNS', 5007 );
+define( 'ERROR_STATUS_DELETE_WHEN_USE', 5008 );
+define( 'ERROR_STATUS_LANGUAGE', 5009 );
+
+# ERROR_RISKS_*
+define( 'ERROR_RISK_CRITERIA_DUPLICATE_LABEL', 5100 );
+define( 'ERROR_RISK_CRITERIA_WEIGHT_INVALID', 5101 );
+define( 'ERROR_RISK_CRITERIA_SUM_WEIGHT_INVALID', 5102 );
+define( 'ERROR_RISK_CRITERIA_LABEL', 5103 );
+
 # Generic position constants
 define( 'POSITION_NONE', 0 );
 define( 'POSITION_TOP', 1 );
 define( 'POSITION_BOTTOM', 2 );
 define( 'POSITION_BOTH', 3 ); # POSITION_TOP | POSITION_BOTTOM (bitwise OR)
@@ -639,5 +658,15 @@
 # Note: mantis ids are defined in schema as "I UNSIGNED", which Adodb maps to
 # the closest integer (4 bytes) type available. As some DBs dont support unsigned
 # types, 2^31 is a safe limit to be used for all.
 define( 'DB_MAX_INT', 2147483647 );
 
+
+# ARDE management 
+//ard is a boolean which is true if the mantis is in ard mode
+define('ARD', true);
+define( 'MANAGEMENT', 'management' );
+define( 'RISK', 'risk' );
+define( 'ACTION', 'action' );
+define( 'DECISION', 'decision' );
+define( 'EVOLUTION', 'evolution' );
+
diff -rNU5 mantisbt/core/custom_field_api.php mantisbt-2.0.0/core/custom_field_api.php
--- mantisbt/core/custom_field_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/custom_field_api.php	2017-02-03 11:10:57.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage CustomFieldAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses bug_api.php
@@ -727,11 +728,11 @@
 	$t_result = db_query( $t_query, array( $p_field_name ) );
 
 	$t_row = db_fetch_array( $t_result );
 
 	if( !$t_row ) {
-		$g_cache_name_to_id_map[$p_field_name] = false;
+		//$g_cache_name_to_id_map[$p_field_name] = false;
 		return false;
 	}
 
 	$g_cache_name_to_id_map[$p_field_name] = $t_row['id'];
 
diff -rNU5 mantisbt/core/custom_function_api.php mantisbt-2.0.0/core/custom_function_api.php
--- mantisbt/core/custom_function_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/custom_function_api.php	2017-02-03 11:12:19.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage CustomFunctionAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses bug_api.php
  * @uses bugnote_api.php
  * @uses category_api.php
@@ -302,11 +303,11 @@
 	if( $p_columns_target == COLUMNS_TARGET_CSV_PAGE ) {
 		$t_columns = config_get( 'csv_columns', '', $p_user_id, $t_project_id );
 	} else if( $p_columns_target == COLUMNS_TARGET_EXCEL_PAGE ) {
 		$t_columns = config_get( 'excel_columns', '', $p_user_id, $t_project_id );
 	} else if( $p_columns_target == COLUMNS_TARGET_VIEW_PAGE ) {
-		$t_columns = config_get( 'view_issues_page_columns', '', $p_user_id, $t_project_id );
+		$t_columns = config_get( 'view_issues_page_columns_'.project_get_type_management(), '', $p_user_id, $t_project_id );
 	} else {
 		$t_columns = config_get( 'print_issues_page_columns', '', $p_user_id, $t_project_id );
 	}
 
 	$t_columns = columns_remove_invalid( $t_columns, columns_get_all( $t_project_id ) );
diff -rNU5 mantisbt/core/helper_api.php mantisbt-2.0.0/core/helper_api.php
--- mantisbt/core/helper_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/helper_api.php	2017-02-03 11:14:26.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage HelperAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses config_api.php
@@ -154,21 +155,50 @@
 
 	return $t_status_count_array;
 }
 
 /**
+ * Given a enum string and string, return the appropriate id
+ * @param string $p_enum_name
+ * @param string $p_val
+ * @return int, the id otherwise null
+ * 
+ */
+function get_enum_id( $p_enum_name, $p_val, $p_by_french_or_english = false ) {
+	$config_var = MantisEnum::getAssocArrayIndexedByValues( config_get( $p_enum_name.'_enum_string' ) );
+	$key = null;
+	if ( in_array($p_val, $config_var) ) {
+		$key = array_search($p_val, $config_var);
+	}
+	return $key;
+}
+
+
+/**
  * Given a enumeration string and number, return the appropriate string for the
  * specified user/project
  * @param string       $p_enum_name An enumeration string name.
  * @param integer      $p_val       An enumeration string value.
  * @param integer|null $p_user      A user identifier, defaults to null (all users).
  * @param integer|null $p_project   A project identifier, defaults to null (all projects).
  * @return string
  */
-function get_enum_element( $p_enum_name, $p_val, $p_user = null, $p_project = null ) {
+function get_enum_element( $p_enum_name, $p_val, $p_user = null, $p_project = null, $p_by_french_or_english = false ) {
 	$t_config_var = config_get( $p_enum_name . '_enum_string', null, $p_user, $p_project );
-	$t_string_var = lang_get( $p_enum_name . '_enum_string' );
+			
+	if ( $p_by_french_or_english ) {
+		if ( 'french' == user_pref_get( auth_get_current_user_id() )->language ) {
+			$t_user_language = 'french';
+		}
+		else {
+			$t_user_language = 'english';			
+		}
+		$t_string_var = lang_get( $p_enum_name . '_enum_string_' . $t_user_language );
+	}
+	else {
+		$t_string_var = lang_get( $p_enum_name . '_enum_string' );		
+	}
 
 	return MantisEnum::getLocalizedLabel( $t_config_var, $t_string_var, $p_val );
 }
 
 /**
diff -rNU5 mantisbt/core/html_api.php mantisbt-2.0.0/core/html_api.php
--- mantisbt/core/html_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/html_api.php	2017-02-03 11:12:37.000000000 +0100
@@ -22,10 +22,11 @@
  *
  * @package CoreAPI
  * @subpackage HTMLAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses bug_api.php
@@ -493,11 +494,11 @@
  * @return void
  */
 function print_project_menu_bar() {
 	$t_project_ids = current_user_get_accessible_projects();
 	$t_current_project_id = helper_get_current_project();
-
+	
 	echo '<div class="col-md-12 col-xs-12">' . "\n";
 	echo '<div class="btn-group">' . "\n";
 
 	$t_active = ALL_PROJECTS == $t_current_project_id ? 'active' : '';
 	echo '<a class="btn btn-xs btn-white btn-info ' . $t_active .
@@ -671,10 +672,17 @@
 
 	if( config_get( 'relationship_graph_enable' ) ) {
 		$t_pages['manage_config_workflow_graph_page.php'] = array( 'url'   => 'manage_config_workflow_graph_page.php',
 		                                                           'label' => 'manage_workflow_graph' );
 	}
+	
+	$mantis_project_id = helper_get_current_project();			
+	if (file_exists( dirname( dirname( __FILE__ ) ).DIRECTORY_SEPARATOR.'conf-instance'.DIRECTORY_SEPARATOR.'config_status_'.$mantis_project_id.'.php' ) )	
+	{
+		$t_pages['manage_config_status_page.php'] = array( 'url'   => 'manage_config_status_page.php',
+	                                                       'label' => 'manage_status_config' );
+	}
 
 	if( config_get( 'enable_email_notification' ) == ON ) {
 		$t_pages['manage_config_email_page.php'] = array( 'url'   => 'manage_config_email_page.php',
 		                                                  'label' => 'manage_email_config' );
 	}
@@ -863,11 +871,60 @@
 		echo '<li>' . $t_menu_item . '</li>';
 	}
 
 	echo '</ul>' . "\n";
 }
+function print_prism_menu ( $p_page = '' ) {
+    $t_pages = array();
+	$t_pages['manage_overview_page.php'] = array( 'url'   => 'manage_overview_page.php', 'label' => '' );
+    $t_pages['reporting_prism_page.php'] = array( 'url'=>'reporting_prism_page.php', 'label'=>'reporting_prism_link' );
+	$t_pages['risk_criteria_page.php'] = array( 'url'=>'risk_criteria_page.php', 'label'=>'risk_criteria_configuration_link' );
+	$t_pages['risk_appreciation_page.php'] = array( 'url'=>'risk_appreciation_page.php', 'label'=>'risk_appreciation_link' );
+	
+	# Remove the link from the current page
+	if( isset( $t_pages[$p_page] ) ) {
+		$t_pages[$p_page]['url'] = '';
+	}
+	
+	echo '<ul class="nav nav-tabs padding-18">' . "\n";
+	foreach ( $t_pages as $t_page ) {
+		$t_active =  $t_page['url'] == $p_page ? 'active' : '';
+		echo '<li class="' . $t_active .  '">' . "\n";
+		
+		if( $t_page['label'] == '' ) {	
+			echo '<a href="'. lang_get_defaulted( $t_page['url'] ) .'"><i class="blue ace-icon fa fa-info-circle"></i> </a>';
+			
+		} else {
+			echo '<a href="'. helper_mantis_url( $t_page['url'] ) .'">' . lang_get_defaulted( $t_page['label'] ) . '</a>';
+		}
+		echo '</li>' . "\n";
+	}
+	echo '</ul>' . "\n";
+}
+
+function print_risk_criteria_menu ( $p_page = '' ) {
+    $t_pages = array();
+
+    $t_pages['risk_criteria_page.php'] = array( 'url'=>'risk_criteria_page.php', 'label'=>'view_all_risk_criteria_link' );
+	$t_pages['risk_criteria_view.php'] = array( 'url'=>'risk_criteria_view.php', 'label'=>'add_risk_criteria_link' );
+		
+	echo '<div class="space-10"></div>' . "\n";
+	echo '<div class="center">' . "\n";
+	echo '<div class="btn-toolbar inline">' . "\n";
+	echo '<div class="btn-group">' . "\n";
+	
+	foreach ( $t_pages as $t_page ) {
+		$t_active =  $t_page['url'] == $p_page ? 'active' : '';
+		echo '<a class="btn btn-sm btn-white btn-primary ' . $t_active . '" href="'. helper_mantis_url( $t_page['url'] ) .'">' . "\n";
+		echo lang_get_defaulted( $t_page['label'] );
+		echo '</a>' . "\n";
+	}
 
+	echo '</div>' . "\n";
+	echo '</div>' . "\n";
+	echo '</div>' . "\n";
+}
 /**
  * Print the admin tab bar
  * @param string $p_page Specifies the current page name so it set to active.
  * @return void
  */
@@ -1225,17 +1282,112 @@
 		}
 	}
 }
 
 /**
+ * Print a button to create a new $p_project_name report
+ * @param int $p_bug_id
+ * @param String $p_project_name
+ */
+function html_button_relationship_create( $p_bug_id, $p_direction_project_type) {
+	$t_project_id = project_get_other_type_project_id($p_direction_project_type);
+	if ( 0 != $t_project_id) {
+		html_button( 'bug_report_page.php', lang_get('create_'.$p_direction_project_type), array( 'project_id' => $t_project_id, 'relationship_id' => $p_bug_id), 'get' );
+	}
+}
+
+/**
+ * Print a button to associate a list of $p_project_name report
+ * @param int $p_bug_id
+ * @param String $p_project_name
+ */
+function html_button_relationship_associates( $p_bug_id, $p_direction_project_type ) {
+	$t_project_id = project_get_other_type_project_id($p_direction_project_type);
+	if ( 0 != $t_project_id) {
+		html_button( 'view_all_bug_page.php', lang_get('associate_'.$p_direction_project_type.'s'), array( 'project_id' => $t_project_id, 'relationship_id' => $p_bug_id), 'get' );	
+	}
+}
+
+/**
+ * Print a button to associate one of $p_project_name report thanks to a listbox
+ * @param int $p_bug_id
+ * @param String $p_project_name
+ */
+function html_button_relationship_associate( $p_bug_id, $p_project_name ) {
+	$f_page_number = 1;
+	$t_per_page = null;
+	$t_page_count = null;
+	$t_bug_count=  null;
+	$t_show_project = false;
+	$t_current_project_id = helper_get_current_project();
+	
+	//TODO have to use workflow of the $p_project_name
+	$t_new = get_enum_id('status', 'new');	
+	$t_progress = get_enum_id('status', 'progress');
+	$t_closed = get_enum_id('status', 'closed');
+	
+	$t_project_id = project_get_other_type_project_id($p_project_name);
+	$t_relationship_all = relationship_get_all( $p_bug_id, $t_show_project );	
+	$t_bugs = filter_get_bug_rows( $f_page_number, $t_per_page, $t_page_count, $t_bug_count, null, $t_project_id, null, true );
+	
+   	$t_relationships_id = array();
+	foreach ( $t_relationship_all as $t_relationship ) {
+		if ( $t_relationship->dest_bug_id != $p_bug_id ) {
+			array_push($t_relationships_id, $t_relationship->dest_bug_id);
+		}
+//   		TODO dest or src?
+	}
+	
+	#remove from bugs array : 
+	# - already existing relationships 
+	# - new bugs
+	# - closed bugs
+	foreach ( $t_bugs as $key => $bug ) {
+//       	if ( $t_new >= $bug->status || $t_closed <= $bug->status || in_array($bug->id, $t_relationships_id) ) {
+       	if ( $t_progress != $bug->status || in_array($bug->id, $t_relationships_id) ) {
+			unset($t_bugs[$key]);
+		}
+	}
+
+	#display select
+	if( count( $t_bugs ) > 0 ) {
+
+		echo "<form method=\"post\" action=\"bug_associate.php\">";
+		# CSRF protection not required here - form does not result in modifications
+
+		$t_button_text = lang_get( 'associate_'.$p_project_name );
+		echo "<input type=\"submit\" class=\"button\" value=\"$t_button_text\" />";
+
+		echo " <select name=\"associate_bug_id\">";
+
+		# space at beginning of line is important
+		foreach( $t_bugs as $bug ) {
+			echo "<option value=\"$bug->id\" ";
+			echo ">[$bug->id] $bug->summary</option>";
+		}
+		echo '</select>';
+
+		$t_bug_id = string_attribute( $p_bug_id );
+		echo "<input type=\"hidden\" name=\"bug_id\" value=\"$t_bug_id\" />\n";
+
+		echo "</form>\n";
+	}
+}
+
+/**
  * Print all buttons for view bug pages
  * @param integer $p_bug_id A valid bug identifier.
  * @return void
  */
 function html_buttons_view_bug_page( $p_bug_id ) {
 	$t_readonly = bug_is_readonly( $p_bug_id );
 	$t_sticky = config_get( 'set_bug_sticky_threshold' );
+	$t_new = get_enum_id('status', 'new');	
+	$t_progress = get_enum_id('status', 'progress');
+	$t_closed = get_enum_id('status', 'closed');
+	$t_status = bug_get_field( $p_bug_id, 'status' );
+
 
 	$t_bug = bug_get( $p_bug_id );
 
 	echo '<div class="btn-group">';
 	if( !$t_readonly ) {
@@ -1252,10 +1404,46 @@
 		# Change status button/dropdown
 		echo '<div class="pull-left padding-right-8">';
 		html_button_bug_change_status( $t_bug );
 		echo '</div>';
 	}
+	
+		# Action creation and association button (when risk project)
+	if ( 1 == preg_match('/risk/i', project_get_type_management() ) ) {
+		if ( $t_progress <= $t_status && $t_closed > $t_status) {
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_create( $p_bug_id, 'action' );
+			echo '</div>';
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_associates( $p_bug_id, 'action' );
+			echo '</div>';
+		}
+	}
+	
+	# Decision creation and association button, and risk association (when action project)
+	if ( 1 == preg_match('/action/i', project_get_type_management() ) ) {
+		if ( $t_progress <= $t_status && $t_closed > $t_status) {
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_associate( $p_bug_id, 'risk');
+			echo '</div>';
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_create( $p_bug_id, 'decision' );
+			echo '</div>';
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_associates( $p_bug_id, 'decision' );
+			echo '</div>';
+		}
+	}
+	
+	# Action association (when decision project)
+	if ( 1 == preg_match('/decision/i', project_get_type_management() ) ) {
+		if ( $t_progress <= $t_status && $t_closed > $t_status) {
+			echo '<div class="pull-left padding-right-8">';
+			html_button_relationship_associate( $p_bug_id, 'action');
+			echo '</div>';
+		}
+	}
 
 	# MONITOR/UNMONITOR button
 	if( !current_user_is_anonymous() ) {
 		echo '<div class="pull-left padding-right-2">';
 		if( user_is_monitoring_bug( auth_get_current_user_id(), $p_bug_id ) ) {
@@ -1297,14 +1485,21 @@
 	# MOVE button
 	echo '<div class="pull-left padding-right-2">';
 	html_button_bug_move( $p_bug_id );
 	echo '</div>';
 
-	# DELETE button
-	echo '<div class="pull-left padding-right-2">';
-	html_button_bug_delete( $p_bug_id );
-	echo '</div>';
+	# DELETE button	
+	if( ('risk' == project_get_type_management() ||
+		'action' == project_get_type_management()||
+		'decision' == project_get_type_management()||
+		'evolution' == project_get_type_management()) 
+		&& $t_new >= $t_status ) {	
+		echo '<div class="pull-left padding-right-2">';
+		html_button_bug_delete( $p_bug_id );
+		echo '</div>';
+	}
+	
 
 	helper_call_custom_function( 'print_bug_view_page_custom_buttons', array( $p_bug_id ) );
 
 	echo '</div>';
 }
diff -rNU5 mantisbt/core/http_api.php mantisbt-2.0.0/core/http_api.php
--- mantisbt/core/http_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/http_api.php	2017-02-03 11:13:27.000000000 +0100
@@ -20,10 +20,12 @@
  * Provides functions to manage HTTP response headers.
  *
  * @package CoreAPI
  * @subpackage HTTPAPI
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses config_api.php
  */
 
@@ -38,11 +40,16 @@
 /**
  * Checks to see if script was queried through the HTTPS protocol
  * @return boolean True if protocol is HTTPS
  */
 function http_is_protocol_https() {
-	return !empty( $_SERVER['HTTPS'] ) && ( utf8_strtolower( $_SERVER['HTTPS'] ) != 'off' );
+	if ( !empty( $_SERVER['HTTP_X_FORWARDED_PROTO'] ) ) {
+		$t_protocol= $_SERVER['HTTP_X_FORWARDED_PROTO'];
+	} else if ( !empty( $_SERVER['HTTPS'] ) ) {
+		$t_protocol = $_SERVER['HTTPS'];
+	}
+	return isset( $t_protocol ) && !empty( $t_protocol ) && ( utf8_strtolower( $t_protocol ) != 'off' );
 }
 
 /**
  * Check to see if the client is using Microsoft Internet Explorer so we can
  * enable quirks and hacky non-standards-compliant workarounds.
@@ -206,18 +213,18 @@
  * Set security headers (frame busting, clickjacking/XSS/CSRF protection).
  * @return void
  */
 function http_security_headers() {
 	if( !headers_sent() ) {
-		header( 'X-Frame-Options: DENY' );
-
+		// Needed by mantis is shown inside an iFrame
+		#header( 'X-Frame-Options: DENY' );
 		# Define Content Security Policy
-		http_csp_add( 'default-src', "'self'" );
-		http_csp_add( 'frame-ancestors', "'none'" );
+		#http_csp_add( 'default-src', "'self'" );
+		#http_csp_add( 'frame-ancestors', "'none'" );
 		http_csp_add( 'style-src', "'self'" );
 		http_csp_add( 'style-src', "'unsafe-inline'" );
-		http_csp_add( 'script-src', "'self'" );
+		#http_csp_add( 'script-src', "'self'" );
 		http_csp_add( 'img-src', "'self'" );
 
 		# White list the CDN urls (if enabled)
 		if ( config_get_global( 'cdn_enabled' ) == ON ) {
 			http_csp_add( 'style-src', 'ajax.googleapis.com' );
diff -rNU5 mantisbt/core/lang_api.php mantisbt-2.0.0/core/lang_api.php
--- mantisbt/core/lang_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/lang_api.php	2017-02-03 11:12:47.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage LanguageAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses authentication_api.php
  * @uses config_api.php
  * @uses constant_inc.php
@@ -53,12 +54,12 @@
  * @param string $p_lang Name of Language to load.
  * @param string $p_dir  Directory Containing language file.
  * @return void
  */
 function lang_load( $p_lang, $p_dir = null ) {
-	global $g_lang_strings, $g_active_language;
-
+	global $g_lang_strings, $g_active_language, $t_instance_inc_found;
+	
 	$g_active_language = $p_lang;
 	if( isset( $g_lang_strings[$p_lang] ) && is_null( $p_dir ) ) {
 		return;
 	}
 
@@ -71,10 +72,16 @@
 	} else {
 		if( is_file( $p_dir . 'strings_' . $p_lang . '.txt' ) ) {
 			include_once( $p_dir . 'strings_' . $p_lang . '.txt' );
 		}
 	}
+	
+	if ($t_instance_inc_found)
+	{
+		$instance=session_get('project_id');
+		require( dirname( dirname( __FILE__ ) ).DIRECTORY_SEPARATOR.'conf-instance'.DIRECTORY_SEPARATOR.'config_status_'.$instance.'.php' );	
+	}
 
 	# Allow overriding strings declared in the language file.
 	# custom_strings_inc.php can use $g_active_language.
 	# Include file multiple times to allow for overrides per language.
 	global $g_config_path;
@@ -286,13 +293,20 @@
 	#  because we don't have a concept of falling back on a language.  The
 	#  language files actually *contain* English strings if none has been
 	#  defined in the correct language
 	# @todo thraxisp - not sure if this is still true. Strings from last language loaded
 	#      may still be in memeory if a new language is loaded.
-
-	if( lang_exists( $p_string, $t_lang ) ) {
-		return $g_lang_strings[$t_lang][$p_string];
+	
+		
+	if( lang_exists( $p_string."_".$t_lang, $t_lang ) ) 
+	{		
+		return replace_issue_word($g_lang_strings[$t_lang][$p_string."_".$t_lang]);		
+	}
+	else if( lang_exists( $p_string, $t_lang ) ) 
+	{
+		return replace_issue_word($g_lang_strings[$t_lang][$p_string]);
+		
 	} else {
 		$t_plugin_current = plugin_get_current();
 		if( !is_null( $t_plugin_current ) ) {
 			lang_load( $t_lang, config_get( 'plugin_path' ) . $t_plugin_current . DIRECTORY_SEPARATOR . 'lang' . DIRECTORY_SEPARATOR );
 			if( lang_exists( $p_string, $t_lang ) ) {
@@ -368,5 +382,32 @@
 	$t_entry = array_search( $t_lang, $t_auto_map );
 	$t_key_arr = explode( ',', $t_entry );
 
 	return $t_key_arr[0];
 }
+
+function replace_issue_word($p_string) {
+	$ret = $p_string;
+	if ( auth_is_user_authenticated() ) {
+		$project_type = project_get_type_management();		
+		if ( false != $project_type ) {
+			$patterns = array('Saisir les détails du problème', 'Nouveau bogue', 'un nouveau bogue', 'Historique du bogue','de bogue', 'du bogue', 'le bogue soumis', 'le bogue', 'ce bogue','Ce bogue', 'un bogue', 'bogue', 'Bogue', 'issue', 'Issue');
+			if ( 'risk' == $project_type ) {
+				$replacements = array('Saisir les détails du risque', 'Nouveau risque', 'un nouveau risque','Historique du risque','de risque', 'de risque', 'le risque soumis', 'le risque', 'ce risque','Ce risque', 'un risque', 'risque', 'Risque', 'risk', 'Risk');
+				$ret =  str_replace($patterns, $replacements, $p_string);
+			}
+			elseif ( 'action' == $project_type ) {
+				$replacements = array('Saisir les détails de l\'action', 'Nouvelle action', 'une nouvelle action','Historique de l\'action', 'd\'action', 'd\'action','l\'action soumise', 'l\'action', 'cette action','Cette action', 'une action', 'action', 'Action', 'action', 'Action');
+				$ret = str_replace($patterns, $replacements, $p_string);
+			}
+			elseif ( 'decision' == $project_type ) {
+				$replacements = array('Saisir les détails de la décision', 'Nouvelle décision', 'une nouvelle décision','Historique de la décision', 'de décision', 'de décision', 'la décision soumise', 'la décision', 'cette décision','Cette décision', 'une décision', 'décision', 'Décision', 'decision', 'Decision');
+				$ret = str_replace($patterns, $replacements, $p_string);
+			}
+			elseif ( 'evolution' == $project_type ) {
+				$replacements = array('Saisir les détails de l\'évolution', 'Nouvelle évolution', 'une nouvelle évolution','Historique de l\'évolution', 'd\'évolution', 'd\'évolution', 'l\'évolution soumise', 'l\'évolution', 'cette évolution', 'Cette évolution','une évolution', 'évolution', 'Evolution', 'evolution', 'Evolution');
+				$ret = str_replace($patterns, $replacements, $p_string);
+			}
+		}
+	}
+	return $ret;
+}
diff -rNU5 mantisbt/core/layout_api.php mantisbt-2.0.0/core/layout_api.php
--- mantisbt/core/layout_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/layout_api.php	2017-05-29 09:50:37.000000000 +0200
@@ -32,10 +32,11 @@
  *
  *
  * @package CoreAPI
  * @subpackage LayoutAPI
  * @copyright Copyright 2014 MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses utility_api.php
  */
@@ -406,10 +407,14 @@
 	echo '<span class="icon-bar"></span>';
 	echo '</button>';
 
 	echo '<div class="navbar-header">';
 	echo '<a href="' . $t_logo_url . '" class="navbar-brand">';
+	//Novaforge : logo Mantis ARD
+	echo '<span class="smaller-75"> ';
+	echo '<img src="' . helper_mantis_url( 'images/mantisard_logo.png' ) . '"   width="25px" height="25px" />';
+	echo '</span>';
 	echo '<span class="smaller-75"> ';
 	echo config_get('window_title');
 	echo ' </span>';
 	echo '</a>';
 
@@ -491,13 +496,13 @@
 	if( OFF != config_get( 'rss_enabled' ) ) {
 		layout_navbar_menu_item( htmlspecialchars( rss_get_issues_feed_url() ), lang_get( 'rss' ), 'fa-rss-square orange' );
 	}
 
 	echo '<li class="divider"></li>';
-
+    # Commented because logout can not be accessible in the forge
 	# Logout
-	layout_navbar_menu_item( helper_mantis_url( 'logout_page.php' ), lang_get( 'logout_link' ), 'fa-sign-out' );
+	//layout_navbar_menu_item( helper_mantis_url( 'logout_page.php' ), lang_get( 'logout_link' ), 'fa-sign-out' );
 	echo '</ul>';
 	echo '</li>';
 }
 
 
@@ -721,40 +726,48 @@
 		layout_sidebar_begin();
 
 		# Plugin / Event added options
 		$t_event_menu_options = event_signal( 'EVENT_MENU_MAIN_FRONT' );
 		layout_plugin_menu_options_for_sidebar( $t_event_menu_options, $p_active_sidebar_page );
-
+		/*
+		 * Home commented because of losing context project
 		# Main Page
 		if( config_get( 'news_enabled' ) == ON ) {
 			layout_sidebar_menu( 'main_page.php', 'main_link', 'fa-bullhorn', $p_active_sidebar_page  );
 		}
-
-		# My View
-		layout_sidebar_menu( 'my_view_page.php', 'my_view_link', 'fa-dashboard', $p_active_sidebar_page );
-
-		# View Bugs
-		layout_sidebar_menu( 'view_all_bug_page.php', 'view_bugs_link', 'fa-list-alt', $p_active_sidebar_page );
-
-		# Report Bugs
-		if( access_has_any_project_level( 'report_bug_threshold' ) ) {
-			$t_bug_url = string_get_bug_report_url();
-			layout_sidebar_menu( $t_bug_url, 'report_bug_link', 'fa-edit', $p_active_sidebar_page );
+		*/
+		if ( 0 != helper_get_current_project() && 1 != preg_match('/management/i', project_get_type_management())) {
+			# My View
+			layout_sidebar_menu( 'my_view_page.php', 'my_view_link', 'fa-dashboard', $p_active_sidebar_page );
+
+			# View Bugs
+			layout_sidebar_menu( 'view_all_bug_page.php', 'view_bugs_link', 'fa-list-alt', $p_active_sidebar_page );
+
+			# Report Bugs
+			if( access_has_any_project_level( 'report_bug_threshold' ) ) {
+				$t_bug_url = string_get_bug_report_url();
+				layout_sidebar_menu( $t_bug_url, 'report_bug_link', 'fa-edit', $p_active_sidebar_page );
+			}
+		}
+		if ( 0 != helper_get_current_project()){
+			# PRISM
+			layout_sidebar_menu( 'risk_criteria_page.php', 'prism_link', 'fa-cube', $p_active_sidebar_page );
 		}
-
 		# Changelog Page
-		if( access_has_project_level( config_get( 'view_changelog_threshold' ) ) ) {
+		if( access_has_project_level( config_get( 'view_changelog_threshold' ) ) &&
+		( ON == config_get( 'changelog_enable' ) ) ) {
 			layout_sidebar_menu( 'changelog_page.php', 'changelog_link', 'fa-retweet', $p_active_sidebar_page );
 		}
 
 		# Roadmap Page
-		if( access_has_project_level( config_get( 'roadmap_view_threshold' ) ) ) {
+		if( access_has_project_level( config_get( 'roadmap_view_threshold' ) )  &&
+		( ON == config_get( 'roadmap_enable' ) ) ) {
 			layout_sidebar_menu( 'roadmap_page.php', 'roadmap_link', 'fa-road', $p_active_sidebar_page );
 		}
 
 		# Summary Page
-		if( access_has_project_level( config_get( 'view_summary_threshold' ) ) ) {
+		if(  ON == config_get( 'enable_project_documentation' ) ) {
 			layout_sidebar_menu( 'summary_page.php', 'summary_link', 'fa-bar-chart-o', $p_active_sidebar_page );
 		}
 
 		# Project Documentation Page
 		if( ON == config_get( 'enable_project_documentation' ) ) {
diff -rNU5 mantisbt/core/print_api.php mantisbt-2.0.0/core/print_api.php
--- mantisbt/core/print_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/print_api.php	2017-05-24 15:57:10.000000000 +0200
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage PrintAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses bug_group_action_api.php
@@ -615,10 +616,12 @@
 function print_project_option_list( $p_project_id = null, $p_include_all_projects = true, $p_filter_project_id = null, $p_trace = false, $p_can_report_only = false ) {
 	$t_user_id = auth_get_current_user_id();
 	$t_project_ids = user_get_accessible_projects( $t_user_id );
 	$t_can_report = true;
 	project_cache_array_rows( $t_project_ids );
+	
+	$p_include_all_projects = false;
 
 	if( $p_include_all_projects && $p_filter_project_id !== ALL_PROJECTS ) {
 		echo '<option value="' . ALL_PROJECTS . '"';
 		if( $p_project_id !== null ) {
 			check_selected( $p_project_id, ALL_PROJECTS, false );
@@ -754,23 +757,34 @@
  *
  * @param integer $p_category_id A category identifier.
  * @param integer $p_project_id  A project identifier.
  * @return void
  */
-function print_category_option_list( $p_category_id = 0, $p_project_id = null ) {
+function print_category_option_list( $p_category_id = 0, $p_project_id = null, $p_inherit = null, $p_other = true ) {
+
+	$p_category_id = (int)$p_category_id;
+   
 	if( null === $p_project_id ) {
 		$t_project_id = helper_get_current_project();
 	} else {
 		$t_project_id = $p_project_id;
 	}
 
-	$t_cat_arr = category_get_all_rows( $t_project_id, null, true );
+	$t_cat_arr = category_get_all_rows( $t_project_id, $p_inherit, true );
+		
+	if ( !$p_other ) {
+		foreach ( $t_cat_arr as $key => $t_category_row ) {
+       		if ( 'others' == $t_category_row['name'] ) {
+				unset($t_cat_arr[$key]);
+			}
+		}
+	}
 
 	if( config_get( 'allow_no_category' ) ) {
 		echo '<option value="0"';
 		check_selected( $p_category_id, 0 );
-		echo '>';
+		echo '>';	
 		echo category_full_name( 0, false ), '</option>';
 	} else {
 		if( 0 == $p_category_id ) {
 			if( count( $t_cat_arr ) == 1 ) {
 				$p_category_id = (int) $t_cat_arr[0]['id'];
@@ -783,10 +797,11 @@
 		}
 	}
 
 	foreach( $t_cat_arr as $t_category_row ) {
 		$t_category_id = (int)$t_category_row['id'];
+								
 		echo '<option value="' . $t_category_id . '"';
 		check_selected( $p_category_id, $t_category_id );
 		echo '>' . string_attribute( category_full_name( $t_category_id, $t_category_row['project_id'] != $t_project_id ) ) . '</option>';
 	}
 }
@@ -962,11 +977,11 @@
  * Current value may be an integer, or an array of integers.
  * @param string  $p_enum_name Name of enumeration (eg: status).
  * @param integer|array $p_val	The current value(s)
  * @return void
  */
-function print_enum_string_option_list( $p_enum_name, $p_val = 0 ) {
+function print_enum_string_option_list( $p_enum_name, $p_val = 0, $p_by_french_or_english = false ) {
 	$t_config_var_name = $p_enum_name . '_enum_string';
 	$t_config_var_value = config_get( $t_config_var_name );
 
 	if( is_array( $p_val ) ) {
 		$t_val = $p_val;
@@ -975,11 +990,11 @@
 	}
 
 	$t_enum_values = MantisEnum::getValues( $t_config_var_value );
 
 	foreach ( $t_enum_values as $t_key ) {
-		$t_elem2 = get_enum_element( $p_enum_name, $t_key );
+		$t_elem2 = get_enum_element( $p_enum_name, $t_key, null, null, $p_by_french_or_english );
 
 		echo '<option value="' . $t_key . '"';
 		check_selected( $t_val, $t_key );
 		echo '>' . string_html_specialchars( $t_elem2 ) . '</option>';
 	}
@@ -1103,12 +1118,22 @@
 /**
  * Print option list of available language choices
  * @param string $p_language The current language.
  * @return void
  */
-function print_language_option_list( $p_language ) {
-	$t_arr = config_get( 'language_choices_arr' );
+function print_language_option_list( $p_language, $p_hidden_languages = null ) {
+	if ( $p_hidden_languages != null ) {
+		$t_arr_custom = array_diff(config_get( 'language_choices_arr' ), $p_hidden_languages);
+		$i=0;
+		foreach ( $t_arr_custom as $key => $value ) {
+       		$t_arr[$i] = $value;
+       		$i++;
+		}
+	}
+	else {
+		$t_arr = config_get( 'language_choices_arr' );
+	}
 	$t_enum_count = count( $t_arr );
 	for( $i = 0;$i < $t_enum_count;$i++ ) {
 		$t_language = string_attribute( $t_arr[$i] );
 		echo '<option value="' . $t_language . '"';
 		check_selected( $t_language, $p_language );
@@ -1120,12 +1145,12 @@
  * Print a dropdown list of all bug actions available to a user for a specified
  * set of projects.
  * @param array $p_project_ids An array containing one or more project IDs.
  * @return void
  */
-function print_all_bug_action_option_list( array $p_project_ids = null ) {
-	$t_commands = bug_group_action_get_commands( $p_project_ids );
+function print_all_bug_action_option_list( array $p_project_ids = null, $management_way = false ) {
+	$t_commands = bug_group_action_get_commands( $p_project_ids, $management_way);
 	while( list( $t_action_id, $t_action_label ) = each( $t_commands ) ) {
 		echo '<option value="' . $t_action_id . '">' . $t_action_label . '</option>';
 	}
 }
 
@@ -1819,10 +1844,14 @@
 /**
  * Prints the recently visited issues.
  * @return void
  */
 function print_recently_visited() {
+    if ( ARD ) {
+		return;
+	}
+	
 	$t_ids = last_visited_get_array();
 
 	if( count( $t_ids ) == 0 ) {
 		return;
 	}
@@ -1835,11 +1864,11 @@
 			echo ', ';
 		} else {
 			$t_first = false;
 		}
 
-		echo string_get_bug_view_link( $t_id );
+		echo string_get_bug_view_link( $t_id , null, true, false, true);
 	}
 	echo '</div>';
 }
 
 /**
diff -rNU5 mantisbt/core/project_api.php mantisbt-2.0.0/core/project_api.php
--- mantisbt/core/project_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/project_api.php	2017-02-03 11:12:08.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage ProjectAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses bug_api.php
  * @uses category_api.php
  * @uses config_api.php
@@ -496,10 +497,11 @@
 	db_param_push();
 	$t_query = 'SELECT id FROM {project} WHERE name = ' . db_param();
 	$t_result = db_query( $t_query, array( $p_project_name ), 1 );
 
 	$t_id = db_result( $t_result );
+	
 	if( $t_id ) {
 		return $t_id;
 	} else {
 		return 0;
 	}
@@ -892,5 +894,124 @@
  */
 function project_format_id( $p_project_id ) {
 	$t_padding = config_get( 'display_project_padding' );
 	return( utf8_str_pad( $p_project_id, $t_padding, '0', STR_PAD_LEFT ) );
 }
+
+/**
+ * Returns the type (action - risk - decision - evolution) of the current project
+ */
+function project_get_type_management($p_project_id = null) {
+	if (null == $p_project_id) {
+		$t_current_project_id = helper_get_current_project();
+	} 
+	else {
+		$t_current_project_id = $p_project_id;
+	}
+	$ret = false;
+	if (0 != $t_current_project_id) {
+		$t_current_project_name = project_get_name($t_current_project_id);
+		if ( !strpos($t_current_project_name, '_action') 
+		&& !strpos($t_current_project_name, '_decision') 
+		&& !strpos($t_current_project_name, '_risk') 
+		&& !strpos($t_current_project_name, '_evolution') ) {
+			$ret = "management";
+		}
+		else {
+			$token = explode('_', $t_current_project_name);
+			$ret = $token[count($token) - 1];			
+		}
+	}
+	return $ret;
+}
+
+/**
+ * Return the project id of the direction_type project when current project if not "all projects"
+ * if so, return "all projects"
+ */
+function project_get_other_type_project_id($p_direction_project_type, $p_project_id = null) {
+	//	get the project name
+	if (null == $p_project_id) {
+		$t_current_project_name = project_get_name(helper_get_current_project());
+	} else {
+		$t_current_project_name = project_get_name($p_project_id);
+	}
+	
+	//	if management, create an array, otherwise, explode the project name
+	if ( project_get_type_management($p_project_id) == "management" ) {
+		//$explode = explode('_'.$p_direction_project_type, $t_current_project_name);
+		$explode[0] = $t_current_project_name;
+		$explode[1] = "";
+	}
+	else {
+	     if (strpos($t_current_project_name, '_action')){ $explode = explode('_action', $t_current_project_name);}
+		 elseif (strpos($t_current_project_name, '_decision')) { $explode = explode('_decision', $t_current_project_name);}
+		 elseif (strpos($t_current_project_name, '_risk')) { $explode = explode('_risk', $t_current_project_name);}
+		 elseif (strpos($t_current_project_name, '_evolution')) { $explode = explode('_evolution', $t_current_project_name);}
+		$explode[1] = "";
+	}
+	//	create generic name
+	$generic_project_name = '';
+	for ($i = 0; $i < count($explode) - 1; $i++) {
+		$generic_project_name .= $explode[$i];
+	}
+	//	if wanted project not management, add the sufix
+	if ( $p_direction_project_type != "management" ) {
+		$generic_project_name .=  '_'.$p_direction_project_type;
+	}
+	
+	return (int) project_get_id_by_name($generic_project_name);
+}
+
+/**
+ * Create a configuration file for the given project
+ * @param int $p_projectid
+ */
+function instance_configuration_create($p_projectid) {
+	$file_path = dirname( dirname( __FILE__ ) ) . DIRECTORY_SEPARATOR . 'conf-instance';
+	$file_name = $file_path . DIRECTORY_SEPARATOR . 'config_status_' . $p_projectid . '.php';
+	if (!file_exists($file_path)) {
+		mkdir($file_path, 0777, TRUE);
+	}
+
+	if (!file_exists($file_name)) {
+		$handle = fopen($file_name, "x+");
+		$somecontent = "<?php\n" .
+		"/**\n" .
+		"* Custom Configuration Variables for project : " . project_get_name($p_projectid) . "\n" .
+		"*/\n\n";
+		$somecontent .= "/**\n" .
+		"* Project ID\n" .
+		"*/\n" .
+		'$g_project_id = ' . $p_projectid . ";\n";
+		$somecontent .= "/**\n" .
+		"* Particular fields\n" .
+		"*/\n" .
+		"#fields\n" .
+		"#priority\n" .
+		"#severity\n" .
+		"#reproducibility\n" .
+		"#summary\n" .
+		"#steps_to_reproduce\n" .
+		"#additional_information\n" .
+		"#control\n" .
+		"\n";
+		$somecontent .= "/**\n" .
+		"* Status management\n" .
+		"*/\n" .
+		"#status\n" .
+		"#name\n" .
+		"#title\n" .
+		"#button\n" .
+		"#notification_email\n" .
+		"#email\n" .
+		"#workflow\n" .
+		"\n";
+
+		fwrite($handle, $somecontent);
+
+		fclose($handle);
+
+		chmod($file_path, 0777);
+	}
+	return true;
+}
diff -rNU5 mantisbt/core/string_api.php mantisbt-2.0.0/core/string_api.php
--- mantisbt/core/string_api.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core/string_api.php	2017-02-03 11:14:38.000000000 +0100
@@ -19,10 +19,11 @@
  *
  * @package CoreAPI
  * @subpackage StringProcessingAPI
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses access_api.php
  * @uses authentication_api.php
  * @uses bug_api.php
@@ -153,10 +154,14 @@
  * @param string $p_string String to be processed.
  * @return string
  */
 function string_display_line( $p_string ) {
 	$t_data = event_signal( 'EVENT_DISPLAY_TEXT', $p_string, false );
+	if ( lang_exists($p_string, lang_get_current() ) ||
+		lang_exists($p_string, 'english' )) {
+		$t_data = lang_get($p_string);
+	} 
 	return $t_data;
 }
 
 /**
  * Prepare a string for display to HTML and add href anchors for URLs, emails
@@ -642,11 +647,11 @@
  * @param integer $p_bug_id	     A bug identifier.
  * @param boolean $p_detail_info Whether to include more detailed information (e.g. title attribute / project) in the returned string.
  * @param boolean $p_fqdn        Whether to return an absolute or relative link.
  * @return string
  */
-function string_get_bug_view_link( $p_bug_id, $p_detail_info = true, $p_fqdn = false ) {
+function string_get_bug_view_link( $p_bug_id, $p_detail_info = true, $p_fqdn = false , $p_recently_visited = false ) {
 	if( bug_exists( $p_bug_id ) ) {
 		$t_link = '<a href="';
 		if( $p_fqdn ) {
 			$t_link .= config_get_global( 'path' );
 		} else {
@@ -656,12 +661,24 @@
 		if( $p_detail_info ) {
 			$t_summary = string_attribute( bug_get_field( $p_bug_id, 'summary' ) );
 			$t_project_id = bug_get_field( $p_bug_id, 'project_id' );
 			$t_status = string_attribute( get_enum_element( 'status', bug_get_field( $p_bug_id, 'status' ), $t_project_id ) );
 			$t_link .= ' title="[' . $t_status . '] ' . $t_summary . '"';
+			
+			if ( !ARD ) {
+				$t_resolved = bug_get_field( $p_bug_id, 'status' ) >= config_get( 'bug_resolved_status_threshold', null, null, $t_project_id );
+			}
+			else {
+				if ( $p_recently_visited ) {
+					# with status management, to rule out bugs'links, we need to get status_enum_string of the bug's project
+					$t_resolved = false;
+				}
+				else {
+				 	$t_resolved = bug_get_field( $p_bug_id, 'status' ) >= MantisEnum::getValue(config_get( 'status_enum_string' ), 'closed');					
+				}
+			}
 
-			$t_resolved = bug_get_field( $p_bug_id, 'status' ) >= config_get( 'bug_resolved_status_threshold', null, null, $t_project_id );
 			if( $t_resolved ) {
 				$t_link .= ' class="resolved"';
 			}
 		}
 		$t_link .= '>' . bug_format_id( $p_bug_id ) . '</a>';
diff -rNU5 mantisbt/core.php mantisbt-2.0.0/core.php
--- mantisbt/core.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/core.php	2017-02-03 11:28:23.000000000 +0100
@@ -22,10 +22,11 @@
  * are required to be executed on every page load.
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses authentication_api.php
  * @uses collapse_api.php
  * @uses compress_api.php
@@ -229,10 +230,38 @@
 }
 
 # Register global shutdown function
 shutdown_functions_register();
 
+# PHP Sessions
+require_api( 'forge_api.php' );
+
+# Authentication and user setup
+$t_instance_inc_found = false;
+
+if ( auth_is_user_authenticated() )
+{	
+	$mantis_project_id = helper_get_current_project();	
+	session_set( 'project_id', $mantis_project_id );	
+	
+	if ($mantis_project_id != null && $mantis_project_id != 0)
+	{
+		# config_inc may not be present if this is a new install
+		if ( file_exists( dirname( __FILE__ ).DIRECTORY_SEPARATOR.'conf-instance'.DIRECTORY_SEPARATOR.'config_status_'.$mantis_project_id.'.php' ) ) 
+		{
+			require_once( dirname( __FILE__ ).DIRECTORY_SEPARATOR.'conf-instance'.DIRECTORY_SEPARATOR.'config_status_'.$mantis_project_id.'.php' );	
+			$t_instance_inc_found = true;				
+		}
+	 }
+}
+
+
+# Load internationalization functions (needed before database_api, in case database connection fails)
+require_api( 'conf_instance_file_api.php' );
+require_api( 'lang_api.php' );
+require_api( 'status_api.php' );
+	
 # Initialise plugins
 require_api( 'plugin_api.php' );  // necessary for some upgrade steps
 if( !defined( 'PLUGINS_DISABLED' ) && !defined( 'MANTIS_MAINTENANCE_MODE' ) ) {
 	plugin_init_installed();
 }
diff -rNU5 mantisbt/lang/strings_english.txt mantisbt-2.0.0/lang/strings_english.txt
--- mantisbt/lang/strings_english.txt	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/lang/strings_english.txt	2017-02-03 11:15:22.000000000 +0100
@@ -33,10 +33,11 @@
  * See the qqq 'language' for message documentation incl. usage of parameters
  *
  * @ingroup Language
  * @file
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @author Adrian Spinei
  * @author Alexey Chumakov
  * @author André Eisenbach
@@ -754,10 +755,11 @@
 $s_manage_global_profiles_link = 'Manage Global Profiles';
 $s_manage_plugin_link = 'Manage Plugins';
 $s_permissions_summary_report = 'Permissions Report';
 $s_manage_config_link = 'Manage Configuration';
 $s_manage_threshold_config = 'Workflow Thresholds';
+$s_manage_status_config = 'Bugs Status';
 $s_manage_email_config = 'E-mail Notifications';
 $s_manage_workflow_config = 'Workflow Transitions';
 $s_manage_workflow_graph = 'Workflow Graph';
 $s_manage_tags_link = 'Manage Tags';
 $s_create_new_account_link = 'Create New Account';
@@ -1769,10 +1771,24 @@
 $MANTIS_ERROR[ERROR_TYPE_MISMATCH] = 'Data Type mismatch. Enable detailed error messages for further information.';
 $MANTIS_ERROR[ERROR_BUG_CONFLICTING_EDIT] = 'This issue has been updated by another user, please return to the issue and submit your changes again.';
 $MANTIS_ERROR[ERROR_SPAM_SUSPECTED] = 'You have reached the allowed activity limit of %d events within the last %d seconds; your action has been blocked to avoid spam, please try again later.';
 $MANTIS_ERROR[ERROR_FIELD_TOO_LONG] = 'Field "%1$s" must be shorter or equal to %2$d characters long.';
 $MANTIS_ERROR[ERROR_API_TOKEN_NAME_NOT_UNIQUE] = 'API token name "%s" is already being used. Please go back and select another one.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_LABEL] = 'A status already exists with that label.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_NAME_FRENCH] = 'A status already exists with that french name.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_NAME_ENGLISH] = 'A status already exists with that english name.';
+$MANTIS_ERROR[ERROR_STATUS_INVALID_COLOR] = 'This color has a wrong format.';
+$MANTIS_ERROR[ERROR_STATUS_INVALID_LABEL] = 'This label has a wrong format.';
+$MANTIS_ERROR[ERROR_STATUS_OTHER_LANGUAGE_EMAIL] = 'Missing english email field to add an email in other language.';
+$MANTIS_ERROR[ERROR_STATUS_CLASSIFICATION_NUMBER] = 'Two status have the same number.';
+$MANTIS_ERROR[ERROR_STATUS_CLASSIFICATION_NUMBER_BORNS] = 'The weight of status has to be between those of bounds.';
+$MANTIS_ERROR[ERROR_STATUS_DELETE_WHEN_USE] = 'Impossible to delete this status : it is used.';
+$MANTIS_ERROR[ERROR_STATUS_LANGUAGE] = 'Sorry : impossible to manage status with this default language.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_DUPLICATE_LABEL] = 'A risk criteria already exists with that label.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_WEIGHT_INVALID] = 'This weighting as wrong format.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_SUM_WEIGHT_INVALID] = 'The sum of all weighting in a category has to be 100.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_LABEL] = 'The 6th evaluation label cannot be fill if the 5th is not.';
 
 # dropzone.js - placeholders format is defined by the library
 $s_dropzone_default_message = 'Drop files here to upload (or click)';
 $s_dropzone_fallback_message = 'Your browser does not support drag\'n\'drop file uploads.';
 $s_dropzone_fallback_text = '';
@@ -1782,6 +1798,126 @@
 $s_dropzone_cancel_upload = 'Cancel upload';
 $s_dropzone_cancel_upload_confirmation = 'Are you sure you want to cancel this upload?';
 $s_dropzone_remove_file = 'Remove file';
 $s_dropzone_remove_file_confirmation = '';
 $s_dropzone_max_files_exceeded = 'You cannot upload any more files.';
-$s_dropzone_not_supported = 'Dropzone.js does not support older browsers!';
\ No newline at end of file
+$s_dropzone_not_supported = 'Dropzone.js does not support older browsers!';
+
+# manage_config_status_page.php
+$s_list_status = 'Status list';
+$s_manage_status = 'Manage bugs status';
+$s_language_status = 'Language(s)';
+$s_label_status = 'Label';
+$s_label_condition = '(only alphanumeric characters)';
+$s_name_status = 'Name';
+$s_classification_status = 'Classification';
+$s_update_classification = 'Update classification';
+$s_warning_classification_status = 'Be carefull about update classification : it could affect workflow thresholds and workflow transitions !';
+$s_title_status = 'Title';
+$s_button_status = 'Status button';
+$s_color_status = 'Color';
+$s_color_condition = '(six hexadecimal characters)';
+$s_email_status = 'Email notification';
+$s_default_email_status = 'The following bug has been...';
+$s_add_language = 'Add a language';
+$s_delete_language = 'Delete a language';
+$s_create_status = 'Create a new status';
+$s_update_status = 'Update status';
+$s_delete = 'Suppression';
+$s_delete_status = 'Delete status';
+$s_delete_status_conf_msg = 'Are you sure you wish to delete this status?';
+
+
+# ARD
+$s_ard_select_project = 'Welcome on Mantis ARD ! Please select a project.';
+//Prism links
+$s_prism_link = 'PRISM';
+$s_reporting_prism_link = 'View PRISM synthesis';
+$s_risk_criteria_configuration_link = 'Configure risk criteria';
+$s_risk_appreciation_link = 'Evaluate risks';
+$s_view_all_risk_criteria_link = 'Display risk criteria';
+$s_add_risk_criteria_link = 'Create risk criteria';
+//Risk criteria
+$s_list_risk_criteria = 'List of risk criterias';
+$s_create_risk_criteria = 'Create a risk criteria';
+$s_no_risk_criteria = 'No risk criteria';
+$s_manage_risk_criteria = 'Manage risk criteria';
+$s_manage_risk_appreciation = 'Risks evaluation';
+$s_label = 'Label';
+$s_weight = 'Weighting (by %)';
+$s_weight_info = '(weighting is updatable on risk criteria\'s list)';
+$s_evaluation = 'Evaluation';
+$s_evaluation1 = 'Evaluation label 1';
+$s_evaluation2 = 'Evaluation label 2';
+$s_evaluation3 = 'Evaluation label 3';
+$s_evaluation4 = 'Evaluation label 4';
+$s_evaluation5 = 'Evaluation label 5';
+$s_evaluation6 = 'Evaluation label 6';
+$s_no_indicator = 'none';
+$s_last_indicator = 'Previous indicator';
+$s_indicator = 'Indicator';
+$s_submit_risk_criteria_button = 'Submit risk criteria';
+$s_update_risk_criteria_button = 'Update risk criteria';
+$s_delete_risk_criteria_button = 'Delete risk criteria';
+$s_update_weight = 'Update weighting';
+$s_update_appreciation = 'Update evaluation';
+$s_delete_risk_criteria_conf_msg = 'Do you really want to delete with risk criteria?';
+//RiskActionDecision
+$s_view_actions_link = 'Actions';
+$s_view_risks_link = 'Risks';
+$s_view_decisions_link = 'Decisions';
+$s_view_evolutions_link = 'Evolutions';
+$s_context = 'Context';
+//$s_responsable_action = 'Responsable';
+//$s_responsable_risk = 'Responsable';
+//$s_responsable_decision = 'Responsable';
+$s_responsable = 'Responsable';
+$s_reference = 'Transmitter reference';
+$s_control = 'Control';
+$s_impact = 'Impact description';
+$s_state = 'State';
+$s_gravity = 'Gravity';
+$s_estimate_end = 'Estimate end date';
+$s_real_end = 'Real end date';
+$s_reestimate_end = 'Reestimate end date';
+$s_charge = 'Charge';
+$s_delivery = 'Delivery date';
+$s_mep = 'MEP date';
+$s_uc = 'UP (category precision)';
+$s_it = 'IT';
+//categories
+$s_categories_formule = '(D+2I+2C1+C2+E) or (D+2I+2C1+C2+E+A)*7/8 if A exists';
+$s_duration = 'duration';
+$s_integrity = 'integrity'; 
+$s_management_commitment = 'management commitment'; 
+$s_team_commitment = 'team commitment'; 
+$s_effort = 'effort';
+$s_other = 'other';
+$s_commitment_backlog = 'commitment backlog';
+$s_climb_backlog = 'climb backlog';
+$s_management_backlog = 'management backlog';
+$s_functional = 'functional';
+$s_organizational = 'organizational';
+$s_technical = 'technical';
+$s_cig = 'CIG';
+$s_ergonomy = 'ergonomy';
+$s_general = 'general';
+$s_business = 'mÃ©tier';
+$s_archi = 'architecture';
+$s_specific = 'spÃ©cifique';
+$s_urgency_none = 'not urgent';
+$s_urgency_month = 'in the month';
+$s_urgency_fifteen = 'in the fifteen';
+$s_urgency_week = 'in the week';
+$s_urgency_immediate = 'immediately';
+$s_create_action = 'Create an action';
+$s_create_decision = 'Create a decision';
+$s_associate_actions = 'Associate actions';
+$s_associate_decisions = 'Associate decisions';
+$s_associate_risk = 'Associate to a risk :';
+$s_associate_action = 'Associate to an action :';
+$s_associate = 'Associate';
+$s_control_vlow = 'very low 10%';
+$s_control_low = 'low 30%';
+$s_control_middle = 'middle 50%';
+$s_control_high = 'high 70%';
+$s_control_vhigh = 'very high 90%'; 
\ No newline at end of file
diff -rNU5 mantisbt/lang/strings_french.txt mantisbt-2.0.0/lang/strings_french.txt
--- mantisbt/lang/strings_french.txt	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/lang/strings_french.txt	2017-02-03 11:17:15.000000000 +0100
@@ -1,10 +1,9 @@
 <?php
 /** MantisBT - a php based bugtracking system
  *
  * Copyright (C) 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
- * Copyright (C) 2002 - 2016  MantisBT Team - mantisbt-dev@lists.sourceforge.net
  *
  * MantisBT is free software: you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
  * the Free Software Foundation, either version 2 of the License, or
  * (at your option) any later version.
@@ -36,10 +35,12 @@
  * To improve a translation please visit http://translatewiki.net
  *
  * @ingroup Language
  * @file
  *
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
+ *
  * @author Atrol
  * @author Brunoperel
  * @author Crochet.david
  * @author DavidL
  * @author Dregad
@@ -591,10 +592,11 @@
 $s_manage_global_profiles_link = 'Gérer les profils globaux';
 $s_manage_plugin_link = 'Gérer les plugiciels';
 $s_permissions_summary_report = 'Rapport des permissions';
 $s_manage_config_link = 'Gérer la configuration';
 $s_manage_threshold_config = 'Seuils du workflow';
+$s_manage_status_config = 'Etats des bogues';
 $s_manage_email_config = 'Notifications par courriel';
 $s_manage_workflow_config = 'Workflow';
 $s_manage_workflow_graph = 'Graphique d\'enchaînement des actions';
 $s_manage_tags_link = 'Gérer les balises';
 $s_create_new_account_link = 'Créer un nouveau compte';
@@ -1405,14 +1407,150 @@
 $MANTIS_ERROR[ERROR_TYPE_MISMATCH] = 'Incompatibilité de Type de données. Activez les messages d\'erreur détaillés pour plus d\'information.';
 $MANTIS_ERROR[ERROR_BUG_CONFLICTING_EDIT] = 'Ce problème a été mis à jour par un autre utilisateur, veuillez y revenir et soumettre de nouveau vos modifications.';
 $MANTIS_ERROR[ERROR_SPAM_SUSPECTED] = 'Vous avez atteint la limite d’activité autorisée de %d événements durant les %d dernières secondes ; votre action a été bloquée pour éviter le spam, veuillez réessayer ultérieurement.';
 $MANTIS_ERROR[ERROR_FIELD_TOO_LONG] = 'Le champ « %1$s » doit faire moins de %2$d caractères de long.';
 $MANTIS_ERROR[ERROR_API_TOKEN_NAME_NOT_UNIQUE] = 'Le nom de jeton de l’API « %s » est déjà utilisé. Veuillez revenir en arrière et en sélectionner un autre.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_LABEL] = 'Un statut existe déjà  avec ce label.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_NAME_FRENCH] = 'Un statut existe déjà  avec ce nom français.';
+$MANTIS_ERROR[ERROR_STATUS_DUPLICATE_NAME_ENGLISH] = 'Un statut existe déjà  avec ce nom anglais.';
+$MANTIS_ERROR[ERROR_STATUS_INVALID_COLOR] = 'Mauvais format de couleur.';
+$MANTIS_ERROR[ERROR_STATUS_INVALID_LABEL] = 'Mauvais format de label.';
+$MANTIS_ERROR[ERROR_STATUS_OTHER_LANGUAGE_EMAIL] = 'Il manque l\'email en anglais pour l\'ajouter dans d\'autre langage.';
+$MANTIS_ERROR[ERROR_STATUS_CLASSIFICATION_NUMBER] = 'Deux statut ont le méme classement.';
+$MANTIS_ERROR[ERROR_STATUS_CLASSIFICATION_NUMBER_BORNS] = 'Le poids des statuts doit étre compris entre ceux des bornes.';
+$MANTIS_ERROR[ERROR_STATUS_DELETE_WHEN_USE] = 'Impossible de supprimer ce statut : il est actuellement utilisé.';
+$MANTIS_ERROR[ERROR_STATUS_LANGUAGE] = 'Désolé : impossible de gérer les statut avec ce language par défaut.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_DUPLICATE_LABEL] = 'Un critère de risque existe déjà  avec ce label.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_WEIGHT_INVALID] = 'Mauvais format de pondération.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_SUM_WEIGHT_INVALID] = 'Le total des pondérations dans une catégorie doit étre égale à  100.';
+$MANTIS_ERROR[ERROR_RISK_CRITERIA_LABEL] = 'Le libellé d\'évaluation 6 ne peut étre rempli sans le 5.';
 $s_dropzone_default_message = 'Déposer les fichiers ici pour les téléverser (ou cliquer)';
 $s_dropzone_fallback_message = 'Votre navigateur ne supporte pas le téléversement de fichiers par glisser-déposer.';
 $s_dropzone_file_too_big = 'Le fichier est trop gros ({{filesize}}MiB). Taille maximale du fichier : {{maxFilesize}}MiB.';
 $s_dropzone_invalid_file_type = 'Vous ne pouvez pas téléverser des fichiers de ce type.';
 $s_dropzone_response_error = 'Le serveur a répondu avec le code {{statusCode}}.';
 $s_dropzone_cancel_upload = 'Annuler le téléversement';
 $s_dropzone_cancel_upload_confirmation = 'Êtes-vous sûr de vouloir annuler ce téléversement ?';
 $s_dropzone_remove_file = 'Supprimer le fichier';
 $s_dropzone_max_files_exceeded = 'Vous ne pouvez plus téléverser de fichiers.';
+
+# manage_config_status_page.php
+$s_list_status = 'Liste des statuts';
+$s_manage_status = 'Gestion des statuts';
+$s_language_status = 'Langage(s)';
+$s_label_status = 'Libellé';
+$s_label_condition = '(seulement des caractères alphanumériques)';
+$s_name_status = 'Nom';
+$s_classification_status = 'Classification';
+$s_update_classification = 'Mis à  jour de la classification';
+$s_warning_classification_status = 'Attention à  la modification de la classification : cela peut affecter le cheminement de travail ou les seuils du cheminement de travail !';
+$s_title_status = 'Titre';
+$s_button_status = 'Bouton du statut';
+$s_color_status = 'Couleur';
+$s_color_condition = '(six caractères héxadécimaux)';
+$s_email_status = 'Notification par email';
+$s_default_email_status = 'Le bug suivant a été...';
+$s_add_language = 'Ajouter un langage';
+$s_delete_language = 'Supprimer un langage';
+$s_create_status = 'Créer un nouveau statut';
+$s_update_status = 'Mis à  jour du statut';
+$s_delete = 'Suppression';
+$s_delete_status = 'Suppression du statut';
+$s_delete_status_conf_msg = 'Etes vous sûre de vouloir supprimer ce statut?';
+
+# ARD
+$s_select_project_message = 'Veuillez sélectionner un projet.';
+$s_no_bug_message = 'Il n\'existe pas encore de bogue';
+$s_ard_select_project = 'Bienvenue sur Mantis ARD ! Veuillez selectionner un projet.';
+//Prism links
+$s_prism_link = 'PRISM';
+$s_reporting_prism_link = 'Visualiser la synthèse de PRISM';
+$s_risk_criteria_configuration_link = 'Paramétrer les critères de risque';
+$s_risk_appreciation_link = 'Valoriser les risques';
+$s_view_all_risk_criteria_link = 'Afficher les critères de risque';
+$s_add_risk_criteria_link = 'Rapporter un critère de risque';
+//Risk criteria
+$s_list_risk_criteria = 'Liste des criteres de risque';
+$s_note_list_risk_criteria = 'La somme des pondérations de chaque catégorie doit égaler 100';
+$s_create_risk_criteria = 'Créer un critère de risque';
+$s_no_risk_criteria = 'Aucun critère de risque';
+$s_manage_risk_criteria = 'Gestion des critères de risque';
+$s_manage_risk_appreciation = 'Valorisation des risques';
+$s_label = 'Label';
+$s_weight = 'Pondération (en %)';
+$s_weight_info = '(la pondération est modifiable sur la liste des crières de risque)';
+$s_evaluation = 'Evaluation';
+$s_evaluation1 = 'Libellé d\'évaluation 1';
+$s_evaluation2 = 'Libellé d\'évaluation 2';
+$s_evaluation3 = 'Libellé d\'évaluation 3';
+$s_evaluation4 = 'Libellé d\'évaluation 4';
+$s_evaluation5 = 'Libellé d\'évaluation 5';
+$s_evaluation6 = 'Libellé d\'évaluation 6';
+$s_no_indicator = 'aucun';
+$s_last_indicator = 'Indicateur précédent';
+$s_indicator = 'Indicateur actuel';
+$s_submit_risk_criteria_button = 'Soumettre le critère de risque';
+$s_update_risk_criteria_button = 'Mettre à  jour le critère de risque';
+$s_delete_risk_criteria_button = 'Supprimer le critère de risque';
+$s_update_weight = 'Mise à  jour de la pondération';
+$s_update_appreciation = 'Mise à  jour de l\'appréciation';
+$s_delete_risk_criteria_conf_msg = 'Etes vous sûr de vouloir supprimer ce critère de risque ?';
+//RiskActionDecision
+$s_view_actions_link = 'Actions';
+$s_view_risks_link = 'Risques';
+$s_view_decisions_link = 'Décisions';
+$s_view_evolutions_link = 'Evolutions';
+$s_context = 'Contexte';
+//$s_responsable_action = 'Responsable';
+//$s_responsable_risk = 'Responsable';
+//$s_responsable_decision = 'Responsable';
+$s_responsable = 'Responsable';
+$s_reference = 'Référence chez l\'émetteur';
+$s_control = 'Maitrise';
+$s_impact = 'Description de l\'impact';
+$s_state = 'Etat';
+$s_gravity = 'Gravité';
+$s_estimate_end = 'Date de fin prévisionnelle';
+$s_real_end = 'Date de fin réelle';
+$s_reestimate_end = 'Date de fin réestimée';
+$s_charge = 'Charge';
+$s_delivery = 'Date de livraison';
+$s_mep = 'Date de MEP';
+$s_uc = 'UP (précision de la catégorie)';
+$s_it = 'IT';
+//categories
+$s_categories_formule = '(D+2I+2C1+C2+E) ou (D+2I+2C1+C2+E+A)*7/8 si A existe';
+$s_duration = 'durée (D)';
+$s_integrity = 'intégrité (I)'; 
+$s_management_commitment = 'engagement management (C1)'; 
+$s_team_commitment = 'engagement équipe (C2)'; 
+$s_effort = 'effort (E)';
+$s_other = 'autre (A)';
+$s_commitment_backlog = 'backlog d\'engagement';
+$s_climb_backlog = 'backlog d\'escalade';
+$s_management_backlog = 'backlog de pilotage';
+$s_functional = 'fonctionnel';
+$s_organizational = 'organisationnel';
+$s_technical = 'technique';
+$s_cig = 'CIG';
+$s_ergonomy = 'ergonomie';
+$s_general = 'général';
+$s_business = 'métier';
+$s_archi = 'architecture';
+$s_specific = 'spécifique';
+$s_urgency_none = 'non urgent';
+$s_urgency_month = 'dans le mois';
+$s_urgency_fifteen = 'dans la quinzaine';
+$s_urgency_week = 'dans la semaine';
+$s_urgency_immediate = 'immédiatement';
+$s_create_action = 'Créer une action';
+$s_create_decision = 'Créer une décision';
+$s_associate_actions = 'Associer des actions';
+$s_associate_decisions = 'Associer des décisions';
+$s_associate_risk = 'Associer à  un risque :';
+$s_associate_action = 'Associer à  une action :';
+$s_associate = 'Associer';
+$s_control_vlow = 'très faible 10%';
+$s_control_low = 'faible 30%';
+$s_control_middle = 'moyenne 50%';
+$s_control_high = 'élevée 70%';
+$s_control_vhigh = 'très élevée 90%'; 
\ No newline at end of file
diff -rNU5 mantisbt/login.php mantisbt-2.0.0/login.php
--- mantisbt/login.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/login.php	2017-02-03 11:29:26.000000000 +0100
@@ -18,10 +18,11 @@
  * Check login then redirect to main_page.php or to login_page.php
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses authentication_api.php
  * @uses config_api.php
@@ -50,10 +51,17 @@
 $f_from			= gpc_get_string( 'from', '' );
 $f_secure_session = gpc_get_bool( 'secure_session', false );
 $f_reauthenticate = gpc_get_bool( 'reauthenticate', false );
 $f_install = gpc_get_bool( 'install' );
 
+if ( CAS_AUTH == config_get( 'login_method' ) ) {
+	# This will detour to the CAS login page if needed
+	$f_password = '';
+	$f_username = auth_cas_get_name();
+	# User is always authenticated by this point
+}
+
 # If upgrade required, always redirect to install page.
 if( $f_install ) {
 	$t_return = 'admin/install.php';
 }
 
@@ -67,11 +75,15 @@
 
 	if( $f_username == 'administrator' && $f_password == 'root' && ( is_blank( $t_return ) || $t_return == 'index.php' ) ) {
 		$t_return = 'account_page.php';
 	}
 
-	$t_redirect_url = 'login_cookie_test.php?return=' . $t_return;
+	if (isset($_REQUEST['instance_id']))  {
+		$t_redirect_url = 'login_cookie_test.php?return=' .  get_project_return_url( gpc_get_string( 'instance_id' ) ) ;
+	} else {
+		$t_redirect_url = 'login_cookie_test.php?return=' . $t_return;
+	}
 } else {
 	$t_query_args = array(
 		'error' => 1,
 		'username' => $f_username,
 		'return' => $t_return,
diff -rNU5 mantisbt/my_view_page.php mantisbt-2.0.0/my_view_page.php
--- mantisbt/my_view_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/my_view_page.php	2017-02-03 11:29:06.000000000 +0100
@@ -18,10 +18,11 @@
  * My View Page
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses access_api.php
  * @uses authentication_api.php
@@ -89,70 +90,80 @@
 #print_r ($t_boxes);
 
 $t_project_id = helper_get_current_project();
 $t_timeline_view_threshold_access = access_has_project_level( config_get( 'timeline_view_threshold' ) );
 $t_timeline_view_class = ( $t_timeline_view_threshold_access ) ? "col-md-7" : "col-md-6";
-?>
-<div class="col-xs-12 <?php echo $t_timeline_view_class ?>">
 
-<?php
-$t_number_of_boxes = count ( $t_boxes );
-$t_boxes_position = config_get( 'my_view_boxes_fixed_position' );
-$t_counter = 0;
-$t_two_columns_applied = false;
-
-define( 'MY_VIEW_INC_ALLOW', true );
-
-while (list ($t_box_title, $t_box_display) = each ($t_boxes)) {
-		# don't display bugs that are set as 0
-	if ($t_box_display == 0) {
-		$t_number_of_boxes = $t_number_of_boxes - 1;
-	}
-		# don't display "Assigned to Me" bugs to users that bugs can't be assigned to
-	else if(
-		$t_box_title == 'assigned'
-		&&  ( current_user_is_anonymous()
-			|| !access_has_project_level( config_get( 'handle_bug_threshold' ), $t_project_id, $t_current_user_id )
-		)
-	) {
-		$t_number_of_boxes = $t_number_of_boxes - 1;
-	}
-		# don't display "Monitored by Me" bugs to users that can't monitor bugs
-	else if( $t_box_title == 'monitored' && ( current_user_is_anonymous() OR !access_has_project_level( config_get( 'monitor_bug_threshold' ), $t_project_id, $t_current_user_id ) ) ) {
-		$t_number_of_boxes = $t_number_of_boxes - 1;
-	}
-		# don't display "Reported by Me" bugs to users that can't report bugs
-	else if( in_array( $t_box_title, array( 'reported', 'feedback', 'verify' ) ) &&
-		( current_user_is_anonymous() OR !access_has_project_level( config_get( 'report_bug_threshold' ), $t_project_id, $t_current_user_id ) ) ) {
-		$t_number_of_boxes = $t_number_of_boxes - 1;
-			}
+if ( project_get_type_management() != 'management' ) {
+
+	?>
+	<div class="col-xs-12 <?php echo $t_timeline_view_class ?>">
 
-			# display the box
-	else {
-		if( !$t_timeline_view_threshold_access ) {
-			if ($t_counter >= $t_number_of_boxes / 2 && !$t_two_columns_applied) {
-				echo '</div>';
-				echo '<div class="col-xs-12 col-md-6">';
-				$t_two_columns_applied = true;
-			} elseif ($t_counter >= $t_number_of_boxes && $t_two_columns_applied) {
-				echo '</div>';
+	<?php
+	$t_number_of_boxes = count ( $t_boxes );
+	$t_boxes_position = config_get( 'my_view_boxes_fixed_position' );
+	$t_counter = 0;
+	$t_two_columns_applied = false;
+
+	define( 'MY_VIEW_INC_ALLOW', true );
+
+	while (list ($t_box_title, $t_box_display) = each ($t_boxes)) {
+			# don't display bugs that are set as 0
+		if ($t_box_display == 0) {
+			$t_number_of_boxes = $t_number_of_boxes - 1;
+		}
+			# don't display "Assigned to Me" bugs to users that bugs can't be assigned to
+		else if(
+			$t_box_title == 'assigned'
+			&&  ( current_user_is_anonymous()
+				|| !access_has_project_level( config_get( 'handle_bug_threshold' ), $t_project_id, $t_current_user_id )
+			)
+		) {
+			$t_number_of_boxes = $t_number_of_boxes - 1;
+		}
+			# don't display "Monitored by Me" bugs to users that can't monitor bugs
+		else if( $t_box_title == 'monitored' && ( current_user_is_anonymous() OR !access_has_project_level( config_get( 'monitor_bug_threshold' ), $t_project_id, $t_current_user_id ) ) ) {
+			$t_number_of_boxes = $t_number_of_boxes - 1;
+		}
+			# don't display "Reported by Me" bugs to users that can't report bugs
+		else if( in_array( $t_box_title, array( 'reported', 'feedback', 'verify' ) ) &&
+			( current_user_is_anonymous() OR !access_has_project_level( config_get( 'report_bug_threshold' ), $t_project_id, $t_current_user_id ) ) ) {
+			$t_number_of_boxes = $t_number_of_boxes - 1;
+				}
+
+				# display the box
+		else {
+			if( !$t_timeline_view_threshold_access ) {
+				if ($t_counter >= $t_number_of_boxes / 2 && !$t_two_columns_applied) {
+					echo '</div>';
+					echo '<div class="col-xs-12 col-md-6">';
+					$t_two_columns_applied = true;
+				} elseif ($t_counter >= $t_number_of_boxes && $t_two_columns_applied) {
+					echo '</div>';
+				} else {
+					include( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'my_view_inc.php' );
+					echo '<div class="space-10"></div>';
+				}
+				$t_counter++;
 			} else {
 				include( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'my_view_inc.php' );
 				echo '<div class="space-10"></div>';
 			}
-			$t_counter++;
-		} else {
-			include( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'my_view_inc.php' );
-			echo '<div class="space-10"></div>';
 		}
 	}
-}
-?>
-</div>
+	?>
+	</div>
 
-<?php if( $t_timeline_view_threshold_access ) { ?>
-<div class="col-md-5 col-xs-12">
-	<?php include( $g_core_path . 'timeline_inc.php' ); ?>
-	<div class="space-10"></div>
-</div>
-<?php }
+	<?php if( $t_timeline_view_threshold_access ) { ?>
+	<div class="col-md-5 col-xs-12">
+		<?php include( $g_core_path . 'timeline_inc.php' ); ?>
+		<div class="space-10"></div>
+	</div>
+	<?php }
+	}
+	else
+	{
+		echo '<div align="center">';
+		echo lang_get('select_project_message');
+		echo '<div>';
+	}
 layout_page_end();
diff -rNU5 mantisbt/view_all_bug_page.php mantisbt-2.0.0/view_all_bug_page.php
--- mantisbt/view_all_bug_page.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/view_all_bug_page.php	2017-02-03 11:20:09.000000000 +0100
@@ -18,10 +18,11 @@
  * View all bug page
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses core.php
  * @uses authentication_api.php
  * @uses compress_api.php
@@ -54,27 +55,75 @@
 
 auth_ensure_user_authenticated();
 
 $f_page_number		= gpc_get_int( 'page_number', 1 );
 # Get Project Id and set it as current
+
 $t_project_id = gpc_get_int( 'project_id', helper_get_current_project() );
 if( ( ALL_PROJECTS == $t_project_id || project_exists( $t_project_id ) ) && $t_project_id != helper_get_current_project() ) {
 	helper_set_current_project( $t_project_id );
 	# Reloading the page is required so that the project browser
 	# reflects the new current project
 	print_header_redirect( $_SERVER['REQUEST_URI'], true, false, true );
 }
 
+
 $t_per_page = null;
 $t_bug_count = null;
 $t_page_count = null;
 
 $t_rows = filter_get_bug_rows( $f_page_number, $t_per_page, $t_page_count, $t_bug_count, null, null, null, true );
 if( $t_rows === false ) {
 	print_header_redirect( 'view_all_set.php?type=0' );
 }
 
+
+
+# if an association button is selected from a report
+if ( null != $_GET['relationship_id']) {
+	if ( null != $_GET['project_id']) {
+		#$g_project_override is set to null to allow setting new project
+		$g_project_override = null;
+		helper_set_current_project($_GET['project_id']);
+		print_header_redirect( 'view_all_bug_page.php?relationship_id='.$_GET['relationship_id'] );
+	}
+	else {
+		//TODO have to use workflow
+		$t_new = get_enum_id('status', 'new');	
+		$t_progress = get_enum_id('status', 'progress');
+		$t_closed = get_enum_id('status', 'closed');
+		$t_link_id = $_GET['relationship_id'];
+		$t_show_project = false;
+		$t_relationship_all = relationship_get_all( $t_link_id, $t_show_project );
+		$t_relationships_id = array();
+		foreach ( $t_relationship_all as $t_relationship ) {
+			if ( $t_relationship->src_bug_id != $t_link_id ) {
+				array_push($t_relationships_id, $t_relationship->src_bug_id);
+			}
+		}
+		foreach ( $t_rows as $key => $bug ) {
+			if ( $t_progress != $bug->status || in_array($bug->id, $t_relationships_id) ) {
+				unset($t_rows[$key]);
+			}	
+		}	
+		$t_rows = array_values($t_rows);
+	}
+}
+else {
+	# link ARD from parent project
+	if ( null != $_GET['project_id']) {
+		$g_project_override = null;
+		helper_set_current_project($_GET['project_id']);
+		print_header_redirect( 'view_all_bug_page.php' );
+	}
+}
+
+#if no row, display bug view
+if ( 0 == count($t_rows) ) {
+	print_header_redirect( 'view.php?id='.$t_link_id);	
+}
+		
 $t_bugslist = array();
 $t_unique_user_ids = array();
 $t_unique_project_ids = array();
 $t_row_count = count( $t_rows );
 for( $i=0; $i < $t_row_count; $i++ ) {
@@ -106,8 +155,9 @@
 layout_page_header_end();
 
 layout_page_begin( __FILE__ );
 
 define( 'VIEW_ALL_INC_ALLOW', true );
+
 include( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'view_all_inc.php' );
 
 layout_page_end();
diff -rNU5 mantisbt/view_all_inc.php mantisbt-2.0.0/view_all_inc.php
--- mantisbt/view_all_inc.php	2016-12-30 21:39:51.000000000 +0100
+++ mantisbt-2.0.0/view_all_inc.php	2017-02-03 11:19:56.000000000 +0100
@@ -18,10 +18,11 @@
  * View all bugs include file
  *
  * @package MantisBT
  * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org
  * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net
+ * @copyright Copyright 2017  Atos, NovaForge Version 3 and above.
  * @link http://www.mantisbt.org
  *
  * @uses category_api.php
  * @uses columns_api.php
  * @uses config_api.php
@@ -77,14 +78,13 @@
 if( ( $t_filter_position & FILTER_POSITION_TOP ) == FILTER_POSITION_TOP ) {
 	filter_draw_selection_area( $f_page_number );
 }
 # -- ====================== end of FILTER FORM ================== --
 
-
 # -- ====================== BUG LIST ============================ --
-
 ?>
+
 <div class="col-md-12 col-xs-12">
 <div class="space-10"></div>
 <form id="bug_action" method="post" action="bug_actiongroup_page.php">
 <?php # CSRF protection not required here - form does not result in modifications ?>
 <div class="widget-box widget-color-blue2">
@@ -196,13 +196,13 @@
 		}
 		echo '</tr>';
 	}
 }
 
-
 write_bug_rows( $t_rows );
 # -- ====================== end of BUG LIST ========================= --
+
 ?>
 
 </tbody>
 </table>
 </div>
@@ -219,16 +219,23 @@
 			echo '<input class="ace check_all input-sm" type="checkbox" id="bug_arr_all" name="bug_arr_all" value="all" />';
 			echo '<span class="lbl"> ' . lang_get( 'select_all' ) . ' </span > ';
 			echo '</label>';
 		}
 		if( $g_checkboxes_exist ) {
+			if ( null !== $t_link_id ) {
+?>
+				<input type="hidden" name="link_id" value="<?php echo $t_link_id ?>" />
+				<input type="submit" class="button" value="<?php echo lang_get( 'associate' ); ?>" />
+<?php
+			} else {
 ?>
-			<select name="action" class="input-sm">
-				<?php print_all_bug_action_option_list($t_unique_project_ids) ?>
-			</select>
-			<input type="submit" class="btn btn-primary btn-white btn-sm btn-round" value="<?php echo lang_get('ok'); ?>"/>
+				<select name="action" class="input-sm">
+					<?php print_all_bug_action_option_list($t_unique_project_ids) ?>
+				</select>
+				<input type="submit" class="btn btn-primary btn-white btn-sm btn-round" value="<?php echo lang_get('ok'); ?>"/>
 <?php
+			}
 		} else {
 			echo '&#160;';
 		}
 ?>
 			</div>
