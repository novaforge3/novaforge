<?xml version="1.0" encoding="UTF-8"?>
<!--
 * Copyright (c) 2011-2015, BULL SAS, NovaForge Version 3 and above.
 *
 * This file is free software: you may redistribute and/or 
 * modify it under the terms of the GNU Affero General Public License
 * as published by the Free Software Foundation, version 3 of the License.
 *
 * This file is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty
 * of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Affero General Public License for more details.
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see http://www.gnu.org/licenses.
 *
 * Additional permission under GNU AGPL version 3 (AGPL-3.0) section 7
 *
 * If you modify this Program, or any covered work,
 * by linking or combining it with libraries listed
 * in COPYRIGHT file at the top-level directof of this
 * distribution (or a modified version of that libraries),
 * containing parts covered by the terms of licenses cited
 * in the COPYRIGHT file, the licensors of this Program
 * grant you additional permission to convey the resulting work.
-->
<section version="5.0" xml:lang="fr" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:ns5="http://www.w3.org/2000/svg"
  xmlns:ns4="http://www.w3.org/1998/Math/MathML" xmlns:ns3="http://www.w3.org/1999/xhtml" xmlns:db="http://docbook.org/ns/docbook">
  <title>Intégration Continue</title>
  <sect2>
    <title>Jenkins</title>
    <sect3>
      <title>Description</title>
      <para>
        Jenkins est installé dans la version 1.651.3. C'est une application web installée avec son propre conteneur
        <emphasis>Winston</emphasis>.
        Dans cette installation, Jenkins est distribué et desservi par la facade web apache (Mandataire inverse).
        Le port utilisé par Winston est <emphasis>8765</emphasis>. Jenkins est installé dans le dossier :
      </para>
      <programlisting language="shell"># $NOVA_HOME/engines/jenkins/</programlisting>
    </sect3>
    <sect3>
      <title>Arrêt/Relance</title>
      <para>
        Un script shell permet d'arrêter/relancer le serveur applicatif
        <emphasis>Winston</emphasis>
      </para>
      <programlisting language="shell"># sysyemctl start jenkins
# sysyemctl stop jenkins</programlisting>
    </sect3>
    <sect3>
      <title>Données</title>
      <para>Les données propres à Jenkins, la configuration et son conteneur de servlet sont dans : </para>
      <programlisting language="shell"># $NOVA_HOME/datas/jenkins</programlisting>
      <para>
        <inlinemediaobject>
          <imageobject>
            <imagedata fileref="02-dialog-warning.png" width="27px" />
          </imageobject>
        </inlinemediaobject>
        Attention, la volumétrie de ce dossier peut augmenter très rapidement en fonction de l'activité de la forge</para>
    </sect3>
    <sect3>
      <title>Fichiers de logs</title>
      <para>Les logs se trouvent dans le dossier suivant : </para>
      <programlisting language="shell"># $NOVA_HOME/logs/jenkins</programlisting>
    </sect3>

    <sect3>
      <title>Description des fichiers de configuration</title>
		<para>
      <emphasis>plugins.jenkins.cfg</emphasis>
      <itemizedlist>
        <listitem>clientAdmin: login de l'administrateur Jenkins </listitem>
        <listitem>clientPwd: mot de passe de l'administrateur Jenkins </listitem>
        <listitem>defaultToolURL: URL d'accès de Jenkins dans la forge</listitem>
        <listitem>adminAccess: URL d'accès de l'administration de Jenkins dans la forge</listitem>        
      </itemizedlist>
      </para>
    </sect3>

    <sect3>
      <title>Configuration globale</title>
      <para>En tant qu'administrateur de forge, il est utile après l'installation d'une forge, de configurer certains paramètres présentés ci dessous, 
      via le panneau 'Administrer Jenkins' puis 'configurer le système' disponible depuis l'accueil Jenkins
      </para>
      <sect4>
        <title>Configuration d'un Sonar</title>
        <para>
        Les informations de cette section doivent être conformes à la configuration présente dans 
        $NOVA_HOME/engines/sonar/sonar-distrib-XXX/conf/sonar.properties.
        </para>
        <itemizedlist>
             <listitem>Server url : https://$PIC_HOST/sonar-default/sonar </listitem>
             <listitem>Database URL jdbc:mysql://$PIC_HOST:3306/sonar</listitem>
             <listitem>Database login : sonar</listitem>
             <listitem>Database password : sonar</listitem>
             <listitem>Database driver : com.mysql.jdbc.Driver</listitem>
        </itemizedlist>
      </sect4>
      <sect4>
        <title>Configuration des mails</title>
        <itemizedlist>
             <listitem>Serveur SMTP : DNS de la machine hôte du serveur SMTP</listitem>
             <listitem>System Admin e-mail address : Adresse mail de l'émetteur des mails</listitem>
        </itemizedlist>
      </sect4>
    </sect3>
  </sect2>
</section>
